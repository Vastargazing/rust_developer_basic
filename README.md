<img width="624" height="624" alt="image" src="https://github.com/user-attachments/assets/0d51a309-51ec-45b5-a5b5-185c71d66cd6" />

### ü¶Ä **Rust: –ü—É—Ç—å –°–∞–º—É—Ä–∞—è (–û–≥–ª–∞–≤–ª–µ–Ω–∏–µ)**

#### **üå± –ß–∞—Å—Ç—å 1: –§—É–Ω–¥–∞–º–µ–Ω—Ç**

1. **üß± –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏**
2. **üèóÔ∏è –°–ª–æ–∂–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö** (–ö–æ—Ä—Ç–µ–∂, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ)
3. **üîÄ –í–µ—Ç–≤–ª–µ–Ω–∏–µ –∏ —Ü–∏–∫–ª—ã**

#### **üîê –ß–∞—Å—Ç—å 2: –°–≤—è—Ç–æ–π –ì—Ä–∞–∞–ª—å Rust (–ü–∞–º—è—Ç—å)**

4. **üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏** (–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –¢—Ä–µ–π—Ç Copy, –ü—Ä–∏–Ω—Ü–∏–ø –≤–ª–∞–¥–µ–Ω–∏—è)
5. **üîó –í–ª–∞–¥–µ–Ω–∏–µ** (–°—Å—ã–ª–∫–∏ –∏ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ)
6. **üìö –ö–æ–ª–ª–µ–∫—Ü–∏–∏** (–°–ª–∞–π—Å—ã, –º–∞—Å—Å–∏–≤—ã, —Å—Ç—Ä–æ–∫–∏)

#### **üß© –ß–∞—Å—Ç—å 3: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –¢–∏–ø—ã**

7. **üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –º–µ—Ç–æ–¥—ã** (–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è)
8. **üé≠ –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –∏ pattern matching**
9. **üõ°Ô∏è –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º—É —Ç–∏–ø–æ–≤** (–¢–∏–ø—ã std lib: `Result`, `Option`, `()`)

#### **‚öôÔ∏è –ß–∞—Å—Ç—å 4: –§—É–Ω–∫—Ü–∏–∏ –∏ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**

10. **Œª –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏–∏**
11. **üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** (–û–ø–µ—Ä–∞—Ç–æ—Ä `?`, –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ `Result`, `Option`)

#### **üß† –ß–∞—Å—Ç—å 5: –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º –∏ Concurrency**

12. **üì¶ –†–∞–±–æ—Ç–∞ —Å –∫—É—á–µ–π** (`Box`, `Arc`, `Rc`, RAII)
13. **üßµ –ü–æ—Ç–æ–∫–∏** (–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤, `Send` + `Sync`)
14. **ü§ù –õ—è–º–±–¥—ã –∏ –ø–æ—Ç–æ–∫–∏** (–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `move` –∏ `Arc`)
15. **üîí –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** (`Mutex`, `Atomic`)

#### **üöÄ –ß–∞—Å—Ç—å 6: –í—ã—Å—à–∏–π –ø–∏–ª–æ—Ç–∞–∂**

16. **üîÆ Interior mutability** (`Cell`, `RefCell`)
17. **ü™Ñ –ú–∞–∫—Ä–æ—Å—ã** (–î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ)
18. **‚ö° –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å** (Event Loop, C10k problem, `async`/`await`)

---

# –¢–µ–º–∞ 1: –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏

## üéØ –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Ç–µ–º—ã

–í —ç—Ç–æ–π —Ç–µ–º–µ –º—ã —Ä–∞–∑–±–µ—Ä—ë–º —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã Rust, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç –µ–≥–æ **–±–µ–∑–æ–ø–∞—Å–Ω—ã–º** –∏ **–±—ã—Å—Ç—Ä—ã–º** –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

- **Immutability by default** ‚Äî –ø–æ—á–µ–º—É –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å —ç—Ç–æ –Ω–µ –±–∞–≥, –∞ —Ñ–∏—á–∞
- **Ownership –∏ borrowing** ‚Äî –±–∞–∑–æ–≤—ã–µ –∏–¥–µ–∏ (—É–≥–ª—É–±–∏–º—Å—è –ø–æ–∑–∂–µ)
- **Type safety** ‚Äî –∫–∞–∫ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –æ—à–∏–±–æ–∫ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- **Zero-cost abstractions** ‚Äî –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –±–µ–∑ overhead'–∞

---

## 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å

### 1.1 Immutable –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```rust
let x = 5;
// x = 6; // ‚ùå –û–®–ò–ë–ö–ê! x –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è
```

**–ü–æ—á–µ–º—É —Ç–∞–∫?**

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —è–∑—ã–∫–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è–µ–º—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. Rust –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —ç—Ç—É –ª–æ–≥–∏–∫—É:

- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ª–µ–≥—á–µ —Ä–∞—Å—Å—É–∂–¥–∞—Ç—å –æ –∫–æ–¥–µ, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è
- **Concurrency**: –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —à–∞—Ä–∏—Ç—å –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –º–æ–∂–µ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–µ–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### 1.2 –Ø–≤–Ω–∞—è –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å

```rust
let mut y = 5;
y = 6; // ‚úÖ OK
y = y + 1; // ‚úÖ OK
```

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è**: –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–æ–ª–∂–Ω–∞ –º–µ–Ω—è—Ç—å—Å—è ‚Äî —Ç—ã —ç—Ç–æ —è–≤–Ω–æ –¥–µ–∫–ª–∞—Ä–∏—Ä—É–µ—à—å —á–µ—Ä–µ–∑ `mut`. –≠—Ç–æ —Å–∏–≥–Ω–∞–ª —á–∏—Ç–∞—Ç–µ–ª—é –∫–æ–¥–∞: "–≠—Ç–∞ —à—Ç—É–∫–∞ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è, –±—É–¥—å –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω!"

### 1.3 Shadowing (–∑–∞—Ç–µ–Ω–µ–Ω–∏–µ)

```rust
let x = 5;
let x = x + 1; // –°–æ–∑–¥–∞—ë–º –ù–û–í–£–Æ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å —Ç–µ–º –∂–µ –∏–º–µ–Ω–µ–º
let x = x * 2;
println!("{}", x); // 12
```

**Shadowing vs Mutability:**

```rust
// Shadowing –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å –¢–ò–ü
let spaces = "   ";
let spaces = spaces.len(); // str -> usize ‚úÖ

// Mut –ù–ï –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å —Ç–∏–ø
let mut spaces = "   ";
// spaces = spaces.len(); // ‚ùå –û–®–ò–ë–ö–ê: –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Ç–∏–ø—ã
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å shadowing:**
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å–º—ã—Å–ª–∞ –∏–º–µ–Ω–∏
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –±–µ–∑ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è namespace

---

## 2. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

### 2.1 –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è

Rust ‚Äî **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π** —è–∑—ã–∫. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å —Ç–∏–ø—ã –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

```rust
let x = 5; // –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—ã–≤–æ–¥–∏—Ç —Ç–∏–ø: i32
let y: u32 = 10; // –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞
```

**Type inference** –≤ Rust –æ—á–µ–Ω—å –º–æ—â–Ω—ã–π, –Ω–æ –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ —è–≤–Ω–æ—Å—Ç—å:

```rust
let guess: u32 = "42".parse().expect("Not a number!");
// –ë–µ–∑ `: u32` –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –∑–Ω–∞–µ—Ç, –≤ –∫–∞–∫–æ–π —Ç–∏–ø –ø–∞—Ä—Å–∏—Ç—å
```

### 2.2 Scalar Types (—Å–∫–∞–ª—è—Ä–Ω—ã–µ —Ç–∏–ø—ã)

#### –¶–µ–ª—ã–µ —á–∏—Å–ª–∞

| –†–∞–∑–º–µ—Ä | –ó–Ω–∞–∫–æ–≤—ã–µ | –ë–µ–∑–∑–Ω–∞–∫–æ–≤—ã–µ |
|--------|----------|-------------|
| 8-bit  | i8       | u8          |
| 16-bit | i16      | u16         |
| 32-bit | i32      | u32         |
| 64-bit | i64      | u64         |
| 128-bit| i128     | u128        |
| arch   | isize    | usize       |

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

1. **–î–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ç–∏–ø** ‚Äî `i32` (–æ–ø—Ç–∏–º–∞–ª–µ–Ω –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö)
2. **isize/usize** ‚Äî –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (32 –∏–ª–∏ 64 –±–∏—Ç–∞). –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–π
3. **–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ**:
   - –í debug-—Ä–µ–∂–∏–º–µ ‚Üí **panic**
   - –í release-—Ä–µ–∂–∏–º–µ ‚Üí **wrapping** (–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ –º–æ–¥—É–ª—é)

```rust
// –Ø–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ–º
let a: u8 = 255;
let b = a.wrapping_add(1); // 0
let c = a.checked_add(1);   // None (Option<u8>)
let d = a.saturating_add(1); // 255 (–º–∞–∫—Å–∏–º—É–º)
```

**–õ–∏—Ç–µ—Ä–∞–ª—ã —á–∏—Å–µ–ª:**

```rust
let decimal = 98_222;      // _ –¥–ª—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
let hex = 0xff;
let octal = 0o77;
let binary = 0b1111_0000;
let byte = b'A';           // —Ç–æ–ª—å–∫–æ u8
```

#### –ß–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π

```rust
let x = 2.0;      // f64 (default)
let y: f32 = 3.0; // f32
```

**f64 vs f32:**
- `f64` ‚Äî –¥–≤–æ–π–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –¥–µ—Ñ–æ–ª—Ç (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ CPU –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å —Ç–æ–π –∂–µ —Å–∫–æ—Ä–æ—Å—Ç—å—é)
- `f32` ‚Äî –æ–¥–∏–Ω–∞—Ä–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ –≤–∞–∂–µ–Ω —Ä–∞–∑–º–µ—Ä –∏–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

**–í–∞–∂–Ω–æ**: floating-point –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –Ω–µ—Ç–æ—á–Ω–∞! –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–π `f32/f64` –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –Ω–∞–ø—Ä—è–º—É—é.

#### –ë—É–ª–µ–≤—ã –∑–Ω–∞—á–µ–Ω–∏—è

```rust
let t = true;
let f: bool = false;
```

–†–∞–∑–º–µ—Ä: **1 –±–∞–π—Ç** (–Ω–µ 1 –±–∏—Ç!), –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏.

#### –°–∏–º–≤–æ–ª—ã

```rust
let c = 'z';
let z = '‚Ñ§';
let heart = '‚ù§';
```

**–í–∞–∂–Ω–æ:**
- `char` –≤ Rust ‚Äî —ç—Ç–æ **4 –±–∞–π—Ç–∞** (Unicode Scalar Value)
- –ù–µ –ø—É—Ç–∞—Ç—å —Å –±–∞–π—Ç–æ–º (`u8`) –∏–ª–∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–º –ª–∏—Ç–µ—Ä–∞–ª–æ–º (`&str`)
- –ú–æ–∂–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –ª—é–±–æ–π Unicode —Å–∏–º–≤–æ–ª

### 2.3 Compound Types (—Å–æ—Å—Ç–∞–≤–Ω—ã–µ —Ç–∏–ø—ã)

#### –ö–æ—Ä—Ç–µ–∂–∏ (Tuples)

```rust
let tup: (i32, f64, u8) = (500, 6.4, 1);

// –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è
let (x, y, z) = tup;

// –î–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É
let five_hundred = tup.0;
let six_point_four = tup.1;
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª–∏–Ω–∞
- –ì–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã (—Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
- Unit type `()` ‚Äî –ø—É—Å—Ç–æ–π –∫–æ—Ä—Ç–µ–∂ (—Ç–∏–ø —Ñ—É–Ω–∫—Ü–∏–π, –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–µ)

Unit type, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ `()`, ‚Äî —ç—Ç–æ, –ø–æ–∂–∞–ª—É–π, —Å–∞–º—ã–π ¬´–¥–∑–µ–Ω—Å–∫–∏–π¬ª —ç–ª–µ–º–µ–Ω—Ç –≤ Rust. –ï—Å–ª–∏ –æ–±—ã—á–Ω—ã–π –∫–æ—Ä—Ç–µ–∂ ‚Äî —ç—Ç–æ –∫–æ—Ä–æ–±–∫–∞ —Å –≤–µ—â–∞–º–∏, —Ç–æ `()` ‚Äî —ç—Ç–æ **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø—É—Å—Ç–∞—è –∫–æ—Ä–æ–±–∫–∞**.

–ï–≥–æ –≥–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å: **–æ–±–æ–∑–Ω–∞—á–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–∞–º, –≥–¥–µ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º —è–∑—ã–∫–∞ —á—Ç–æ-—Ç–æ –æ–±—è–∑–∞–Ω–æ –±—ã—Ç—å.**

–í–æ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏, –≥–¥–µ –æ–Ω –Ω–µ–∑–∞–º–µ–Ω–∏–º:

---

### 1. –í–æ–∑–≤—Ä–∞—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π ¬´–≤ –Ω–∏–∫—É–¥–∞¬ª

–í Rust –ª—é–±–∞—è —Ñ—É–Ω–∫—Ü–∏—è ‚Äî —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ —á—Ç–æ-—Ç–æ –≤–µ—Ä–Ω—É—Ç—å. –ï—Å–ª–∏ –≤—ã –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç–µ —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç `()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

```rust
fn say_hello() { // –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ fn say_hello() -> ()
    println!("–ü—Ä–∏–≤–µ—Ç!");
}

```

–≠—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç `void` –≤ C++ –∏–ª–∏ Java. –í Rust —Ñ—É–Ω–∫—Ü–∏—è *–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ* –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ (–ø—É—Å—Ç–æ–π –∫–æ—Ä—Ç–µ–∂), –ø—Ä–æ—Å—Ç–æ –æ–Ω–æ –∑–∞–Ω–∏–º–∞–µ—Ç 0 –±–∞–π—Ç –≤ –ø–∞–º—è—Ç–∏.

### 2. –¢–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è

–í Rust —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π `;` –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –≤ **statement** (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é). –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ª—é–±–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è `()`.

```rust
let x = {
    let y = 5;
    y + 2    // –ë–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è 7
}; // x = 7

let z = {
    let y = 5;
    y + 2;   // –° —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π: –∑–Ω–∞—á–µ–Ω–∏–µ "–≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è"
}; // z = ()

```

–í Rust —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É **expression** (–≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º) –∏ **statement** (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π/—Å–æ—Å—Ç–æ—è–Ω–∏–µ–º) ‚Äî —ç—Ç–æ –±—É–∫–≤–∞–ª—å–Ω–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–∏–∑–∞–π–Ω–∞ —è–∑—ã–∫–∞.

### 1. –í—ã—Ä–∞–∂–µ–Ω–∏–µ (Expression) ‚Äî ¬´–≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ¬ª

–í—ã—Ä–∞–∂–µ–Ω–∏–µ ‚Äî —ç—Ç–æ –≤—Å—ë, —á—Ç–æ **–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç**. –û–Ω–æ –≤—Å–µ–≥–¥–∞ ¬´—á—Ç–æ-—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç¬ª.

* `5` ‚Äî —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 5).
* `2 + 3` ‚Äî –≤—ã—Ä–∞–∂–µ–Ω–∏–µ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 5).
* `x + 1` (–±–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π) ‚Äî —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ.

–ö–æ–≥–¥–∞ —Ç—ã –ø–∏—à–µ—à—å –±–ª–æ–∫ `{ ... }`, Rust —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–æ–∫—É. –ï—Å–ª–∏ —Ç–∞–º –Ω–µ—Ç —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π, –≤–µ—Å—å –±–ª–æ–∫ ¬´—Å—Ö–ª–æ–ø—ã–≤–∞–µ—Ç—Å—è¬ª –≤ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

### 2. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (Statement) ‚Äî ¬´–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ¬ª

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è ‚Äî —ç—Ç–æ **–∫–æ–º–∞–Ω–¥–∞ —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ**, –Ω–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–∏—á–µ–≥–æ –ø–æ–ª–µ–∑–Ω–æ–≥–æ.

–í Rust –ø–æ—á—Ç–∏ –ª—é–±–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ `;`. –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Ç—ã —Å—Ç–∞–≤–∏—à—å —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π, —Ç—ã –≥–æ–≤–æ—Ä–∏—à—å –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É: ¬´–í—ã–ø–æ–ª–Ω–∏ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –∏ **–≤—ã–±—Ä–æ—Å—å** —Ä–µ–∑—É–ª—å—Ç–∞—Ç¬ª.

---

### –ü–æ—á–µ–º—É `z` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `()`?

–î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä–µ–º —Ç–≤–æ–π –ø—Ä–∏–º–µ—Ä –ø–æ —à–∞–≥–∞–º, –∫–∞–∫ —ç—Ç–æ –≤–∏–¥–∏—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä:

```rust
let z = {
    let x = 3; 
    x + 1; // <--- –í–æ—Ç –∑–¥–µ—Å—å –º–∞–≥–∏—è
};

```

1. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è `x + 1`, –ø–æ–ª—É—á–∞–µ—Ç—Å—è `4`.
2. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤–∏–¥–∏—Ç `;`. –û–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ ¬´—á–µ—Ä–Ω–∞—è –¥—ã—Ä–∞¬ª –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏—è.
3. –ó–Ω–∞—á–µ–Ω–∏–µ `4` –ø–æ–≥–ª–æ—â–∞–µ—Ç—Å—è, –∏ –≤–º–µ—Å—Ç–æ –Ω–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ¬´–Ω–∏—á–µ–≥–æ¬ª, —Ç–æ –µ—Å—Ç—å **Unit type `()**`.
4. –ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –±–ª–æ–∫–∞, –≤–µ—Å—å –±–ª–æ–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `()`.
5. –ò—Ç–æ–≥: `z = ()`.

### –§–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç: Rust ‚Äî —è–∑—ã–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–π

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç C –∏–ª–∏ Java, –≤ Rust –ø–æ—á—Ç–∏ –≤—Å—ë ‚Äî –≤—ã—Ä–∞–∂–µ–Ω–∏–µ. –î–∞–∂–µ `if` –∏–ª–∏ `match`:

```rust
let message = if is_happy {
    "Smile!" // expression
} else {
    "Wait."  // expression
}; // message —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫—É

```

–ï—Å–ª–∏ –±—ã —Ç—ã –ø–æ—Å—Ç–∞–≤–∏–ª `;` –≤–Ω—É—Ç—Ä–∏ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–æ–∫ `if`, `message` —Å—Ç–∞–ª –±—ã —Ä–∞–≤–µ–Ω `()`, –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—ã, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–ª–∞—Å—å, –µ—Å–ª–∏ —Ç—ã –æ–∂–∏–¥–∞–ª —Ç–∞–º —Å—Ç—Ä–æ–∫—É.

### –®–ø–∞—Ä–≥–∞–ª–∫–∞:

* **–ù–µ—Ç `;**` ‚Äî ¬´–Ø —Ö–æ—á—É –ø–µ—Ä–µ–¥–∞—Ç—å —ç—Ç–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–∞–ª—å—à–µ¬ª.
* **–ï—Å—Ç—å `;**` ‚Äî ¬´–Ø –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω—è—é –¥–µ–π—Å—Ç–≤–∏–µ, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–Ω–µ –Ω–µ –Ω—É–∂–µ–Ω¬ª.

**–•–æ—á–µ—à—å –ø—Ä–∏–∫–æ–ª?** –î–∞–∂–µ —Å–∞–º–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ `let x = 5;` ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `()`. –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –≤ Rust –Ω–µ–ª—å–∑—è –Ω–∞–ø–∏—Å–∞—Ç—å `a = b = c = 5`, –∫–∞–∫ –≤ C.

### 3. –ó–∞–≥–ª—É—à–∫–∞ –≤ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ö (`Result` –∏ `Set`)

–ß–∞—Å—Ç–æ –Ω–∞–º –≤–∞–∂–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ (—É—Å–ø–µ—Ö –∏–ª–∏ –ø—Ä–æ–≤–∞–ª), –Ω–æ –Ω–µ –≤–∞–∂–Ω—ã —Å–∞–º–∏ –¥–∞–Ω–Ω—ã–µ –≤ —Å–ª—É—á–∞–µ —É—Å–ø–µ—Ö–∞.

* **Result<(), Error>**: ¬´–ú–µ–Ω—è –Ω–µ –≤–æ–ª–Ω—É–µ—Ç, —á—Ç–æ —Ç—ã –≤–µ—Ä–Ω–µ—à—å, –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏, —á—Ç–æ –≤—Å—ë –ø—Ä–æ—à–ª–æ –±–µ–∑ –æ—à–∏–±–æ–∫¬ª. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π –∑–∞–ø–∏—Å–∏ –≤ —Ñ–∞–π–ª –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–µ—Ç–∏.
* **–ò–º–∏—Ç–∞—Ü–∏—è Set**: –í Rust –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –Ω–µ –±—ã–ª–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ `HashSet`, –∏ –ª—é–¥–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `HashMap<K, ()>`. –ö–ª—é—á –µ—Å—Ç—å, –∞ –≤–º–µ—Å—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî ¬´–ø—É—Å—Ç–æ—Ç–∞¬ª, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–∞.

### 4. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–π—Ç–æ–≤

–ò–Ω–æ–≥–¥–∞ —Ç—Ä–µ–π—Ç —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –º–µ—Ç–æ–¥ —á—Ç–æ-—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–ª, –Ω–æ –≤ –≤–∞—à–µ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ—á–µ–≥–æ. –í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `()`, —á—Ç–æ–±—ã —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Ç–∏–ø–æ–≤.

---

### –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ "–Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å"?

–ü–æ—Ç–æ–º—É —á—Ç–æ Rust ‚Äî —è–∑—ã–∫ —Å –æ—á–µ–Ω—å —Å—Ç—Ä–æ–≥–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É:

* `i32` ‚Äî —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ.
* `bool` ‚Äî –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
* `()` ‚Äî **—Ñ–∞–∫—Ç —Ç–æ–≥–æ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ—Ç**, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤ —Å–∏—Å—Ç–µ–º–µ —Ç–∏–ø–æ–≤.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å –æ–±–æ–±—â–µ–Ω–Ω—ã–π (generic) –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ –∏ —Å –¥–∞–Ω–Ω—ã–º–∏, –∏ —Å –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º.

**–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç:** –†–∞–∑–º–µ—Ä `()` –≤ –ø–∞–º—è—Ç–∏ —Ä–∞–≤–µ–Ω **0 –±–∞–π—Ç**. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø—Ä–æ—Å—Ç–æ –≤—ã—Ä–µ–∑–∞–µ—Ç –µ–≥–æ –∏–∑ –≥–æ—Ç–æ–≤–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ç–∞–∫ —á—Ç–æ —ç—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

#### –ú–∞—Å—Å–∏–≤—ã (Arrays)

```rust
let a = [1, 2, 3, 4, 5];
let months = ["January", "February", "March", /* ... */];

// –Ø–≤–Ω–∞—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è —Ç–∏–ø–∞
let a: [i32; 5] = [1, 2, 3, 4, 5];
//      ^^^  ^
//      —Ç–∏–ø  –¥–ª–∏–Ω–∞

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
let a = [3; 5]; // [3, 3, 3, 3, 3]
```

**–ú–∞—Å—Å–∏–≤—ã vs –í–µ–∫—Ç–æ—Ä—ã:**

| –ú–∞—Å—Å–∏–≤—ã (`[T; N]`) | –í–µ–∫—Ç–æ—Ä—ã (`Vec<T>`) |
|--------------------|--------------------|
| –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä |
| –°—Ç–µ–∫ (–æ–±—ã—á–Ω–æ) | –ö—É—á–∞ |
| –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø | –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø + —Ä–æ—Å—Ç |
| –ò–∑–≤–µ—Å—Ç–µ–Ω –Ω–∞ compile-time | –ò–∑–≤–µ—Å—Ç–µ–Ω –Ω–∞ runtime |

–ö—Å—Ç–∞—Ç–∏ –≤–æ–ø—Ä–æ—Å –æ —Å—Ç–µ–∫–µ –∏ –∫—É—á–µ ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å–∏–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –Ω–∞—É–∫. –ï—Å–ª–∏ –∫–æ—Ä–æ—Ç–∫–æ: **—Å—Ç–µ–∫ –±—ã—Å—Ç—Ä–µ–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º.**

–ß—Ç–æ–±—ã —ç—Ç–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –ø—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É ¬´–≤–∑—è—Ç—å –≤–µ—Ä—Ö–Ω—é—é —Ç–∞—Ä–µ–ª–∫—É –∏–∑ —Å—Ç–æ–ø–∫–∏¬ª –∏ ¬´–Ω–∞–π—Ç–∏ —Å–≤–æ–±–æ–¥–Ω—ã–π —Å—Ç–æ–ª–∏–∫ –≤ –æ–≥—Ä–æ–º–Ω–æ–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ¬ª.

---

### 1. –°–ø–æ—Å–æ–± –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ (–ê–ª–ª–æ–∫–∞—Ü–∏—è)

* **–°—Ç–µ–∫ (Stack):** –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É LIFO (Last In, First Out). –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∑–∞—Ä–∞–Ω–µ–µ –∑–Ω–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö. –ß—Ç–æ–±—ã –≤—ã–¥–µ–ª–∏—Ç—å –ø–∞–º—è—Ç—å, –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–¥–≤–∏–Ω—É—Ç—å –æ–¥–∏–Ω —É–∫–∞–∑–∞—Ç–µ–ª—å (—Ä–µ–≥–∏—Å—Ç—Ä `rsp`) –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞–π—Ç. –≠—Ç–æ –±—É–∫–≤–∞–ª—å–Ω–æ **–æ–¥–Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**.
* **–ö—É—á–∞ (Heap):** –ö–æ–≥–¥–∞ –≤—ã –ø—Ä–æ—Å–∏—Ç–µ –ø–∞–º—è—Ç—å –≤ –∫—É—á–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Box::new` –∏–ª–∏ `Vec`), –û–° –¥–æ–ª–∂–Ω–∞ –Ω–∞–π—Ç–∏ —Å–≤–æ–±–æ–¥–Ω–æ–µ ¬´–æ–∫–Ω–æ¬ª –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. –≠—Ç–æ —Å–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫, –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –∏ —Ä–∞–±–æ—Ç—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–∞–ª–ª–æ–∫–∞—Ç–æ—Ä–∞).

### 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ª–æ–∫–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

–≠—Ç–æ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞—Ö.

* **–°—Ç–µ–∫:** –î–∞–Ω–Ω—ã–µ –≤ —Å—Ç–µ–∫–µ –ª–µ–∂–∞—Ç –ø–ª–æ—Ç–Ω–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É. –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –æ–±–æ–∂–∞–µ—Ç —ç—Ç–æ: –∫–æ–≥–¥–∞ –æ–Ω —á–∏—Ç–∞–µ—Ç –æ–¥–Ω—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å–æ —Å—Ç–µ–∫–∞, –æ–Ω –∑–∞–æ–¥–Ω–æ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –≤ –±—ã—Å—Ç—Ä—ã–π –∫—ç—à (L1/L2) —Å–æ—Å–µ–¥–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ —Å–ª–µ–¥—É—é—â–∞—è –Ω—É–∂–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —É–∂–µ –≤ –∫—ç—à–µ, –±–ª–∏–∑–∫–∞ –∫ 100%.
* **–ö—É—á–∞:** –î–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ –≤—Å–µ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –ö–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ –≤ –∫—É—á—É, –µ–º—É —á–∞—Å—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∂–¥–∞—Ç—å, –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã–µ ¬´–ø—Ä–∏–µ–¥—É—Ç¬ª –∏–∑ –º–µ–¥–ª–µ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (RAM). –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **cache miss**, –∏ —ç—Ç–æ –¥–∏–∫–æ –∑–∞–º–µ–¥–ª—è–µ—Ç —Ä–∞–±–æ—Ç—É.

### 3. –û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏

* **–°—Ç–µ–∫:** –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, —É–∫–∞–∑–∞—Ç–µ–ª—å —Å—Ç–µ–∫–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä—ã–≥–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ. –í—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ¬´—É–¥–∞–ª—è—é—Ç—Å—è¬ª –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.
* **–ö—É—á–∞:** –ü–∞–º—è—Ç—å –Ω—É–∂–Ω–æ —è–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å (–≤ Rust —ç—Ç–æ –¥–µ–ª–∞–µ—Ç `Drop`). –ù—É–∂–Ω–æ –ø–æ–º–µ—Ç–∏—Ç—å –±–ª–æ–∫ –∫–∞–∫ —Å–≤–æ–±–æ–¥–Ω—ã–π, –≤–æ–∑–º–æ–∂–Ω–æ, –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –µ–≥–æ —Å —Å–æ—Å–µ–¥–Ω–∏–º–∏ –ø—É—Å—Ç—ã–º–∏ –±–ª–æ–∫–∞–º–∏, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.

---

### –ò—Ç–æ–≥–æ–≤–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –°—Ç–µ–∫ (Stack) | –ö—É—á–∞ (Heap) |
| --- | --- | --- |
| **–ê–Ω–∞–ª–æ–≥–∏—è** | –°—Ç–æ–ø–∫–∞ —Ç–∞—Ä–µ–ª–æ–∫ | –ü–æ–∏—Å–∫ –º–µ—Å—Ç–∞ –Ω–∞ –ø–∞—Ä–∫–æ–≤–∫–µ |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å** |  (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ) |  –∏–ª–∏ –≤—ã—à–µ (–ø–æ–∏—Å–∫) |
| **–£–∫–∞–∑–∞—Ç–µ–ª—å** | –û–¥–∏–Ω, –≤—Å–µ–≥–¥–∞ –Ω–∞ –≤–µ—Ä—à–∏–Ω–µ | –ú–Ω–æ–≥–æ —Å—Å—ã–ª–æ–∫ –≤ —Ä–∞–∑–Ω—ã–µ –º–µ—Å—Ç–∞ |
| **–°–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è (–∫—ç—à-—Ñ—Ä–µ–Ω–¥–ª–∏) | –ù–∏–∂–µ (–≤–æ–∑–º–æ–∂–Ω—ã –∑–∞–¥–µ—Ä–∂–∫–∏ RAM) |

### –ü–æ—á–µ–º—É —Ç–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ç–µ–∫?

–£ —Å—Ç–µ–∫–∞ –µ—Å—Ç—å –¥–≤–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

1. **–†–∞–∑–º–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑–≤–µ—Å—Ç–µ–Ω –∑–∞—Ä–∞–Ω–µ–µ** (–Ω–µ–ª—å–∑—è –ø–æ–ª–æ–∂–∏—Ç—å –º–∞—Å—Å–∏–≤, —Ä–∞–∑–º–µ—Ä –∫–æ—Ç–æ—Ä–æ–≥–æ –≤–≤–µ–¥–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å).
2. **–ü–∞–º—è—Ç—å –∂–∏–≤–µ—Ç –Ω–µ–¥–æ–ª–≥–æ** (—Ç–æ–ª—å–∫–æ –ø–æ–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è).

–í Rust –∫–æ—Ä—Ç–µ–∂–∏, —á–∏—Å–ª–∞ –∏ –º–∞—Å—Å–∏–≤—ã —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∂–∏–≤—É—Ç –Ω–∞ —Å—Ç–µ–∫–µ, —á—Ç–æ –∏ –¥–µ–ª–∞–µ—Ç —è–∑—ã–∫ —Ç–∞–∫–∏–º –±—ã—Å—Ç—Ä—ã–º.

**–î–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º:**

```rust
let a = [1, 2, 3, 4, 5];
let first = a[0];
let second = a[1];

// –í—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã
// let invalid = a[10]; // ‚ùå RUNTIME PANIC (–Ω–µ compile error!)
```

**–í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø—Ä–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
Rust –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞ –≤ **runtime**. –≠—Ç–æ overhead, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç memory safety.

---

## 3. –§—É–Ω–∫—Ü–∏–∏

### 3.1 –û–±—ä—è–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

```rust
fn main() {
    println!("Hello, world!");
    another_function(5);
}

fn another_function(x: i32) {
    println!("The value of x is: {}", x);
}
```

**–°–æ–≥–ª–∞—à–µ–Ω–∏—è –æ–± –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏:**
- `snake_case` –¥–ª—è –∏–º—ë–Ω —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—ã–¥–∞—Å—Ç **warning**, –µ—Å–ª–∏ –Ω–∞—Ä—É—à–∞–µ—à—å –∫–æ–Ω–≤–µ–Ω—Ü–∏—é

### 3.2 –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π

```rust
fn print_labeled_measurement(value: i32, unit_label: char) {
    println!("The measurement is: {}{}", value, unit_label);
}
```

**–ö–ª—é—á–µ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** —Ç–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** —É–∫–∞–∑—ã–≤–∞—Ç—å. Type inference –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Å–∏–≥–Ω–∞—Ç—É—Ä —Ñ—É–Ω–∫—Ü–∏–π.

### 3.3 Statements vs Expressions

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–ê–Ø –ö–û–ù–¶–ï–ü–¶–ò–Ø –í RUST!**

#### Statements (—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)
–í—ã–ø–æ–ª–Ω—è—é—Ç –¥–µ–π—Å—Ç–≤–∏–µ, **–ù–ï –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ**.

```rust
let y = 6; // —ç—Ç–æ statement
```

#### Expressions (–≤—ã—Ä–∞–∂–µ–Ω–∏—è)
–í—ã—á–∏—Å–ª—è—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, **–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç**.

```rust
5 + 6  // expression, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 11

{
    let x = 3;
    x + 1  // ‚ùó –ë–ï–ó —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π! –≠—Ç–æ expression
}
```

**–ö–ª—é—á–µ–≤–∞—è —Ä–∞–∑–Ω–∏—Ü–∞:**

```rust
let y = {
    let x = 3;
    x + 1  // expression ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 4
};
// y == 4

let z = {
    let x = 3;
    x + 1; // statement (–∏–∑-–∑–∞ ;) ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ()
};
// z == () (unit type)
```

### 3.4 –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

```rust
fn five() -> i32 {
    5  // –ù–µ—è–≤–Ω—ã–π return (—ç—Ç–æ expression!)
}

fn plus_one(x: i32) -> i32 {
    x + 1  // –ë–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π!
}

// –¢–æ –∂–µ —Å–∞–º–æ–µ —Å —è–≤–Ω—ã–º return
fn plus_one_explicit(x: i32) -> i32 {
    return x + 1;
}
```

–†–∞–∑–±–∏—Ä–∞–µ–º —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç. –í Rust –µ—Å—Ç—å –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏: **¬´—Ç–∏—Ö–∏–π¬ª (–Ω–µ—è–≤–Ω—ã–π)** –∏ **¬´–≥—Ä–æ–º–∫–∏–π¬ª (—è–≤–Ω—ã–π)**.

–î–∞–≤–∞–π –ø–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç ¬´–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º¬ª –≤ –∫–∞–∂–¥–æ–º —Å–ª—É—á–∞–µ.

---

### 1. –ù–µ—è–≤–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç (Expression)

–í Rust —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî —ç—Ç–æ –±–æ–ª—å—à–∏–µ –±–ª–æ–∫–∏-–≤—ã—Ä–∞–∂–µ–Ω–∏—è. –¢–æ, —á–µ–º –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –±–ª–æ–∫, –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –≤—Å–µ–π —Ñ—É–Ω–∫—Ü–∏–∏.

```rust
fn five() -> i32 {
    5  // –ó–¥–µ—Å—å –Ω–µ—Ç —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π!
}

```

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è ‚Äî —ç—Ç–æ —Ç—Ä—É–±–∞. –¢—ã –∑–∞–∫–∏–¥—ã–≤–∞–µ—à—å —Ç—É–¥–∞ –∫–æ–¥, –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ, —á—Ç–æ —Ç–∞–º ¬´–ø—Ä–æ–ª–µ—Ç–µ–ª–æ¬ª –±–µ–∑ –ø—Ä–µ–≥—Ä–∞–¥—ã –≤ –≤–∏–¥–µ `;`, –≤—ã–ª–µ—Ç–∞–µ—Ç —Å –¥—Ä—É–≥–æ–≥–æ –∫–æ–Ω—Ü–∞ –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä—É—Ç–æ?** –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ —á–∏—â–µ. –¢–µ–±–µ –Ω–µ –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å –ª–∏—à–Ω–∏–µ —Å–ª–æ–≤–∞ `return` –≤–µ–∑–¥–µ, –≥–¥–µ –ª–æ–≥–∏–∫–∞ –∏ —Ç–∞–∫ –ø–æ–Ω—è—Ç–Ω–∞. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π ¬´–∏–¥–∏–æ–º–∞—Ç–∏—á–Ω—ã–π¬ª —Å—Ç–∏–ª—å –≤ Rust.

### 2. –¢–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π ‚Äî ¬´–°—Ç–µ–Ω–∞¬ª

–ï—Å–ª–∏ —Ç—ã –¥–æ–±–∞–≤–∏—à—å `;` –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ, –º–∞–≥–∏—è —Å–ª–æ–º–∞–µ—Ç—Å—è:

```rust
fn five() -> i32 {
    5; // –û–®–ò–ë–ö–ê!
}

```

**–ß—Ç–æ –≤–∏–¥–∏—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä:** ¬´–¢–∞–∫, —Ç—ã –≤—ã—á–∏—Å–ª–∏–ª 5, –ø–æ—Ç–æ–º –ø–æ—Å—Ç–∞–≤–∏–ª —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π (–ø—Ä–µ–≤—Ä–∞—Ç–∏–ª –≤ statement), –∑–Ω–∞—á–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî `()`. –ù–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ —Ç—ã –æ–±–µ—â–∞–ª –º–Ω–µ `i32`! –ì–¥–µ –º–æ–∏ —á–∏—Å–ª–∞, –õ–µ–±–æ–≤—Å–∫–∏?¬ª

---

### 3. –Ø–≤–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç (`return`)

–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `return` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ** –≤—ã—Ö–æ–¥–∞ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏.

```rust
fn plus_one_explicit(x: i32) -> i32 {
    return x + 1; // –¢–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π –∑–¥–µ—Å—å —É–∂–µ –Ω–µ –º–µ—à–∞–µ—Ç
}

```

–ö–æ–≥–¥–∞ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤–∏–¥–∏—Ç `return`, –æ–Ω —Å—Ä–∞–∑—É —Ö–≤–∞—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏ ¬´–≤—ã–ø—Ä—ã–≥–∏–≤–∞–µ—Ç¬ª –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–µ –≥–ª—è–¥—è –Ω–∞ —Ç–æ, —á—Ç–æ –∏–¥–µ—Ç –¥–∞–ª—å—à–µ.

**–ö–æ–≥–¥–∞ —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–µ–Ω `return`?**
–û–±—ã—á–Ω–æ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–Ω—É—Ç—Ä–∏ —É—Å–ª–æ–≤–∏–π, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤—ã–π—Ç–∏ —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏:

```rust
fn check_number(x: i32) -> String {
    if x < 0 {
        return String::from("–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ!"); // –í—ã—Ö–æ–¥–∏–º —Å—Ä–∞–∑—É
    }
    
    String::from("–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ") // –ù–µ—è–≤–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç –≤ –∫–æ–Ω—Ü–µ
}

```

---

### –ì–ª–∞–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ ¬´–¥–ª—è —Å–≤–æ–∏—Ö¬ª:

1. **–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –±–µ–∑ `;**` ‚Äî —ç—Ç–æ –∏ –µ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏.
2. **–ï—Å–ª–∏ –µ—Å—Ç—å `;` –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–µ** ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `()`.
3. **–ü–∏—à–∏ `return` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –≤—ã–π—Ç–∏ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–Ω—å—à–µ**, —á–µ–º –æ–Ω–∞ –¥–æ–π–¥–µ—Ç –¥–æ –∫–æ–Ω—Ü–∞. –í —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ `return` –æ–±—ã—á–Ω–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è ¬´–ø–ª–æ—Ö–∏–º —Ç–æ–Ω–æ–º¬ª (—Ö–æ—Ç—è –∫–æ–¥ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å).

### –ò—Ç–æ–≥–æ:

* `plus_one` ‚Äî —ç—Ç–æ ¬´Rust-way¬ª. –ö—Ä–∞—Ç–∫–æ –∏ —á–∏—Å—Ç–æ.
* `plus_one_explicit` ‚Äî —ç—Ç–æ ¬´C-way¬ª. –†–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –≤—ã–≥–ª—è–¥–∏—Ç –¥–ª—è –æ–ø—ã—Ç–Ω–æ–≥–æ Rust-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –Ω–µ–º–Ω–æ–≥–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ.

–¢–µ–ø–µ—Ä—å –ø–æ–Ω—è—Ç–Ω–æ, –ø–æ—á–µ–º—É –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ `;` —É–±–∏–≤–∞–µ—Ç –∫–æ–¥, –∞ –≤ –¥—Ä—É–≥–æ–º (—Å `return`) ‚Äî –Ω–µ—Ç?

---

**–ß–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞ –Ω–æ–≤–∏—á–∫–æ–≤:**

```rust
fn plus_one(x: i32) -> i32 {
    x + 1;  // ‚ùå –° —Ç–æ—á–∫–æ–π –∑–∞–ø—è—Ç–æ–π —ç—Ç–æ statement
            //    –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç (), –∞ –Ω–µ i32
}
// error: mismatched types
```

**Early return:**

```rust
fn check_positive(x: i32) -> bool {
    if x < 0 {
        return false;  // Early return
    }
    true  // –ü–æ—Å–ª–µ–¥–Ω–µ–µ expression
}
```

–ï—Å–ª–∏ `x < 0`, —Ç–æ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ —Å `true` –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ **–ø—Ä–æ—Å—Ç–æ –Ω–µ –¥–æ–±–µ—Ä–µ—Ç—Å—è**.

–î–∞–≤–∞–π –ø—Ä–æ—Å–ª–µ–¥–∏–º –ø—É—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –≤ —ç—Ç–æ–º –∫–æ–¥–µ:

1. –î–æ–ø—É—Å—Ç–∏–º, –º—ã –≤—ã–∑–≤–∞–ª–∏ `check_positive(-5)`.
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ `if -5 < 0` –¥–∞–µ—Ç **–∏—Å—Ç–∏–Ω—É**.
3. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä—å `if` –∏ –≤–∏–¥–∏—Ç `return false;`.
4. –í —ç—Ç–æ—Ç –∂–µ –º–∏–≥ —Ñ—É–Ω–∫—Ü–∏—è ¬´—Å—Ö–ª–æ–ø—ã–≤–∞–µ—Ç—Å—è¬ª, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `false` –≤ —Ç–æ –º–µ—Å—Ç–æ, –æ—Ç–∫—É–¥–∞ –µ—ë –≤—ã–∑–≤–∞–ª–∏, –∏ **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç —Ä–∞–±–æ—Ç—É**.
5. –°—Ç—Ä–æ–∫–∞ —Å `true` –æ—Å—Ç–∞–µ—Ç—Å—è ¬´–∑–∞ –±–æ—Ä—Ç–æ–º¬ª ‚Äî –æ–Ω–∞ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –¥–ª—è —ç—Ç–æ–≥–æ –≤—ã–∑–æ–≤–∞.

---

### –ü–æ—á–µ–º—É —ç—Ç–æ —É–¥–æ–±–Ω–æ?

–≠—Ç–æ—Ç –ø—Ä–∏–µ–º –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **Guard Clause** (–∑–∞—â–∏—Ç–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ). –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –≥–æ—Ä–æ–¥–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ `if-else`, —Ç—ã –∫–∞–∫ –±—ã ¬´–æ—Ç—Å—Ç—Ä–µ–ª–∏–≤–∞–µ—à—å¬ª –ø–ª–æ—Ö–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ.

–°—Ä–∞–≤–Ω–∏ –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞:

**–í–∞—Ä–∏–∞–Ω—Ç –ê (—Å `else`, –≥—Ä–æ–º–æ–∑–¥–∫–æ):**

```rust
fn check_positive(x: i32) -> bool {
    if x < 0 {
        false
    } else {
        true
    }
}

```

**–í–∞—Ä–∏–∞–Ω—Ç –ë (—Ç–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Å `return`, —á–∏—Å—Ç–æ):**

```rust
fn check_positive(x: i32) -> bool {
    if x < 0 { return false; } // –í—ã–ª–µ—Ç–∞–µ–º, –µ—Å–ª–∏ –≤—Å—ë –ø–ª–æ—Ö–æ
    true // –í –æ—Å—Ç–∞–ª—å–Ω–æ–º —Å–ª—É—á–∞–µ ‚Äî –≤—Å—ë –æ–∫!
}

```

---

### –¢–æ–Ω–∫–∏–π –º–æ–º–µ–Ω—Ç —Å `;`

–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ:

* –í–Ω—É—Ç—Ä–∏ `if` —Ç—ã –Ω–∞–ø–∏—Å–∞–ª `return false;` **—Å —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π**. –ó–¥–µ—Å—å –æ–Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞, —Ç–∞–∫ –∫–∞–∫ `return` ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (statement), –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
* –í –∫–æ–Ω—Ü–µ —Ç—ã –Ω–∞–ø–∏—Å–∞–ª `true` **–±–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π**. –ï—Å–ª–∏ —Ç—ã –µ—ë —Ç–∞–º –ø–æ—Å—Ç–∞–≤–∏—à—å, –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å–∫–∞–∂–µ—Ç: ¬´–≠–π, —Ç—ã –æ–±–µ—â–∞–ª –≤–µ—Ä–Ω—É—Ç—å `bool`, –∞ –≤ –∏—Ç–æ–≥–µ –≤ –∫–æ–Ω—Ü–µ —Å—Ç–æ–∏—Ç —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∞ –≤—Å—ë –≤ `()` (–Ω–∏—á–µ–≥–æ)!¬ª.

### –ò—Ç–æ–≥–æ:

–¢–≤–æ–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ñ–∏–ª—å—Ç—Ä. –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ ¬´–≥—Ä—è–∑–Ω–æ–µ¬ª (–º–µ–Ω—å—à–µ –Ω—É–ª—è), `return` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–∫ –∞–≤–∞—Ä–∏–π–Ω—ã–π –≤—ã—Ö–æ–¥. –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ –ø—Ä–æ–≤–µ—Ä–∫—É, –æ–Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ —Ñ–∏–Ω–∞–ª–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ.

–•–æ—á–µ—à—å –ø–æ–∫–∞–∂—É, –∫–∞–∫ Rust-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –¥–µ–ª–∞—é—Ç —ç—Ç–æ –µ—â–µ –∫–æ—Ä–æ—á–µ –≤–æ–æ–±—â–µ –±–µ–∑ `if`, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ—Å—Ç–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ? –≠—Ç–æ –≤–∑–æ—Ä–≤–µ—Ç —Ç–µ–±–µ –º–æ–∑–≥ —Å–≤–æ–µ–π –ø—Ä–æ—Å—Ç–æ—Ç–æ–π.

–°–º–æ—Ç—Ä–∏, –º–∞–≥–∏—è –≤ —Ç–æ–º, —á—Ç–æ —Å–∞–º–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ `x >= 0` ‚Äî —ç—Ç–æ —É–∂–µ **expression** (–≤—ã—Ä–∞–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä–æ–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ `true` –∏–ª–∏ `false`.

–¢–≤–æ–π –∫–æ–¥ –º–æ–∂–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –¥–æ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ—á–∫–∏:

```rust
fn check_positive(x: i32) -> bool {
    x >= 0  // –≠—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ —Å–∞–º–æ –ø–æ —Å–µ–±–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç bool!
}

```

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

1. –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –±–µ—Ä–µ—Ç `x`.
2. –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –µ–≥–æ —Å `0`.
3. –†–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–ª–æ–≥–∏—á–µ—Å–∫–æ–µ ¬´–¥–∞¬ª –∏–ª–∏ ¬´–Ω–µ—Ç¬ª) –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–µ–º —Å–∞–º—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–µ ¬´–≤—ã–ª–µ—Ç–∞–µ—Ç¬ª –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏.
4. –ù–∏–∫–∞–∫–∏—Ö `if`, –Ω–∏–∫–∞–∫–∏—Ö `return`. –ß–∏—Å—Ç—ã–π –¥–∑–µ–Ω.

---

### –ê —Ç–µ–ø–µ—Ä—å ‚Äî —É—Ä–æ–≤–µ–Ω—å ¬´Pro¬ª: —Ç–µ—Ä–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ-—Ä–∞—Å—Ç–æ–≤—Å–∫–∏

–í –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö (C++, JS, Python) –µ—Å—Ç—å —Ç–µ—Ä–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ç–∏–ø–∞ `condition ? true : false`. –í Rust –µ–≥–æ –Ω–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ **`if` —Å–∞–º –ø–æ —Å–µ–±–µ —è–≤–ª—è–µ—Ç—Å—è –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º**.

–¢—ã –º–æ–∂–µ—à—å –ø–æ–ª–æ–∂–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç `if` –ø—Ä—è–º–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

```rust
let status = if x >= 0 { "Positive" } else { "Negative" };

```

### –ü–æ—á–µ–º—É —ç—Ç–æ —Å—Ä—ã–≤–∞–µ—Ç –±–∞—à–Ω—é –Ω–æ–≤–∏—á–∫–∞–º?

–ü–æ—Ç–æ–º—É —á—Ç–æ –≤ Rust —Ç—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `if` –≤–µ–∑–¥–µ, –≥–¥–µ –æ–∂–∏–¥–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–æ—Ä—Ç–µ–∂–µ:

```rust
let tuple = (
    42,
    if x > 0 { "plus" } else { "minus" }, // –ü—Ä—è–º–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ä—Ç–µ–∂–∞!
    true
);

```

### –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ, —á—Ç–æ–±—ã –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è:

–ï—Å–ª–∏ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å `if` –∫–∞–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ (—á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ), —Ç–æ **–≤—Å–µ –≤–µ—Ç–∫–∏ (`if` –∏ `else`) –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ç–∏–ø**.
–¢—ã –Ω–µ –º–æ–∂–µ—à—å –≤ –æ–¥–Ω–æ–π –≤–µ—Ç–∫–µ –≤–µ—Ä–Ω—É—Ç—å —á–∏—Å–ª–æ `5`, –∞ –≤ –¥—Ä—É–≥–æ–π ‚Äî —Å—Ç—Ä–æ–∫—É `"–æ—à–∏–±–∫–∞"`. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä Rust –¥–æ–ª–∂–µ–Ω —Ç–æ—á–Ω–æ –∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –µ—â–µ –¥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã.

---


### 3.5 Diverging functions

–§—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è**:

```rust
fn infinite_loop() -> ! {
    loop {
        println!("Forever!");
    }
}

fn panic_function() -> ! {
    panic!("This function never returns normally");
}
```

–¢–∏–ø `!` (never type) ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–∏–ø –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.

---

## 4. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

```rust
// –û–±—ã—á–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π

/* –ë–ª–æ—á–Ω—ã–π
   –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π */

/// Documentation comment –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
/// –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Markdown!
fn documented_function() {}

//! Documentation comment –¥–ª—è —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–æ–¥—É–ª—è
```

**Best practice**: –∏—Å–ø–æ–ª—å–∑—É–π `//` –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, `///` –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API.

---

## 5. –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å)

### 5.1 if Expressions

```rust
let number = 7;

if number < 5 {
    println!("condition was true");
} else {
    println!("condition was false");
}
```

**–í–∞–∂–Ω–æ:** —É—Å–ª–æ–≤–∏–µ **–æ–±—è–∑–∞–Ω–æ** –±—ã—Ç—å `bool`. –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫ boolean!

```rust
let number = 3;
// if number { ... } // ‚ùå –û–®–ò–ë–ö–ê
if number != 0 { /* ... */ } // ‚úÖ OK
```

**if –∫–∞–∫ expression:**

```rust
let condition = true;
let number = if condition { 5 } else { 6 };
// number == 5
```

–¢–∏–ø—ã –≤ –æ–±–µ–∏—Ö –≤–µ—Ç–∫–∞—Ö **–¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å**:

```rust
// let number = if condition { 5 } else { "six" }; // ‚ùå –û–®–ò–ë–ö–ê
```

---

## üéì –§–∏–ª–æ—Å–æ—Ñ–∏—è –∏ –≥–ª—É–±–∏–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### Ownership (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ)

–•–æ—Ç—è ownership –º—ã –±—É–¥–µ–º –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –ø–æ–∑–∂–µ, –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –±–∞–∑–æ–≤—É—é –∏–¥–µ—é —É–∂–µ —Å–µ–π—á–∞—Å:

**–ö–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ Rust –∏–º–µ–µ—Ç "–≤–ª–∞–¥–µ–ª—å—Ü–∞"** ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –∑–∞ –Ω–µ–≥–æ –æ—Ç–≤–µ—á–∞–µ—Ç.

```rust
let s1 = String::from("hello");
let s2 = s1;  // s1 –±–æ–ª—å—à–µ –Ω–µ –≤–∞–ª–∏–¥–Ω–∞!
// println!("{}", s1); // ‚ùå –û–®–ò–ë–ö–ê
```

–î–ª—è –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤ (i32, bool, char) —ç—Ç–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è ‚Äî –æ–Ω–∏ **–∫–æ–ø–∏—Ä—É—é—Ç—Å—è**:

```rust
let x = 5;
let y = x;  // x –≤—Å—ë –µ—â—ë –≤–∞–ª–∏–¥–Ω–∞
println!("{} {}", x, y); // ‚úÖ OK
```

**–ü–æ—á–µ–º—É?** –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ —Ç–∏–ø—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç —Ç—Ä–µ–π—Ç `Copy` –∏ –ª–µ–∂–∞—Ç –Ω–∞ —Å—Ç–µ–∫–µ. –î–µ—à–µ–≤–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å.

### Zero-cost abstractions

–ú–Ω–æ–≥–∏–µ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Rust (iterators, closures) –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –≤ —Ç–æ—Ç –∂–µ –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥, —á—Ç–æ –∏ —Ä—É—á–Ω—ã–µ —Ü–∏–∫–ª—ã.

```rust
// –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ
let sum: i32 = (1..=10).sum();

// –ö–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ —Ç–æ—Ç –∂–µ –∫–æ–¥, —á—Ç–æ –∏:
let mut sum = 0;
for i in 1..=10 {
    sum += i;
}
```

**–ù–µ—Ç runtime overhead** ‚Äî —ç—Ç–æ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è Rust.

### Memory safety –±–µ–∑ garbage collector

Rust –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç memory safety —á–µ—Ä–µ–∑:
1. **Ownership system** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
2. **Borrow checker** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫ –Ω–∞ compile-time
3. **Lifetime annotations** ‚Äî —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ (–∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ)

–í—Å—ë —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç **–±–µ–∑ runtime overhead** GC.

---

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∏–¥–∏–æ–º—ã

### 1. –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π immutable –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```rust
// ‚ùå –ò–∑–±–µ–≥–∞–π
let mut x = calculate_value();
// ... 100 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ ...
x = x + 1;

// ‚úÖ –õ—É—á—à–µ
let x = calculate_value();
// ... 100 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ ...
let x = x + 1; // shadowing
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π type inference —Ä–∞–∑—É–º–Ω–æ

```rust
// ‚úÖ –û—á–µ–≤–∏–¥–Ω—ã–µ —Å–ª—É—á–∞–∏
let x = 5;
let name = "Alice";

// ‚úÖ –ù–µ–æ—á–µ–≤–∏–¥–Ω—ã–µ —Ç–∏–ø—ã ‚Äî –∞–Ω–Ω–æ—Ç–∏—Ä—É–π
let users: Vec<User> = fetch_users();
let result: Result<String, Error> = parse_data();
```

### 3. Expression-oriented —Å—Ç–∏–ª—å

```rust
// ‚ùå Statement-oriented (–∫–∞–∫ –≤ C/Java)
let mut result;
if condition {
    result = 5;
} else {
    result = 6;
}

// ‚úÖ Expression-oriented (idiomatic Rust)
let result = if condition { 5 } else { 6 };
```

### 4. –ò–∑–±–µ–≥–∞–π –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —á–∏—Å–µ–ª

```rust
// ‚ùå
if age > 18 { /* ... */ }

// ‚úÖ
const ADULT_AGE: u8 = 18;
if age > ADULT_AGE { /* ... */ }
```

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å

### 1. –ó–∞–±—ã–ª `mut`

```rust
let x = 5;
x = 6; // ‚ùå cannot assign twice to immutable variable
```

**–†–µ—à–µ–Ω–∏–µ:** –¥–æ–±–∞–≤—å `mut` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π shadowing.

### 2. –¢–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π –≤ return expression

```rust
fn add(a: i32, b: i32) -> i32 {
    a + b;  // ‚ùå –ø–æ–º–æ–≥ –±—ã —É–¥–∞–ª–∏—Ç—å ;
}
```

### 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ f64 –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ

```rust
let x = 0.1 + 0.2;
if x == 0.3 { /* ... */ } // ‚ùå –û–ø–∞—Å–Ω–æ –∏–∑-–∑–∞ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏ floating-point
```

**–†–µ—à–µ–Ω–∏–µ:** –∏—Å–ø–æ–ª—å–∑—É–π epsilon-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ:

```rust
fn approx_equal(a: f64, b: f64, epsilon: f64) -> bool {
    (a - b).abs() < epsilon
}
```

### 4. –í—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞

```rust
let a = [1, 2, 3];
let idx = 10;
let x = a[idx]; // ‚ùå RUNTIME PANIC
```

**–†–µ—à–µ–Ω–∏–µ:** –∏—Å–ø–æ–ª—å–∑—É–π `.get()` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:

```rust
match a.get(idx) {
    Some(value) => println!("Value: {}", value),
    None => println!("Index out of bounds"),
}
```

---

## üìö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ —è–∑—ã–∫–∞–º–∏

### Python vs Rust

```python
# Python
x = 5
x = "hello"  # OK, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
```

```rust
// Rust
let x = 5;
// let x = "hello"; // ‚ùå –û–®–ò–ë–ö–ê –±–µ–∑ shadowing

let x = 5;
let x = "hello"; // ‚úÖ OK —Å shadowing (–Ω–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)
```

### C/C++ vs Rust

```c
// C
int x = 5;
x = 6; // OK, mutable by default

int arr[3] = {1, 2, 3};
int val = arr[10]; // Undefined behavior! üíÄ
```

```rust
// Rust
let x = 5;
// x = 6; // ‚ùå –û–®–ò–ë–ö–ê, immutable by default

let mut x = 5;
x = 6; // ‚úÖ OK

let arr = [1, 2, 3];
// let val = arr[10]; // üí• PANIC, –Ω–æ –Ω–µ UB
```

### Go vs Rust

```go
// Go
x := 5  // —Ç–∏–ø –≤—ã–≤–æ–¥–∏—Ç—Å—è
var y int = 10 // —è–≤–Ω—ã–π —Ç–∏–ø
```

```rust
// Rust
let x = 5;  // —Ç–∏–ø –≤—ã–≤–æ–¥–∏—Ç—Å—è
let y: i32 = 10; // —è–≤–Ω—ã–π —Ç–∏–ø
```

–û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞: Go ‚Äî garbage collected, Rust ‚Äî ownership-based memory management.

---

## üß† –ú–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞–∫ "boxes" —Å –º–µ—Ç–∫–∞–º–∏

```rust
let x = 5;
```

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —ç—Ç–æ –∫–∞–∫:
- **Box** (–º–µ—Å—Ç–æ –≤ –ø–∞–º—è—Ç–∏) —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `5`
- **Label** `x` –ø—Ä–∏–∫–ª–µ–µ–Ω–∞ –∫ —ç—Ç–æ–º—É box
- `let x = 10;` (shadowing) ‚Äî **–Ω–æ–≤–∞—è** –∫–æ—Ä–æ–±–∫–∞ —Å —Ç–æ–π –∂–µ –º–µ—Ç–∫–æ–π

### 2. –§—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ —á—ë—Ä–Ω—ã–µ —è—â–∏–∫–∏ —Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º

```rust
fn add(a: i32, b: i32) -> i32 { /* ... */ }
```

- **–í—Ö–æ–¥:** –¥–≤–∞ `i32`
- **–í—ã—Ö–æ–¥:** –æ–¥–∏–Ω `i32`
- **–ö–æ–Ω—Ç—Ä–∞–∫—Ç** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º

### 3. –¢–∏–ø—ã –∫–∞–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

- `bool` ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ {true, false}
- `u8` ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ {0, 1, 2, ..., 255}
- `i32` ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ {-2¬≥¬π, ..., 2¬≥¬π-1}

–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å = –≥–∞—Ä–∞–Ω—Ç–∏—è, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Å–≤–æ–µ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É.

---

## üî• –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ

1. **–í —á—ë–º –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `let x = 5;` –∏ `let mut x = 5;`?**

2. **–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –∏ –ø–æ—á–µ–º—É?**
   ```rust
   let x = 5;
   let x = x + 1;
   let x = x * 2;
   println!("{}", x);
   ```

3. **–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è?**
   ```rust
   let spaces = "   ";
   let mut spaces = spaces.len();
   ```

4. **–ö–∞–∫–æ–π –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ç–∏–ø –¥–ª—è —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª –≤ Rust? –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –æ–Ω?**

5. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `char` –≤ Rust –∏ `char` –≤ C?**

### –£—Ä–æ–≤–µ–Ω—å 2: –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ

6. **–û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É statement –∏ expression. –ß—Ç–æ –≤–µ—Ä–Ω—ë—Ç —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è?**
   ```rust
   fn mystery() -> i32 {
       let x = 3;
       x + 1;
   }
   ```

7. **–ü–æ—á–µ–º—É Rust –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —á–∏—Å–µ–ª –∫ `bool` –≤ —É—Å–ª–æ–≤–∏—è—Ö?**
   ```rust
   let number = 3;
   if number { /* ... */ } // ‚ùå
   ```

8. **–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å shadowing, –∞ –∫–æ–≥–¥–∞ `mut`? –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä—ã.**

### –£—Ä–æ–≤–µ–Ω—å 3: –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ

9. **–ß—Ç–æ —Ç–∞–∫–æ–µ zero-cost abstractions –∏ –ø–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è Rust? –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä.**

10. **–û–±—ä—è—Å–Ω–∏, –ø–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∞ —Å–ª–µ–¥—É—é—â–∏–π ‚Äî –Ω–µ—Ç:**
    ```rust
    // –†–∞–±–æ—Ç–∞–µ—Ç
    let x = 5;
    let y = x;
    println!("{} {}", x, y);
    
    // –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
    let s1 = String::from("hello");
    let s2 = s1;
    println!("{} {}", s1, s2);
    ```

### –ë–æ–Ω—É—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å üöÄ

11. **–ö–∞–∫ –¥—É–º–∞–µ—à—å, –ø–æ—á–µ–º—É –≤ Rust `bool` –∑–∞–Ω–∏–º–∞–µ—Ç 1 –±–∞–π—Ç, –∞ –Ω–µ 1 –±–∏—Ç?**

---

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–í —Å–ª–µ–¥—É—é—â–µ–π —Ç–µ–º–µ –º—ã —Ä–∞–∑–±–µ—Ä—ë–º:
- **–°–æ—Å—Ç–∞–≤–Ω—ã–µ —Ç–∏–ø—ã** (–∫–æ—Ä—Ç–µ–∂–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, enum'—ã) –¥–µ—Ç–∞–ª—å–Ω–æ
- **Pattern matching** ‚Äî –º–æ—â–Ω–µ–π—à—É—é —Ñ–∏—á—É Rust
- **–ú–µ—Ç–æ–¥—ã –∏ –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**

–≠—Ç–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Å—Ç—Ä–æ—è—Ç—Å—è –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ —Ç–∏–ø–æ–≤ –∏ ownership, —Ç–∞–∫ —á—Ç–æ —É–±–µ–¥–∏—Å—å, —á—Ç–æ —Ö–æ—Ä–æ—à–æ —É—Å–≤–æ–∏–ª –º–∞—Ç–µ—Ä–∏–∞–ª —ç—Ç–æ–π —Ç–µ–º—ã!

---

## üìö –¢–µ–º–∞ 4: –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏. –í–µ—Ç–≤–ª–µ–Ω–∏–µ –∏ —Ü–∏–∫–ª—ã

### üéØ –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è —Ç–µ–º—ã

–í Python —Ç—ã –ø—Ä–∏–≤—ã–∫ –∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ –≥–∏–±–∫–æ—Å—Ç–∏. Rust - —ç—Ç–æ **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è** + **–Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**. –≠—Ç–æ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –∞ —Ñ–∏—á–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

### 1Ô∏è‚É£ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: –ù–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –∫–∞–∫ default

#### –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?

–í Rust –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ **–∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**. –≠—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–±—è —è–≤–Ω–æ –¥—É–º–∞—Ç—å –æ —Ç–æ–º, –≥–¥–µ –Ω—É–∂–Ω–∞ –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å.

```rust
// ‚ùå –≠—Ç–æ –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
let x = 5;
x = 6; // Error: cannot assign twice to immutable variable

// ‚úÖ –ù—É–∂–Ω–∞ —è–≤–Ω–∞—è –º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
let mut y = 5;
y = 6; // OK
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Python:**
```python
# Python - –≤—Å—ë –º—É—Ç–∞–±–µ–ª—å–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
x = 5
x = 6  # –í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

#### Shadowing - –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–µ–∑ mut

```rust
let x = 5;
let x = x + 1;  // –ù–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, —Å—Ç–∞—Ä–∞—è "–∑–∞—Ç–µ–Ω–µ–Ω–∞"
let x = x * 2;  // –ò —Å–Ω–æ–≤–∞ –Ω–æ–≤–∞—è
println!("{}", x); // 12

// –ú–æ–∂–Ω–æ –¥–∞–∂–µ –º–µ–Ω—è—Ç—å —Ç–∏–ø!
let spaces = "   ";
let spaces = spaces.len(); // String -> usize
```

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–º—ë–Ω –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

### 2Ô∏è‚É£ –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö: –ß—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –∑–Ω–∞—Ç—å

#### –°–∫–∞–ª—è—Ä–Ω—ã–µ —Ç–∏–ø—ã

```rust
// –¶–µ–ª—ã–µ —á–∏—Å–ª–∞ - —Ä–∞–∑–º–µ—Ä –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ!
let small: i8 = -128;      // 1 –±–∞–π—Ç: -128..127
let medium: i32 = 42;      // 4 –±–∞–π—Ç–∞ (default –¥–ª—è int)
let big: i64 = 1_000_000;  // 8 –±–∞–π—Ç
let unsigned: u32 = 42;    // –¢–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ

// –ß–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
let pi: f64 = 3.14159;     // 8 –±–∞–π—Ç (default)
let small_float: f32 = 3.14; // 4 –±–∞–π—Ç–∞

// –ë—É–ª–µ–≤—ã –∏ —Å–∏–º–≤–æ–ª—ã
let is_ready: bool = true;
let emoji: char = 'ü¶Ä';    // Unicode, 4 –±–∞–π—Ç–∞!
```

**–í–∞–∂–Ω–æ –¥–ª—è ML:** –ö–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—à—å —Å —Ç–µ–Ω–∑–æ—Ä–∞–º–∏/–º–∞—Å—Å–∏–≤–∞–º–∏, —Ä–∞–∑–º–µ—Ä —Ç–∏–ø–∞ = —Ä–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏. `Vec<f32>` –∑–∞–π–º—ë—Ç –≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ —á–µ–º `Vec<f64>`.

#### –°–æ—Å—Ç–∞–≤–Ω—ã–µ —Ç–∏–ø—ã

```rust
// –ö–æ—Ä—Ç–µ–∂–∏ - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã
let user: (&str, i32, bool) = ("alice", 25, true);
let (name, age, _) = user; // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è
let age = user.1;          // –î–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É

// –ú–∞—Å—Å–∏–≤—ã - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –æ–¥–∏–Ω —Ç–∏–ø
let months: [&str; 12] = ["Jan", "Feb", /*...*/ "Dec"];
let zeros = [0; 100];  // [0, 0, 0, ...] - 100 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
```

**–ú–∞—Å—Å–∏–≤ vs Vector:**
```rust
// –ú–∞—Å—Å–∏–≤ - —Ä–∞–∑–º–µ—Ä –∏–∑–≤–µ—Å—Ç–µ–Ω –≤ compile time
let arr: [i32; 3] = [1, 2, 3];  // –°—Ç–µ–∫, –±—ã—Å—Ç—Ä–æ, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ

// Vector - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä
let mut vec: Vec<i32> = vec![1, 2, 3];  // –ö—É—á–∞, –≥–∏–±–∫–æ
vec.push(4);  // –ú–æ–∂–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å
```

---

### 3Ô∏è‚É£ –§—É–Ω–∫—Ü–∏–∏: –í—ã—Ä–∞–∂–µ–Ω–∏—è vs –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

#### –ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Python

–í Rust –ø–æ—á—Ç–∏ –≤—Å—ë - **–≤—ã—Ä–∞–∂–µ–Ω–∏–µ** (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ). –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (statements) –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è.

```rust
fn add(x: i32, y: i32) -> i32 {
    x + y  // ‚úÖ –í—ã—Ä–∞–∂–µ–Ω–∏–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–±–µ–∑ ;)
}

fn bad_add(x: i32, y: i32) -> i32 {
    x + y;  // ‚ùå –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ - –≤–µ—Ä–Ω—ë—Ç (), –Ω–µ i32
}

fn main() {
    let result = add(5, 3);  // 8
    
    // –ë–ª–æ–∫–∏ - —Ç–æ–∂–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è!
    let computed = {
        let a = 10;
        let b = 20;
        a + b  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –±–µ–∑ return
    };
    println!("{}", computed); // 30
}
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**
- –ú–µ–Ω—å—à–µ `return` –≤ –∫–æ–¥–µ
- –ë–æ–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å
- –ë–ª–æ–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏—è

#### –°–∏–≥–Ω–∞—Ç—É—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π

```rust
// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—Å–µ–≥–¥–∞ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
fn process(data: &str, count: usize) -> Result<String, Error> {
    // ...
}

// Unit type () - "–Ω–∏—á–µ–≥–æ" (–∫–∞–∫ None –≤ Python)
fn log(message: &str) {  // -> () –Ω–µ—è–≤–Ω–æ
    println!("{}", message);
}

// –ù–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤
fn classify(score: f32) -> &'static str {
    if score >= 0.9 {
        return "excellent";
    }
    if score >= 0.7 {
        return "good";
    }
    "needs improvement"  // –ü–æ—Å–ª–µ–¥–Ω–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
}
```

---

### 4Ô∏è‚É£ –í–µ—Ç–≤–ª–µ–Ω–∏–µ: if –∫–∞–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ

```rust
// if –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ!
let score = 85;
let grade = if score >= 90 {
    "A"
} else if score >= 80 {
    "B"
} else {
    "C"
};  // –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ ;

// –í–µ—Ç–∫–∏ –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–¥–∏–Ω —Ç–∏–ø
let number = if condition { 5 } else { 10 };  // ‚úÖ
let mixed = if condition { 5 } else { "no" }; // ‚ùå –û—à–∏–±–∫–∞ —Ç–∏–ø–æ–≤
```

**Pattern matching - –±–æ–ª–µ–µ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:**

```rust
let status_code = 404;

match status_code {
    200 => println!("OK"),
    404 => println!("Not Found"),
    500 => println!("Server Error"),
    code => println!("Unknown: {}", code),  // Default case
}

// –í–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ match
let message = match status_code {
    200 => "Success",
    404 => "Not Found",
    _ => "Other",  // _ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
};

// –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
match temperature {
    -100..=-1 => "freezing",
    0..=15 => "cold",
    16..=25 => "comfortable",
    26..=35 => "hot",
    _ => "extreme",
}
```

---

### 5Ô∏è‚É£ –¶–∏–∫–ª—ã: loop, while, for

#### loop - –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º

```rust
let mut counter = 0;

// –ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ loop!
let result = loop {
    counter += 1;
    
    if counter == 10 {
        break counter * 2;  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
    }
};
println!("{}", result); // 20
```

#### while - —É—Å–ª–æ–≤–Ω—ã–π —Ü–∏–∫–ª

```rust
let mut n = 0;
while n < 5 {
    println!("{}", n);
    n += 1;
}
```

#### for - –∏—Ç–µ—Ä–∞—Ü–∏—è (—Å–∞–º—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π)

```rust
// –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É
for i in 0..5 {  // 0, 1, 2, 3, 4 (–Ω–µ –≤–∫–ª—é—á–∞—è 5)
    println!("{}", i);
}

for i in 0..=5 {  // 0, 1, 2, 3, 4, 5 (–≤–∫–ª—é—á–∞—è 5)
    println!("{}", i);
}

// –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
let numbers = vec![1, 2, 3, 4, 5];

for num in &numbers {  // –ó–∞–∏–º—Å—Ç–≤—É–µ–º, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ–º
    println!("{}", num);
}

for (index, value) in numbers.iter().enumerate() {
    println!("{}: {}", index, value);
}
```

**–í–∞–∂–Ω–æ:** –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Python, `for` –≤ Rust **–≤—Å–µ–≥–¥–∞** –∏—Ç–µ—Ä–∏—Ä—É–µ—Ç, –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ `for i in range()` —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º —à–∞–≥–æ–º –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏—Ç–µ—Ä–∞—Ç–æ—Ä–æ–≤.

---

## üìö –¢–µ–º–∞ 5: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ. –¢—Ä–µ–π—Ç Copy. –ü—Ä–∏–Ω—Ü–∏–ø –≤–ª–∞–¥–µ–Ω–∏—è

### üéØ –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è —Ç–µ–º—ã

–≠—Ç–æ **–°–ê–ú–ê–Ø –í–ê–ñ–ù–ê–Ø** —Ç–µ–º–∞ –≤ Rust. Ownership (–≤–ª–∞–¥–µ–Ω–∏–µ) - —ç—Ç–æ —Ç–æ, —á—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç Rust –æ—Ç –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–≥–æ = –ø–æ–Ω–∏–º–∞–Ω–∏–µ 80% —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —è–∑—ã–∫–∞.

**–ì–ª–∞–≤–Ω–∞—è –º—ã—Å–ª—å:** –í Rust —É –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –µ—Å—Ç—å **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü**. –ö–æ–≥–¥–∞ –≤–ª–∞–¥–µ–ª–µ—Ü –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏, –∑–Ω–∞—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è.

---

### 1Ô∏è‚É£ –ü–æ—á–µ–º—É —ç—Ç–æ –Ω—É–∂–Ω–æ?

#### –ü—Ä–æ–±–ª–µ–º—ã –≤ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö

**C/C++:**
```c
// –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
int* data = malloc(sizeof(int) * 100);
// ... –∏—Å–ø–æ–ª—å–∑—É–µ–º data ...
free(data);  // –õ–µ–≥–∫–æ –∑–∞–±—ã—Ç—å!
// double free, use after free, memory leaks
```

**Python:**
```python
# Garbage collection - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ, –Ω–æ:
# - –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –ø–∞—É–∑—ã
# - –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏
# - Overhead –Ω–∞ –ø–æ–¥—Å—á—ë—Ç —Å—Å—ã–ª–æ–∫
data = [1, 2, 3]  # GC —Å–ª–µ–¥–∏—Ç –∑–∞ —Å—Å—ã–ª–∫–∞–º–∏
```

**Rust:**
```rust
{
    let data = vec![1, 2, 3];  // –í–ª–∞–¥–µ–ª–µ—Ü - data
    // ... –∏—Å–ø–æ–ª—å–∑—É–µ–º data ...
}  // data –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ scope -> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
// –ù–∏–∫–∞–∫–∏—Ö —É—Ç–µ—á–µ–∫, –Ω–∏–∫–∞–∫–æ–≥–æ GC, –Ω–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫
```

---

### 2Ô∏è‚É£ Move semantics - –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–ª–∞–¥–µ–Ω–∏—è

#### –ë–∞–∑–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ

```rust
let s1 = String::from("hello");
let s2 = s1;  // s1 –ü–ï–†–ï–ú–ï–©–Å–ù –≤ s2

println!("{}", s2);  // ‚úÖ OK
println!("{}", s1);  // ‚ùå Error: value borrowed after move
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. `s1` –≤–ª–∞–¥–µ–µ—Ç —Å—Ç—Ä–æ–∫–æ–π "hello" –≤ –∫—É—á–µ
2. `s2 = s1` **–ø–µ—Ä–µ–º–µ—â–∞–µ—Ç** –≤–ª–∞–¥–µ–Ω–∏–µ –∫ `s2`
3. `s1` –±–æ–ª—å—à–µ –Ω–µ –≤–∞–ª–∏–¥–Ω–∞ - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –¥–∞—Å—Ç –µ—ë –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
```
–î–æ:    s1 -> ["hello" –≤ –∫—É—á–µ]
–ü–æ—Å–ª–µ: s1 (–Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞)
       s2 -> ["hello" –≤ –∫—É—á–µ]
```

#### –ó–∞—á–µ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ, –∞ –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ?

```rust
// –ü—Ä–µ–¥—Å—Ç–∞–≤—å –±–æ–ª—å—à–æ–π –≤–µ–∫—Ç–æ—Ä
let big_data = vec![0; 1_000_000];  // 1 –º–∏–ª–ª–∏–æ–Ω —ç–ª–µ–º–µ–Ω—Ç–æ–≤

let data2 = big_data;  // Move, –∞ –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ!
// –û–ø–µ—Ä–∞—Ü–∏—è O(1), –∞ –Ω–µ O(n)
// –¢–æ–ª—å–∫–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è, –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞–ª–∏—Å—å –Ω–∞ –º–µ—Å—Ç–µ
```

---

### 3Ô∏è‚É£ Clone - –Ø–≤–Ω–æ–µ –≥–ª—É–±–æ–∫–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω—ã –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–æ–ø–∏–∏:

```rust
let s1 = String::from("hello");
let s2 = s1.clone();  // –Ø–≤–Ω–æ–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

println!("{}", s1);  // ‚úÖ OK
println!("{}", s2);  // ‚úÖ OK
// –¢–µ–ø–µ—Ä—å –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ –ø–∞–º—è—Ç–∏
```

**Clone - –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è:**
```rust
let big_vec = vec![1; 1_000_000];
let copy = big_vec.clone();  // –ö–æ–ø–∏—Ä—É–µ–º 1–ú —ç–ª–µ–º–µ–Ω—Ç–æ–≤ - –º–µ–¥–ª–µ–Ω–Ω–æ!

// –ò—Å–ø–æ–ª—å–∑—É–π clone –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ
```

---

### 4Ô∏è‚É£ Copy trait - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–∏–ø—ã **–∫–æ–ø–∏—Ä—É—é—Ç—Å—è** –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è:

```rust
let x = 5;
let y = x;  // –ö–æ–ø–∏—Ä—É–µ—Ç—Å—è, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è

println!("{}", x);  // ‚úÖ OK - x –≤—Å—ë –µ—â—ë –≤–∞–ª–∏–¥–Ω–∞
println!("{}", y);  // ‚úÖ OK
```

**–ö–∞–∫–∏–µ —Ç–∏–ø—ã –∏–º–µ—é—Ç Copy:**
- –í—Å–µ —á–∏—Å–ª–æ–≤—ã–µ —Ç–∏–ø—ã: `i32`, `u64`, `f64`, etc.
- `bool`
- `char`
- –ö–æ—Ä—Ç–µ–∂–∏, –µ—Å–ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç Copy: `(i32, i32)`
- **–ù–ï –∏–º–µ—é—Ç Copy:** `String`, `Vec<T>`, –∏ –ª—é–±—ã–µ —Ç–∏–ø—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –∫—É—á–µ

```rust
// Copy —Ç–∏–ø—ã - –Ω–∞ —Å—Ç–µ–∫–µ, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä
let a = 42;
let b = a;  // –ö–æ–ø–∏—è

// –ù–µ-Copy —Ç–∏–ø—ã - –º–æ–≥—É—Ç –±—ã—Ç—å –≤ –∫—É—á–µ
let s1 = String::from("hello");
let s2 = s1;  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ
```

**–ü–æ—á–µ–º—É String –Ω–µ Copy?**
```rust
// String —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:
// - —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ
// - –¥–ª–∏–Ω—ã
// - —ë–º–∫–æ—Å—Ç–∏
// –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞—Ç–µ–ª—è -> –¥–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–ª–∞–¥–µ—é—Ç –æ–¥–Ω–æ–π –ø–∞–º—è—Ç—å—é -> double free!
// –ü–æ—ç—Ç–æ–º—É String –∏—Å–ø–æ–ª—å–∑—É–µ—Ç move
```

---

### 5Ô∏è‚É£ Ownership –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö

#### –ü–µ—Ä–µ–¥–∞—á–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—é = –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ

```rust
fn take_ownership(s: String) {
    println!("{}", s);
}  // s —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è –∑–¥–µ—Å—å

fn main() {
    let my_string = String::from("hello");
    take_ownership(my_string);  // my_string –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞
    
    // println!("{}", my_string);  // ‚ùå Error - —É–∂–µ –Ω–µ –≤–ª–∞–¥–µ–µ–º
}
```

#### –í–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏—è = –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ

```rust
fn give_ownership() -> String {
    let s = String::from("hello");
    s  // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –Ω–∞—Ä—É–∂—É
}

fn take_and_give(s: String) -> String {
    s  // –ë–µ—Ä—ë–º –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
}

fn main() {
    let s1 = give_ownership();        // OK
    let s2 = String::from("world");
    let s3 = take_and_give(s2);       // s2 –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞, –ø–æ–ª—É—á–∏–ª–∏ s3
}
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω "–≤–∑—è—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å" –≥—Ä–æ–º–æ–∑–¥–∫–∏–π:

```rust
fn calculate_length(s: String) -> (String, usize) {
    let length = s.len();
    (s, length)  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ + —Ä–µ–∑—É–ª—å—Ç–∞—Ç
}

fn main() {
    let s1 = String::from("hello");
    let (s2, len) = calculate_length(s1);
    // –ì—Ä–æ–º–æ–∑–¥–∫–æ! –ï—Å—Ç—å –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± - —Å—Å—ã–ª–∫–∏
}
```

---

## üìö –¢–µ–º–∞ 6: –í–ª–∞–¥–µ–Ω–∏–µ. –°—Å—ã–ª–∫–∏ –∏ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ

### üéØ –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è —Ç–µ–º—ã

**–ó–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ (borrowing)** –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ **–±–µ–∑ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–ª–∞–¥–µ–Ω–∏—è**. –≠—Ç–æ –∫–∞–∫ –≤–∑—è—Ç—å –∫–Ω–∏–≥—É –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ - –º–æ–∂–µ—à—å —á–∏—Ç–∞—Ç—å, –Ω–æ –Ω–µ –≤–ª–∞–¥–µ–µ—à—å.

---

### 1Ô∏è‚É£ –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (&T)

```rust
fn calculate_length(s: &String) -> usize {
    s.len()
}  // s –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ scope, –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥—Ä–æ–ø–∞–µ—Ç—Å—è - –º—ã –Ω–µ –≤–ª–∞–¥–µ–µ–º

fn main() {
    let s1 = String::from("hello");
    let len = calculate_length(&s1);  // –ó–∞–∏–º—Å—Ç–≤—É–µ–º
    
    println!("Length of '{}' is {}", s1, len);  // s1 –≤—Å—ë –µ—â—ë –≤–∞–ª–∏–¥–Ω–∞!
}
```

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
```
s1 -> [String –≤ –∫—É—á–µ: "hello"]
       ‚Üë
       &s1 (—Å—Å—ã–ª–∫–∞, –Ω–µ –≤–ª–∞–¥–µ–µ—Ç)
```

#### –ù–µ—Å–∫–æ–ª—å–∫–æ –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ - OK

```rust
let s = String::from("hello");
let r1 = &s;
let r2 = &s;
let r3 = &s;

println!("{}, {}, {}", r1, r2, r3);  // ‚úÖ –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
// –ú–æ–∂–Ω–æ –∏–º–µ—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ read-only —Å—Å—ã–ª–æ–∫
```

---

### 2Ô∏è‚É£ –ú—É—Ç–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (&mut T)

```rust
fn append_world(s: &mut String) {
    s.push_str(", world");
}

fn main() {
    let mut s = String::from("hello");
    append_world(&mut s);
    println!("{}", s);  // "hello, world"
}
```

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞

```rust
let mut s = String::from("hello");

let r1 = &mut s;
let r2 = &mut s;  // ‚ùå Error: cannot borrow as mutable more than once

println!("{}, {}", r1, r2);
```

**–ü–æ—á–µ–º—É?** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ **data races** –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:
```rust
// –ì–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π data race (–≤ Rust –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω):
let mut data = vec![1, 2, 3];
let ref1 = &mut data;
let ref2 = &mut data;

ref1.push(4);        // –ú–æ–∂–µ—Ç —Ä–µ–∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–∞–º—è—Ç—å
ref2.push(5);        // ref1 —Ç–µ–ø–µ—Ä—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ—Å–≤–æ–±–æ–∂–¥—ë–Ω–Ω—É—é –ø–∞–º—è—Ç—å - BOOM!
```

---

### 3Ô∏è‚É£ –ü—Ä–∞–≤–∏–ª–∞ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—è (The Rules)

**–ì–ª–∞–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞:**

1. **–í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç** –º–æ–∂–µ—Ç –±—ã—Ç—å **–ª–∏–±–æ**:
   - –û–¥–Ω–∞ –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ (`&mut T`)
   - –õ—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ (`&T`)

2. –°—Å—ã–ª–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–≤—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–Ω—ã–º–∏** (no dangling references)

```rust
// ‚ùå –ù–µ–ª—å–∑—è: –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è + –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω–∞—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
let mut s = String::from("hello");
let r1 = &s;      // OK
let r2 = &s;      // OK
let r3 = &mut s;  // ‚ùå Error: cannot borrow as mutable

println!("{}, {}, {}", r1, r2, r3);
```

#### Non-Lexical Lifetimes (NLL)

–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–º–Ω—ã–π:

```rust
let mut s = String::from("hello");

let r1 = &s;
let r2 = &s;
println!("{}, {}", r1, r2);  // r1 –∏ r2 –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–¥–µ—Å—å

let r3 = &mut s;  // ‚úÖ OK - r1 –∏ r2 –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
println!("{}", r3);
```

**–û–±–ª–∞—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—è —Å—Å—ã–ª–∫–∏** = –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ scope.

---

### 4Ô∏è‚É£ –í–∏—Å—è—á–∏–µ —Å—Å—ã–ª–∫–∏ - –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã

```rust
fn dangle() -> &String {  // ‚ùå Error: missing lifetime specifier
    let s = String::from("hello");
    &s  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
}  // s —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è, —Å—Å—ã–ª–∫–∞ —Å—Ç–∞–Ω–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π
```

**–í Python/C++ —Ç–∞–∫–æ–π –∫–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ –≤—ã–∑—ã–≤–∞–µ—Ç undefined behavior:**
```python
def dangle():
    s = "hello"
    return s  # –í Python OK –∏–∑-–∑–∞ GC, –Ω–æ –≤ C++ - –±–µ–¥–∞
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ Rust:**
```rust
fn no_dangle() -> String {
    let s = String::from("hello");
    s  // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –≤–ª–∞–¥–µ–Ω–∏–µ –Ω–∞—Ä—É–∂—É
}
```

---

### 5Ô∏è‚É£ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

#### –ü–∞—Ç—Ç–µ—Ä–Ω 1: –ß—Ç–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```rust
fn analyze_data(data: &Vec<f32>) -> f32 {
    data.iter().sum::<f32>() / data.len() as f32
}

let metrics = vec![1.0, 2.0, 3.0];
let avg = analyze_data(&metrics);  // –ó–∞–∏–º—Å—Ç–≤—É–µ–º –¥–ª—è —á—Ç–µ–Ω–∏—è
println!("Average: {}, Data: {:?}", avg, metrics);  // metrics –≤—Å—ë –µ—â—ë –¥–æ—Å—Ç—É–ø–Ω–∞
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω 2: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –º–µ—Å—Ç–µ

```rust
fn normalize(data: &mut Vec<f32>) {
    let max = data.iter().cloned().fold(f32::MIN, f32::max);
    for val in data.iter_mut() {
        *val /= max;
    }
}

let mut scores = vec![10.0, 20.0, 30.0];
normalize(&mut scores);  // –ò–∑–º–µ–Ω—è–µ–º in-place
println!("{:?}", scores);  // [0.33, 0.67, 1.0]
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω 3: –ú–µ—Ç–æ–¥-—Å—Ç—Ä–æ–∏—Ç–µ–ª—å (builder pattern)

```rust
struct Config {
    host: String,
    port: u16,
}

impl Config {
    fn new() -> Self {
        Config {
            host: "localhost".to_string(),
            port: 8080,
        }
    }
    
    fn set_host(&mut self, host: &str) -> &mut Self {
        self.host = host.to_string();
        self  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º—É—Ç–∞–±–µ–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è chaining
    }
    
    fn set_port(&mut self, port: u16) -> &mut Self {
        self.port = port;
        self
    }
}

let mut config = Config::new();
config.set_host("0.0.0.0").set_port(3000);
```

---

### 6Ô∏è‚É£ Slice - —Å—Å—ã–ª–∫–∏ –Ω–∞ —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

Slice - —ç—Ç–æ —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–∏:

```rust
let s = String::from("hello world");

let hello = &s[0..5];   // "hello"
let world = &s[6..11];  // "world"

// –°–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞
let hello = &s[..5];    // –° –Ω–∞—á–∞–ª–∞ –¥–æ 5
let world = &s[6..];    // –° 6 –¥–æ –∫–æ–Ω—Ü–∞
let full = &s[..];      // –í—Å—è —Å—Ç—Ä–æ–∫–∞
```

#### String slices (&str)

```rust
fn first_word(s: &String) -> &str {
    let bytes = s.as_bytes();
    
    for (i, &byte) in bytes.iter().enumerate() {
        if byte == b' ' {
            return &s[..i];
        }
    }
    
    &s[..]
}

let sentence = String::from("hello world");
let word = first_word(&sentence);
println!("{}", word);  // "hello"
```

**String vs &str:**
- `String` - –≤–ª–∞–¥–µ—é—â–∏–π —Ç–∏–ø, –∏–∑–º–µ–Ω—è–µ–º—ã–π, –≤ –∫—É—á–µ
- `&str` - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç—Ä–æ–∫—É, –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π, –º–æ–∂–µ—Ç –±—ã—Ç—å —á–∞—Å—Ç—å—é String –∏–ª–∏ string literal

```rust
let owned: String = String::from("hello");  // –í–ª–∞–¥–µ—é—â–∏–π
let borrowed: &str = "hello";               // String literal
let slice: &str = &owned[..];               // Slice –∏–∑ String
```

#### Array slices

```rust
let arr = [1, 2, 3, 4, 5];
let slice: &[i32] = &arr[1..3];  // [2, 3]

fn sum_slice(data: &[i32]) -> i32 {
    data.iter().sum()
}

let numbers = vec![1, 2, 3, 4];
println!("{}", sum_slice(&numbers));     // –†–∞–±–æ—Ç–∞–µ—Ç —Å Vec
println!("{}", sum_slice(&arr[..]));     // –†–∞–±–æ—Ç–∞–µ—Ç —Å –º–∞—Å—Å–∏–≤–æ–º
```

---

## üéì –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ—ë –ø–æ–Ω–∏–º–∞–Ω–∏–µ. –ü–æ–ø—Ä–æ–±—É–π –æ—Ç–≤–µ—Ç–∏—Ç—å –±–µ–∑ –ø–æ–¥–≥–ª—è–¥—ã–≤–∞–Ω–∏—è –≤ –º–∞—Ç–µ—Ä–∏–∞–ª:

### –ë–ª–æ–∫ 1: –¢–∏–ø—ã –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `let x = 5;` –∏ `let mut x = 5;`? –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç?**

2. **–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –∏ –ø–æ—á–µ–º—É?**
   ```rust
   let x = 5;
   let x = x + 1;
   let x = x * 2;
   println!("{}", x);
   ```

3. **–ü–æ—á–µ–º—É –≤ ML-–∑–∞–¥–∞—á–∞—Ö –≤—ã–±–æ—Ä –º–µ–∂–¥—É `Vec<f32>` –∏ `Vec<f64>` –∫—Ä–∏—Ç–∏—á–µ–Ω? –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä —Ä–∞—Å—á—ë—Ç–∞ –ø–∞–º—è—Ç–∏ –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∞ –∏–∑ 1–ú —ç–ª–µ–º–µ–Ω—Ç–æ–≤.**

4. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –º–∞—Å—Å–∏–≤–æ–º –∏ –≤–µ–∫—Ç–æ—Ä–æ–º? –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π?**

5. **–ß—Ç–æ –≤–µ—Ä–Ω—ë—Ç —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏ –ø–æ—á–µ–º—É?**
   ```rust
   fn mystery() -> i32 {
       let x = 5;
       x + 1;
   }
   ```

### –ë–ª–æ–∫ 2: Ownership –∏ Move

6. **–û–±—ä—è—Å–Ω–∏, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —ç—Ç–æ–º –∫–æ–¥–µ –∏ –ø–æ—á–µ–º—É –≤—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è:**
   ```rust
   let s1 = String::from("hello");
   let s2 = s1;
   println!("{}", s1);  // Error
   ```

7. **–ó–∞—á–µ–º Rust –∏—Å–ø–æ–ª—å–∑—É–µ—Ç move –≤–º–µ—Å—Ç–æ copy –¥–ª—è —Ç–∏–ø–æ–≤ –≤—Ä–æ–¥–µ String –∏ Vec? –ö–∞–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–∞–µ—Ç—Å—è?**

8. **–ö–∞–∫–∏–µ —Ç–∏–ø—ã –∏–º–µ—é—Ç —Ç—Ä–µ–π—Ç Copy –∏ –ø–æ—á–µ–º—É? –ü–æ—á–µ–º—É String –Ω–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å Copy?**

9. **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å `data` –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏?**
   ```rust
   fn process(data: Vec<i32>) {
       println!("{:?}", data);
   }
   let data = vec![1, 2, 3];
   process(data);
   // –ú–æ–∂–µ–º –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å data –∑–¥–µ—Å—å?
   ```

10. **–ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –µ–≥–æ –ø—Ä–∏–Ω—è–ª–∞ –ø–æ –≤–ª–∞–¥–µ–Ω–∏—é? –ü–æ–∫–∞–∂–∏ –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞.**

### –ë–ª–æ–∫ 3: Borrowing –∏ References

11. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `&T` –∏ `&mut T`? –ú–æ–∂–Ω–æ –ª–∏ –∏–º–µ—Ç—å –æ–±–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ?**

12. **–ü–æ—á–µ–º—É –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Ä–∞–∑—Ä–µ—à–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥?**
    ```rust
    let mut s = String::from("hello");
    let r1 = &s;
    let r2 = &s;
    println!("{} {}", r1, r2);
    let r3 = &mut s;
    println!("{}", r3);
    ```

13. **–ö–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–æ "–æ–¥–Ω–∞ –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è –ò–õ–ò –º–Ω–æ–≥–æ –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫"?**

14. **–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ –∫–∞–∫ –µ–≥–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å?**
    ```rust
    fn get_first() -> &str {
        let s = String::from("hello");
        &s[..]
    }
    ```

15. **–û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `String`, `&String` –∏ `&str`. –ö–∞–∫–æ–π —Ç–∏–ø –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É?**

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –¥–ª—è ML Backend Developer

1. **–ò–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** - —Ñ–∏—á–∞, –Ω–µ –±–∞–≥. –ü–æ–º–æ–≥–∞–µ—Ç –ø–∏—Å–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–¥.

2. **Ownership** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –±–µ–∑ GC.

3. **Move vs Copy** - –¥–æ—Ä–æ–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (String, Vec) –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è, –¥–µ—à—ë–≤—ã–µ (i32, bool) –∫–æ–ø–∏—Ä—É—é—Ç—Å—è.

4. **Borrowing** - –∏—Å–ø–æ–ª—å–∑—É–π –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è. –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ, –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è - —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞.

5. **–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä - —Ç–≤–æ–π –¥—Ä—É–≥** - –≤—Å–µ —ç—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ compile time. –†–∞–Ω—Ç–∞–π–º-–æ—à–∏–±–æ–∫ –Ω–µ –±—É–¥–µ—Ç.

**–î–ª—è ML:**
- –†–∞–±–æ—Ç–∞—è —Å –±–æ–ª—å—à–∏–º–∏ —Ç–µ–Ω–∑–æ—Ä–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É–π –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –ú—É—Ç–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è in-place –æ–ø–µ—Ä–∞—Ü–∏–π (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è)
- Slices –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞—Ç—á–∞–º–∏ –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü—Ä–∞–∫—Ç–∏–∫–∞! –ù–∞–ø–∏—à–∏ –ø—Ä–æ—Å—Ç—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ —ç—Ç–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏.

---

## üéØ –¢–µ–º–∞ 7: –ö–æ–ª–ª–µ–∫—Ü–∏–∏. –°–ª–∞–π—Å—ã, –ú–∞—Å—Å–∏–≤—ã, –°—Ç—Ä–æ–∫–∏

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

–í Rust –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–µ–ª—è—Ç—Å—è –Ω–∞:
- **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ** (–º–∞—Å—Å–∏–≤—ã) - —Ä–∞–∑–º–µ—Ä –∏–∑–≤–µ—Å—Ç–µ–Ω –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ** (Vec, String) - —Ä–∞–∑–º–µ—Ä –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –≤ runtime
- **–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è** (—Å–ª–∞–π—Å—ã) - "–æ–∫–Ω–∞" –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ —Å Python:** –í Python `list` –∏ `str` - —ç—Ç–æ –≤—Å–µ–≥–¥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã –≤ –∫—É—á–µ. –í Rust –º–∞—Å—Å–∏–≤ `[T; N]` –º–æ–∂–µ—Ç –∂–∏—Ç—å –Ω–∞ —Å—Ç–µ–∫–µ, –∞ `Vec<T>` - –≤ –∫—É—á–µ.

---

### üì¶ –ú–∞—Å—Å–∏–≤—ã `[T; N]`

```rust
// –ú–∞—Å—Å–∏–≤ - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –∏–∑–≤–µ—Å—Ç–Ω—ã–π –≤ compile-time
let numbers: [i32; 5] = [1, 2, 3, 4, 5];
let zeros = [0; 100]; // [0, 0, 0, ... 0] - 100 —ç–ª–µ–º–µ–Ω—Ç–æ–≤

// –î–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É
let first = numbers[0]; // 1
let last = numbers[4];  // 5

// –í–ê–ñ–ù–û: –≤—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã = –ø–∞–Ω–∏–∫–∞ –≤ runtime
// let invalid = numbers[10]; // panic!
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –†–∞–∑–º–µ—Ä —Ç–æ—á–Ω–æ –∏–∑–≤–µ—Å—Ç–µ–Ω (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã 3D: `[f32; 3]`)
- –ù—É–∂–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ç–µ–∫–∞
- –†–∞–±–æ—Ç–∞–µ—à—å —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ (—Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞, –±—É—Ñ–µ—Ä–∞)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å ‚Üí `Vec<T>`

---

### üöÄ –í–µ–∫—Ç–æ—Ä—ã `Vec<T>`

```rust
// –°–æ–∑–¥–∞–Ω–∏–µ
let mut v1: Vec<i32> = Vec::new();
let mut v2 = vec![1, 2, 3]; // –º–∞–∫—Ä–æ—Å vec!

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
v1.push(10);
v1.push(20);

// –î–æ—Å—Ç—É–ø
let third = &v2[2];           // –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø (–º–æ–∂–µ—Ç –ø–∞–Ω–∏–∫–æ–≤–∞—Ç—å)
let safe = v2.get(2);         // Option<&i32> - –±–µ–∑–æ–ø–∞—Å–Ω–æ
match safe {
    Some(value) => println!("–ó–Ω–∞—á–µ–Ω–∏–µ: {}", value),
    None => println!("–ò–Ω–¥–µ–∫—Å –∑–∞ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏"),
}

// –ò—Ç–µ—Ä–∞—Ü–∏—è
for item in &v2 {
    println!("{}", item);
}

// –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏
for item in &mut v2 {
    *item += 10; // —Ä–∞–∑—ã–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
}
```

**–í–∞–∂–Ω–∞—è –¥–µ—Ç–∞–ª—å –ø—Ä–æ –≤–ª–∞–¥–µ–Ω–∏–µ:**

```rust
let mut v = vec![1, 2, 3];

let first = &v[0]; // –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ

// v.push(4); // ‚ùå –û–®–ò–ë–ö–ê! –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω—è—Ç—å, –ø–æ–∫–∞ –µ—Å—Ç—å –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
// println!("{}", first);

// –ü–æ—á–µ–º—É? push() –º–æ–∂–µ—Ç —Ä–µ–∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–∞–º—è—Ç—å,
// –∏ —Å—Å—ã–ª–∫–∞ first —Å—Ç–∞–Ω–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π (dangling pointer)
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:**
```
Vec<T> = { 
    ptr: *mut T,      // —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ
    capacity: usize,  // —Å–∫–æ–ª—å–∫–æ –≤—ã–¥–µ–ª–µ–Ω–æ –ø–∞–º—è—Ç–∏
    len: usize        // —Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
}
```

---

### üî™ –°–ª–∞–π—Å—ã `&[T]` –∏ `&mut [T]`

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:** –°–ª–∞–π—Å - —ç—Ç–æ "—Ç–æ–ª—Å—Ç—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å" (fat pointer) = —É–∫–∞–∑–∞—Ç–µ–ª—å + –¥–ª–∏–Ω–∞. –û–Ω –ù–ï –≤–ª–∞–¥–µ–µ—Ç –¥–∞–Ω–Ω—ã–º–∏, —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–∏—Ö.

```rust
let array = [1, 2, 3, 4, 5];
let vec = vec![10, 20, 30, 40];

// –°–ª–∞–π—Å - —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
let slice1: &[i32] = &array[1..4];  // [2, 3, 4]
let slice2: &[i32] = &vec[..2];     // [10, 20]
let slice3: &[i32] = &array[..];    // –≤–µ—Å—å –º–∞—Å—Å–∏–≤

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è —Å–ª–∞–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å Vec, –∏ —Å –º–∞—Å—Å–∏–≤–∞–º–∏!
fn sum(data: &[i32]) -> i32 {
    data.iter().sum()
}

println!("{}", sum(&array));      // —Ä–∞–±–æ—Ç–∞–µ—Ç
println!("{}", sum(&vec));        // —Ç–æ–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
println!("{}", sum(&vec[1..3]));  // –∏ —Ç–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –º–æ—â–Ω–æ:**

1. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å:** –û–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –º–∞—Å—Å–∏–≤–æ–≤, –≤–µ–∫—Ç–æ—Ä–æ–≤, —á–∞—Å—Ç–µ–π –¥–∞–Ω–Ω—ã—Ö
2. **Zero-cost:** –ù–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞—á–∞ —É–∫–∞–∑–∞—Ç–µ–ª—è + –¥–ª–∏–Ω—ã
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** Borrow checker –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å

```rust
let mut numbers = vec![1, 2, 3, 4, 5];

// –ò–∑–º–µ–Ω—è–µ–º—ã–π —Å–ª–∞–π—Å
let slice: &mut [i32] = &mut numbers[1..4];
slice[0] = 100; // numbers[1] —Ç–µ–ø–µ—Ä—å = 100

println!("{:?}", numbers); // [1, 100, 3, 4, 5]
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–∞–π—Å–∞:**
```
&[T] = {
    ptr: *const T,  // —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
    len: usize      // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
}
```

**–î–∏–∞–ø–∞–∑–æ–Ω—ã (ranges):**
```rust
let data = [0, 1, 2, 3, 4, 5];

&data[1..4]   // [1, 2, 3] - –æ—Ç 1 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–æ 4 –Ω–µ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ
&data[..3]    // [0, 1, 2] - —Å –Ω–∞—á–∞–ª–∞ –¥–æ 3
&data[2..]    // [2, 3, 4, 5] - —Å 2 –¥–æ –∫–æ–Ω—Ü–∞
&data[..]     // [0, 1, 2, 3, 4, 5] - –≤–µ—Å—å —Å–ª–∞–π—Å
&data[1..=3]  // [1, 2, 3] - –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
```

---

### üìù –°—Ç—Ä–æ–∫–∏: `String` vs `&str`

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è:** –í Rust —Å—Ç—Ä–æ–∫–∏ - —ç—Ç–æ UTF-8 –±–∞–π—Ç–æ–≤—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ù–ï–¢ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –ø–æ —Å–∏–º–≤–æ–ª–∞–º!

```rust
// String - –≤–ª–∞–¥–µ—é—â–∞—è, –∏–∑–º–µ–Ω—è–µ–º–∞—è, –≤ –∫—É—á–µ
let mut s1 = String::from("–ü—Ä–∏–≤–µ—Ç");
let mut s2 = String::new();

s1.push_str(", –º–∏—Ä!");
s1.push('!');

// &str - –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–π —Å–ª–∞–π—Å —Å—Ç—Ä–æ–∫–∏ (string slice)
let slice: &str = "—ç—Ç–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–π –ª–∏—Ç–µ—Ä–∞–ª";
let part: &str = &s1[0..12]; // "–ü—Ä–∏–≤–µ—Ç"
```

**–ü–æ—á–µ–º—É –Ω–µ—Ç `s[0]`?**

```rust
let hello = String::from("–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π");

// ‚ùå –û–®–ò–ë–ö–ê: –Ω–µ–ª—å–∑—è –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é
// let h = hello[0];

// –ü–æ—Ç–æ–º—É —á—Ç–æ '–ó' –∑–∞–Ω–∏–º–∞–µ—Ç 2 –±–∞–π—Ç–∞ –≤ UTF-8!
// –ò–Ω–¥–µ–∫—Å 0 —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä–≤—ã–π –ë–ê–ô–¢, –Ω–µ —Å–∏–º–≤–æ–ª

// –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã:
// 1. –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ —Å–∏–º–≤–æ–ª–∞–º
for c in hello.chars() {
    println!("{}", c);
}

// 2. –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –±–∞–π—Ç–∞–º
for b in hello.bytes() {
    println!("{}", b);
}

// 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ä–µ–∑–∞ –ø–æ –ë–ê–ô–¢–ê–ú (–æ–ø–∞—Å–Ω–æ!)
let slice = &hello[0..4]; // "–ó–¥" - –µ—Å–ª–∏ —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º –≥—Ä–∞–Ω–∏—Ü—ã UTF-8
```

**String vs &str - –∫–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

| –°–∏—Ç—É–∞—Ü–∏—è | –ò—Å–ø–æ–ª—å–∑—É–π |
|----------|-----------|
| –§—É–Ω–∫—Ü–∏—è —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É | `&str` |
| –ù—É–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å | `String` |
| –í–æ–∑–≤—Ä–∞—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞) | `String` |
| –°—Ç—Ä–æ–∫–æ–≤—ã–π –ª–∏—Ç–µ—Ä–∞–ª –≤ –∫–æ–¥–µ | `&str` (—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±–∏–Ω–∞—Ä–Ω–∏–∫–µ) |
| –ß—Ç–µ–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞/—Å–µ—Ç–∏ | `String` (–¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ) |

```rust
// –•–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞: –ø—Ä–∏–Ω–∏–º–∞—Ç—å &str, –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å String
fn process(input: &str) -> String {
    let mut result = String::new();
    result.push_str(input);
    result.push_str(" processed");
    result
}

// –†–∞–±–æ—Ç–∞–µ—Ç –∏ —Å–æ String, –∏ —Å–æ &str
let s = String::from("data");
process(&s);        // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ String -> &str
process("literal"); // –Ω–∞–ø—Ä—è–º—É—é &str
```

**–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è:**

```rust
let s1 = String::from("Hello");
let s2 = String::from("World");

// –°–ø–æ—Å–æ–± 1: –æ–ø–µ—Ä–∞—Ç–æ—Ä + (s1 –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è!)
let s3 = s1 + " " + &s2; // s1 –±–æ–ª—å—à–µ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

// –°–ø–æ—Å–æ–± 2: format! (–Ω–∏—á–µ–≥–æ –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç)
let s1 = String::from("Hello");
let s4 = format!("{} {}", s1, s2); // s1 –∏ s2 –æ—Å—Ç–∞—é—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º–∏

// –°–ø–æ—Å–æ–± 3: push_str
let mut s5 = String::from("Hello");
s5.push_str(" ");
s5.push_str(&s2);
```

---

### üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º

1. **–ú–∞—Å—Å–∏–≤—ã** - —Å—Ç–µ–∫, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –±—ã—Å—Ç—Ä–æ
2. **Vec** - –∫—É—á–∞, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä, –≥–∏–±–∫–æ
3. **–°–ª–∞–π—Å—ã** - "–æ–∫–Ω–∞" –≤ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è, —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
4. **String** - –≤–ª–∞–¥–µ—é—â–∞—è UTF-8 —Å—Ç—Ä–æ–∫–∞ –≤ –∫—É—á–µ
5. **&str** - –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–π —Å—Ä–µ–∑ —Å—Ç—Ä–æ–∫–∏

**–®–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç —Å–ª–∞–π—Å—ã (`&[T]`, `&str`), –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≤–ª–∞–¥–µ—é—â–∏–µ —Ç–∏–ø—ã (`Vec<T>`, `String`). –≠—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≥–∏–±–∫–æ.

---

## üèóÔ∏è –¢–µ–º–∞ 8: –°—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –ú–µ—Ç–æ–¥—ã. –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

–°—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ Rust - —ç—Ç–æ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Python –∫–ª–∞—Å—Å–æ–≤, –≤ Rust:
- **–î–∞–Ω–Ω—ã–µ** (–ø–æ–ª—è) –∏ **–ø–æ–≤–µ–¥–µ–Ω–∏–µ** (–º–µ—Ç–æ–¥—ã) –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
- –ù–µ—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è (–µ—Å—Ç—å —Ç—Ä–µ–π—Ç—ã - –æ–± —ç—Ç–æ–º –ø–æ–∑–∂–µ)
- –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏ –∏ –≤–∏–¥–∏–º–æ—Å—Ç—å

---

### üì¶ –¢—Ä–∏ –≤–∏–¥–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä

```rust
// 1. –û–±—ã—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (named fields)
struct User {
    username: String,
    email: String,
    age: u32,
    active: bool,
}

// 2. –ö–æ—Ä—Ç–µ–∂–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (tuple struct)
struct Point(i32, i32, i32);
struct Color(u8, u8, u8);

// 3. –ï–¥–∏–Ω–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (unit struct) - –Ω–µ—Ç –ø–æ–ª–µ–π
struct Marker;
```

**–°–æ–∑–¥–∞–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```rust
// –û–±—ã—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
let user1 = User {
    username: String::from("alice"),
    email: String::from("alice@example.com"),
    age: 30,
    active: true,
};

// –î–æ—Å—Ç—É–ø –∫ –ø–æ–ª—è–º
println!("{}", user1.username);

// –ò–∑–º–µ–Ω—è–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–≤—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ mut, –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!)
let mut user2 = User {
    username: String::from("bob"),
    email: String::from("bob@example.com"),
    age: 25,
    active: false,
};

user2.age = 26; // –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å, —Ç.–∫. –≤—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ mut

// –°–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
let username = String::from("charlie");
let email = String::from("charlie@example.com");

let user3 = User {
    username,  // = username: username
    email,     // = email: email
    age: 28,
    active: true,
};

// –°–∏–Ω—Ç–∞–∫—Å–∏—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
let user4 = User {
    email: String::from("new@example.com"),
    ..user3  // –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –∏–∑ user3
    // –í–ù–ò–ú–ê–ù–ò–ï: user3.username –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è! user3 —Ç–µ–ø–µ—Ä—å —á–∞—Å—Ç–∏—á–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
};
```

**–ö–æ—Ä—Ç–µ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**

```rust
let origin = Point(0, 0, 0);
let black = Color(0, 0, 0);

// origin –∏ black - –†–ê–ó–ù–´–ï —Ç–∏–ø—ã, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É!
// let p: Point = black; // ‚ùå –û–®–ò–ë–ö–ê

// –î–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É
let x = origin.0;
let y = origin.1;

// –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è
let Point(x, y, z) = origin;
```

---

### ‚öôÔ∏è –ú–µ—Ç–æ–¥—ã –∏ –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–ª–∏—á–∏–µ:**
- **–ú–µ—Ç–æ–¥—ã** - –ø—Ä–∏–Ω–∏–º–∞—é—Ç `self` (–∏–ª–∏ `&self`, `&mut self`)
- **–ê—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç `self` (–∫–∞–∫ `@staticmethod` –≤ Python)

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    // –ê—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä)
    // –í—ã–∑–æ–≤: Rectangle::new(10, 20)
    fn new(width: u32, height: u32) -> Rectangle {
        Rectangle { width, height }
    }
    
    // –ê—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–≤–∞–¥—Ä–∞—Ç–∞
    fn square(size: u32) -> Rectangle {
        Rectangle {
            width: size,
            height: size,
        }
    }

    // –ú–µ—Ç–æ–¥ (–∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è)
    fn area(&self) -> u32 {
        self.width * self.height
    }

    // –ú–µ—Ç–æ–¥ (–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ)
    fn scale(&mut self, factor: u32) {
        self.width *= factor;
        self.height *= factor;
    }

    // –ú–µ—Ç–æ–¥ (–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ self - –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–ª–∞–¥–µ–Ω–∏—è)
    fn into_square(self) -> Rectangle {
        let size = self.width.max(self.height);
        Rectangle::square(size)
    }

    // –ú–µ—Ç–æ–¥ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    fn can_hold(&self, other: &Rectangle) -> bool {
        self.width > other.width && self.height > other.height
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
let mut rect = Rectangle::new(30, 50);
println!("Area: {}", rect.area());

rect.scale(2); // rect —Ç–µ–ø–µ—Ä—å 60x100

let rect2 = Rectangle::new(20, 40);
println!("Can hold: {}", rect.can_hold(&rect2));

// into_square() –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç rect
let square = rect.into_square();
// rect –±–æ–ª—å—à–µ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!
```

**–ü–∞—Ç—Ç–µ—Ä–Ω `&self` vs `&mut self` vs `self`:**

| –°–∏–≥–Ω–∞—Ç—É—Ä–∞ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ü—Ä–∏–º–µ—Ä |
|-----------|-------------------|--------|
| `&self` | –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ, –Ω–µ –∏–∑–º–µ–Ω—è–µ–º | `area()`, `can_hold()` |
| `&mut self` | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π | `scale()`, `update()` |
| `self` | –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ/—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è | `into_square()`, `into_iter()` |

```rust
impl Rectangle {
    // –ì–µ—Ç—Ç–µ—Ä—ã (—á–∞—Å—Ç–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞)
    fn width(&self) -> u32 {
        self.width
    }
    
    // –ú–æ–∂–Ω–æ –∏–º–µ—Ç—å –º–µ—Ç–æ–¥ –∏ –ø–æ–ª–µ —Å –æ–¥–Ω–∏–º –∏–º–µ–Ω–µ–º!
    // rect.width - –ø–æ–ª–µ
    // rect.width() - –º–µ—Ç–æ–¥
}
```

---

### üîí –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏

–í Rust –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ **–º–æ–¥—É–ª–µ–π**, –∞ –Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä.

```rust
mod user_system {
    pub struct User {
        pub username: String,  // –ø—É–±–ª–∏—á–Ω–æ–µ –ø–æ–ª–µ
        email: String,         // –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –ø–æ–ª–µ
        age: u32,              // –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –ø–æ–ª–µ
    }

    impl User {
        // –ü—É–±–ª–∏—á–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
        pub fn new(username: String, email: String, age: u32) -> User {
            User { username, email, age }
        }

        // –ü—É–±–ª–∏—á–Ω—ã–π –≥–µ—Ç—Ç–µ—Ä –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –ø–æ–ª—è
        pub fn email(&self) -> &str {
            &self.email
        }

        // –ü—É–±–ª–∏—á–Ω—ã–π —Å–µ—Ç—Ç–µ—Ä —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
        pub fn set_email(&mut self, email: String) -> Result<(), String> {
            if email.contains('@') {
                self.email = email;
                Ok(())
            } else {
                Err(String::from("Invalid email"))
            }
        }

        // –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥ (–¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è)
        fn validate(&self) -> bool {
            self.age >= 18
        }
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–Ω–µ –º–æ–¥—É–ª—è
use user_system::User;

let mut user = User::new(
    String::from("alice"),
    String::from("alice@example.com"),
    25
);

println!("{}", user.username);     // OK - –ø–æ–ª–µ –ø—É–±–ª–∏—á–Ω–æ–µ
// println!("{}", user.email);     // ‚ùå –û–®–ò–ë–ö–ê - –ø–æ–ª–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ
println!("{}", user.email());      // OK - —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥

user.set_email(String::from("newemail@example.com")).unwrap();
```

**–ü—Ä–∞–≤–∏–ª–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
- –í—Å—ë **–ø—Ä–∏–≤–∞—Ç–Ω–æ–µ** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–ø–æ–ª—è, –º–µ—Ç–æ–¥—ã, –º–æ–¥—É–ª–∏)
- `pub` –¥–µ–ª–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –ø—É–±–ª–∏—á–Ω—ã–º
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è –∏ –≤—Å–µ—Ö –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π

```rust
pub struct Config {
    pub api_key: String,
    secret: String,  // –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ - –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–Ω–µ –º–æ–¥—É–ª—è!
}

impl Config {
    // –ë–µ–∑ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
    // –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –≤–Ω–µ –º–æ–¥—É–ª—è
    pub fn new(api_key: String, secret: String) -> Config {
        Config { api_key, secret }
    }
}
```

---

### üéØ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏ impl

–ú–æ–∂–Ω–æ —Ä–∞–∑–±–∏–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–ª–æ–∫–æ–≤:

```rust
struct Point {
    x: f64,
    y: f64,
}

// –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã
impl Point {
    fn distance(&self, other: &Point) -> f64 {
        let dx = self.x - other.x;
        let dy = self.y - other.y;
        (dx * dx + dy * dy).sqrt()
    }
}

// –ú–µ—Ç–æ–¥—ã —Å–æ–∑–¥–∞–Ω–∏—è
impl Point {
    fn new(x: f64, y: f64) -> Point {
        Point { x, y }
    }
    
    fn origin() -> Point {
        Point { x: 0.0, y: 0.0 }
    }
}

// –≠—Ç–æ —á–∏—Å—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–µ - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –æ–±—ä–µ–¥–∏–Ω–∏—Ç –≤—Å—ë
```

---

### üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º

1. **–°—Ç—Ä—É–∫—Ç—É—Ä—ã** - –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (–¥–∞–Ω–Ω—ã–µ + –º–µ—Ç–æ–¥—ã)
2. **impl –±–ª–æ–∫–∏** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –¥–∞–Ω–Ω—ã—Ö
3. **&self** –¥–ª—è —á—Ç–µ–Ω–∏—è, **&mut self** –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è, **self** –¥–ª—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
4. **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è** —á–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏ –∏ `pub`, –Ω–µ —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
5. **–ê—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã –∏ —É—Ç–∏–ª–∏—Ç—ã –±–µ–∑ `self`

---

## üé≠ –¢–µ–º–∞ 9: –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –∏ Pattern Matching

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

**Enum** –≤ Rust - —ç—Ç–æ –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö (ADT). –≠—Ç–æ –ù–ï –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–æ—Ä –∫–æ–Ω—Å—Ç–∞–Ω—Ç (–∫–∞–∫ –≤ Python/C), –∞ —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–∞–∂–¥–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ.

**Pattern matching** - —ç—Ç–æ —Å–ø–æ—Å–æ–± —Ä–∞–∑–æ–±—Ä–∞—Ç—å enum –∏ –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ. –≠—Ç–æ –º–æ—â–Ω–µ–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ —á–µ–º `if/else` —Ü–µ–ø–æ—á–∫–∏.

---

### üé® –ë–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è

```rust
// –ü—Ä–æ—Å—Ç–æ–π enum (–∫–∞–∫ –≤ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö)
enum Direction {
    North,
    South,
    East,
    West,
}

let dir = Direction::North;

// Enum —Å –¥–∞–Ω–Ω—ã–º–∏ (–≤–æ—Ç —Ç—É—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –º–∞–≥–∏—è!)
enum IpAddr {
    V4(u8, u8, u8, u8),       // —Ö—Ä–∞–Ω–∏—Ç 4 —á–∏—Å–ª–∞
    V6(String),                // —Ö—Ä–∞–Ω–∏—Ç —Å—Ç—Ä–æ–∫—É
}

let home = IpAddr::V4(127, 0, 0, 1);
let loopback = IpAddr::V6(String::from("::1"));

// –ö–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã!
enum Message {
    Quit,                       // –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
    Move { x: i32, y: i32 },   // –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
    Write(String),              // –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ
    ChangeColor(i32, i32, i32), // —Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è
}

let msg1 = Message::Quit;
let msg2 = Message::Move { x: 10, y: 20 };
let msg3 = Message::Write(String::from("Hello"));
let msg4 = Message::ChangeColor(255, 0, 0);
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è:** Enum - —ç—Ç–æ "–æ–¥–Ω–æ –ò–ó", –∞ –Ω–µ "–≤—Å—ë —Å—Ä–∞–∑—É". –í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–µ—Ç –û–î–ò–ù –≤–∞—Ä–∏–∞–Ω—Ç.

```rust
// –≠—Ç–æ –∫–∞–∫ size-of —Å–∞–º–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ + —Ç–µ–≥
// sizeof(Message) = max(—Ä–∞–∑–º–µ—Ä—ã –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤) + sizeof(tag)
```

---

### üéØ Pattern Matching —Å `match`

`match` - —ç—Ç–æ **–∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∞—è** –ø—Ä–æ–≤–µ—Ä–∫–∞. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∑–∞—Å—Ç–∞–≤–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –í–°–ï –≤–∞—Ä–∏–∞–Ω—Ç—ã.

```rust
enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter,
}

fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
        // –ï—Å–ª–∏ –∑–∞–±—ã—Ç—å —Ö–æ—Ç—å –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç - –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!
    }
}

// match —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
let coin = Coin::Dime;
let cents = match coin {
    Coin::Penny => 1,
    Coin::Nickel => 5,
    Coin::Dime => 10,
    Coin::Quarter => 25,
}; // cents = 10
```

**–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ enum:**

```rust
enum IpAddr {
    V4(u8, u8, u8, u8),
    V6(String),
}

fn process_ip(ip: IpAddr) {
    match ip {
        // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –∫–æ—Ä—Ç–µ–∂–∞
        IpAddr::V4(a, b, c, d) => {
            println!("IPv4: {}.{}.{}.{}", a, b, c, d);
        }
        // –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
        IpAddr::V6(addr) => {
            println!("IPv6: {}", addr);
        }
    }
}

process_ip(IpAddr::V4(192, 168, 1, 1));
process_ip(IpAddr::V6(String::from("::1")));
```

**–°–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

fn process_message(msg: Message) {
    match msg {
        Message::Quit => {
            println!("Quit message");
        }
        // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
        Message::Move { x, y } => {
            println!("Move to ({}, {})", x, y);
        }
        // –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∏ —É—Å–ª–æ–≤–∏–µ (guard)
        Message::Write(text) if text.len() > 10 => {
            println!("Long message: {}", text);
        }
        Message::Write(text) => {
            println!("Short message: {}", text);
        }
        // –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
        Message::ChangeColor(r, _, _) => {
            println!("Red component: {}", r);
        }
    }
}
```

**–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω `_`:**

```rust
let number = 7;

match number {
    1 => println!("One"),
    2 => println!("Two"),
    3 => println!("Three"),
    _ => println!("Something else"), // "catch-all"
}

// –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
match some_value {
    Some(_) => println!("Got some value"),
    None => println!("Got nothing"),
}
```

---

### üíé Option<T> - —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π enum

`Option<T>` –≤—Å—Ç—Ä–æ–µ–Ω –≤ —è–∑—ã–∫ –∏ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ë–ï–ó null pointer.

```rust
// –û–ø—Ä–µ–¥–µ–ª—ë–Ω –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –∫–∞–∫:
enum Option<T> {
    Some(T),
    None,
}

// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ
let some_number: Option<i32> = Some(5);
let no_number: Option<i32> = None;

// Option –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ prelude - –Ω–µ –Ω—É–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
let x: Option<i32> = Some(5);
let y: Option<i32> = None;
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≥–µ–Ω–∏–∞–ª—å–Ω–æ:**

```rust
let x: i8 = 5;
let y: Option<i8> = Some(5);

// let sum = x + y; // ‚ùå –û–®–ò–ë–ö–ê! –ù–µ–ª—å–∑—è —Å–ª–æ–∂–∏—Ç—å i8 –∏ Option<i8>

// –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ó–ê–°–¢–ê–í–õ–Ø–ï–¢ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–ª—É—á–∞–π None
let sum = match y {
    Some(value) => x + value,
    None => x, // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
};
```

**–†–∞–±–æ—Ç–∞ —Å Option:**

```rust
fn divide(a: i32, b: i32) -> Option<i32> {
    if b == 0 {
        None
    } else {
        Some(a / b)
    }
}

let result = divide(10, 2);

match result {
    Some(value) => println!("Result: {}", value),
    None => println!("Cannot divide by zero"),
}

// –ú–µ—Ç–æ–¥—ã Option (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –º–Ω–æ–≥–∏—Ö)
let x: Option<i32> = Some(5);

x.is_some();           // true
x.is_none();           // false
x.unwrap();            // 5 (–ø–∞–Ω–∏–∫—É–µ—Ç –µ—Å–ª–∏ None!)
x.unwrap_or(0);        // 5, –µ—Å–ª–∏ Some; 0 –µ—Å–ª–∏ None
x.unwrap_or_else(|| 42); // 5, –µ—Å–ª–∏ Some; –≤—ã–∑–æ–≤ –∑–∞–º—ã–∫–∞–Ω–∏—è –µ—Å–ª–∏ None

// –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
x.map(|v| v * 2);      // Some(10)
x.and_then(|v| Some(v * 2)); // Some(10)
x.filter(|v| *v > 3);  // Some(5)

// –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
let y: Option<i32> = None;
y.unwrap_or(10);       // 10
```

---

### ‚ö° Result<T, E> - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

`Result<T, E>` - –≤—Ç–æ—Ä–æ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π enum –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –æ—à–∏–±–∫–æ–π.

```rust
enum Result<T, E> {
    Ok(T),   // —É—Å–ø–µ—Ö —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ç–∏–ø–∞ T
    Err(E),  // –æ—à–∏–±–∫–∞ —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ç–∏–ø–∞ E
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
use std::fs::File;
use std::io::ErrorKind;

fn open_file() -> Result<File, std::io::Error> {
    File::open("hello.txt")
}

let f = open_file();

match f {
    Ok(file) => {
        println!("File opened successfully");
    }
    Err(error) => {
        println!("Failed to open file: {}", error);
    }
}
```

**–í–ª–æ–∂–µ–Ω–Ω—ã–µ match –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:**

```rust
let f = File::open("hello.txt");

let f = match f {
    Ok(file) => file,
    Err(error) => match error.kind() {
        ErrorKind::NotFound => {
            println!("File not found, creating...");
            match File::create("hello.txt") {
                Ok(fc) => fc,
                Err(e) => panic!("Can't create file: {:?}", e),
            }
        }
        other_error => {
            panic!("Error opening file: {:?}", other_error);
        }
    }
};
```

**–°–æ–∫—Ä–∞—â–µ–Ω–∏—è –¥–ª—è Result:**

```rust
let f = File::open("hello.txt").unwrap(); // –ø–∞–Ω–∏–∫—É–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ

let f = File::open("hello.txt")
    .expect("Failed to open file"); // –ø–∞–Ω–∏–∫—É–µ—Ç —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º

// ? –æ–ø–µ—Ä–∞—Ç–æ—Ä - —Ä–∞–Ω–Ω–µ–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
fn read_username() -> Result<String, io::Error> {
    let mut f = File::open("username.txt")?; // –µ—Å–ª–∏ Err - –≤–æ–∑–≤—Ä–∞—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
    let mut s = String::new();
    f.read_to_string(&mut s)?; // –µ—Å–ª–∏ Err - –≤–æ–∑–≤—Ä–∞—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
    Ok(s)
}

// ? –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö Result –∏–ª–∏ Option
```

---

### üîç if let –∏ while let - —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π matching

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –¢–û–õ–¨–ö–û –æ–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω:

```rust
let some_value: Option<i32> = Some(3);

// –í–º–µ—Å—Ç–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ–≥–æ match:
match some_value {
    Some(3) => println!("three"),
    _ => (), // –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω–æ–µ
}

// –ò—Å–ø–æ–ª—å–∑—É–µ–º if let:
if let Some(3) = some_value {
    println!("three");
}

// –° else:
if let Some(value) = some_value {
    println!("Value: {}", value);
} else {
    println!("No value");
}
```

**while let –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏:**

```rust
let mut stack = vec![1, 2, 3];

while let Some(top) = stack.pop() {
    println!("{}", top);
}
// –í—ã–≤–µ–¥–µ—Ç: 3, 2, 1
```

---

### üõ†Ô∏è –ú–µ—Ç–æ–¥—ã –¥–ª—è Enum

Enum –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –º–µ—Ç–æ–¥—ã —Ç–∞–∫ –∂–µ –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
}

impl Message {
    fn call(&self) {
        match self {
            Message::Quit => println!("Quitting"),
            Message::Move { x, y } => println!("Moving to ({}, {})", x, y),
            Message::Write(text) => println!("Writing: {}", text),
        }
    }

    fn is_quit(&self) -> bool {
        matches!(self, Message::Quit)
    }
}

let msg = Message::Write(String::from("Hello"));
msg.call(); // "Writing: Hello"
```

---

### üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ Enum –∏ Pattern Matching

1. **Enum** - –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
2. **match** - –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤
3. **Option<T>** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ null
4. **Result<T, E>** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
5. **if let / while let** - —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞
6. **? –æ–ø–µ—Ä–∞—Ç–æ—Ä** - –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤–≤–µ—Ä—Ö

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ó–ê–°–¢–ê–í–õ–Ø–ï–¢ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ —Å–ª—É—á–∞–∏. –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–±—ã—Ç—å –ø—Ä–æ –æ—à–∏–±–∫—É –∏–ª–∏ None.

---

## üéØ –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å (1-3)

1. **–í —á—ë–º –≥–ª–∞–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –º–µ–∂–¥—É `Vec<T>` –∏ `[T; N]`?** –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö?

2. **–ü–æ—á–µ–º—É –≤ Rust –Ω–µ–ª—å–∑—è –Ω–∞–ø—Ä—è–º—É—é –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É `s[0]`?** –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π —Å–∏–º–≤–æ–ª?

3. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `&self`, `&mut self` –∏ `self` –≤ –º–µ—Ç–æ–¥–∞—Ö?** –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ.

### –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (4-7)

4. **–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–∞–π—Å —á–∏—Å–µ–ª –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Option —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º.** –ü–æ—á–µ–º—É –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å Option, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ?

5. **–û–±—ä—è—Å–Ω–∏, —á—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç —Å —ç—Ç–∏–º –∫–æ–¥–æ–º –∏ –ø–æ—á–µ–º—É:**
   ```rust
   let mut v = vec![1, 2, 3];
   let first = &v[0];
   v.push(4);
   println!("{}", first);
   ```

6. **–°–æ–∑–¥–∞–π enum `Shape` —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ `Circle(f64)`, `Rectangle(f64, f64)`, `Triangle(f64, f64, f64)`.** –ù–∞–ø–∏—à–∏ –º–µ—Ç–æ–¥ `area()` –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø–ª–æ—â–∞–¥–∏.

7. **–ß–µ–º `if let Some(x) = value` –ª—É—á—à–µ —á–µ–º `match value { Some(x) => ..., None => () }`?** –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç?

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å (8-10)

8. **–†–∞–∑—Ä–∞–±–æ—Ç–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É `Stack<T>` —Å –º–µ—Ç–æ–¥–∞–º–∏ `push`, `pop`, –∏ `peek`.** `pop` –∏ `peek` –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `Option<T>`. –û–±—ä—è—Å–Ω–∏ –≤—ã–±–æ—Ä —Å–∏–≥–Ω–∞—Ç—É—Ä –º–µ—Ç–æ–¥–æ–≤.

9. **–û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è –ø–æ–¥—Ö–æ–¥–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:**
   ```rust
   // –í–∞—Ä–∏–∞–Ω—Ç 1
   let file = File::open("file.txt").unwrap();
   
   // –í–∞—Ä–∏–∞–Ω—Ç 2
   let file = match File::open("file.txt") {
       Ok(f) => f,
       Err(e) => return Err(e),
   };
   
   // –í–∞—Ä–∏–∞–Ω—Ç 3
   let file = File::open("file.txt")?;
   ```
   –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π?

10. **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è HTTP –∑–∞–ø—Ä–æ—Å–∞:** –ò—Å–ø–æ–ª—å–∑—É–π enum –¥–ª—è –º–µ—Ç–æ–¥–æ–≤ (GET, POST, PUT, DELETE), struct –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ (–º–µ—Ç–æ–¥, –ø—É—Ç—å, –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Ç–µ–ª–æ). –†–µ–∞–ª–∏–∑—É–π –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è GET –∑–∞–ø—Ä–æ—Å–∞ –∏ –º–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–ø—Ä–æ—Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º (GET –∏–ª–∏ HEAD).

---

## üéì –§–∏–Ω–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏

–≠—Ç–∏ —Ç—Ä–∏ —Ç–µ–º—ã - **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç Rust**:

- **–ö–æ–ª–ª–µ–∫—Ü–∏–∏** - –∫–∞–∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ (–≤–ª–∞–¥–µ–Ω–∏–µ vs –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ)
- **–°—Ç—Ä—É–∫—Ç—É—Ä—ã** - –∫–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –∫–æ–¥ (–¥–∞–Ω–Ω—ã–µ + –ø–æ–≤–µ–¥–µ–Ω–∏–µ)
- **Enum + Pattern Matching** - –∫–∞–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã (–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä = –∑–∞—â–∏—Ç–Ω–∞—è —Å–µ—Ç–∫–∞)

–ö–ª—é—á–µ–≤–∞—è —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è Rust: **–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø–æ–º–æ–≥–∞–µ—Ç –ø–∏—Å–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ–¥**. –ï—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –¥–æ–≤–æ–ª–µ–Ω - –∫–æ–¥ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.

---

## üéØ –¢–µ–º–∞ 10: –í–≤–µ–¥–µ–Ω–∏–µ –≤ –°–∏—Å—Ç–µ–º—É –¢–∏–ø–æ–≤. Result, Option, ()

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

–°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤ Rust - —ç—Ç–æ **–∫–æ–Ω—Ç—Ä–∞–∫—Ç –º–µ–∂–¥—É —Ç–æ–±–æ–π –∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º**. –¢–∏–ø—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ–ø–∏—Å—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ, –æ–Ω–∏ **–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å** –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Python:**
```python
# Python - —É—Ç–∏–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ runtime
def divide(a, b):
    return a / b  # —É–ø–∞–¥—ë—Ç –≤ runtime –ø—Ä–∏ b=0

result = divide(10, 0)  # ZeroDivisionError
```

```rust
// Rust - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫–∏
fn divide(a: i32, b: i32) -> Option<i32> {
    if b == 0 {
        None
    } else {
        Some(a / b)
    }
}

// –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ù–ï –ø–æ–∑–≤–æ–ª–∏—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å None!
```

---

### üß© –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã

```rust
// –¶–µ–ª—ã–µ —á–∏—Å–ª–∞ (signed)
let a: i8 = -128;      // –æ—Ç -128 –¥–æ 127
let b: i16 = -32768;   // –æ—Ç -32,768 –¥–æ 32,767
let c: i32 = 42;       // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ü–µ–ª—ã—Ö
let d: i64 = 1000;
let e: i128 = 1_000_000;

// –¶–µ–ª—ã–µ —á–∏—Å–ª–∞ (unsigned)
let f: u8 = 255;       // –æ—Ç 0 –¥–æ 255
let g: u16 = 65535;
let h: u32 = 4_294_967_295;
let i: u64 = 18_446_744_073_709_551_615;

// –î–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: 32bit –∏–ª–∏ 64bit)
let j: usize = 100;    // –∏–Ω–¥–µ–∫—Å—ã, —Ä–∞–∑–º–µ—Ä—ã –∫–æ–ª–ª–µ–∫—Ü–∏–π
let k: isize = -50;

// –ß–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
let pi: f32 = 3.14;
let e: f64 = 2.71828;  // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è float

// –ë—É–ª–µ–≤—ã
let is_active: bool = true;
let is_valid: bool = false;

// –°–∏–º–≤–æ–ª—ã (Unicode scalar value, 4 –±–∞–π—Ç–∞!)
let c: char = 'z';
let emoji: char = 'üòé';
let cyrillic: char = '–Ø';
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** Rust –ù–ï –¥–µ–ª–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤!

```rust
let x: i32 = 5;
let y: i64 = 10;

// let sum = x + y; // ‚ùå –û–®–ò–ë–ö–ê! –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã
let sum = x as i64 + y; // ‚úÖ –Ø–≤–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ

// –î–∞–∂–µ —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
let a: f32 = 3.0;
let b: f64 = 4.0;
// let c = a + b; // ‚ùå –û–®–ò–ë–ö–ê!
let c = a as f64 + b; // ‚úÖ
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ö–æ—Ä–æ—à–æ?** –ù–∏–∫–∞–∫–∏—Ö —Å—é—Ä–ø—Ä–∏–∑–æ–≤. –ï—Å–ª–∏ –∫–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è - –æ–Ω –¥–µ–ª–∞–µ—Ç –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ —Ç—ã –Ω–∞–ø–∏—Å–∞–ª.

---

### üíé Unit Type: ()

`()` - —ç—Ç–æ **–µ–¥–∏–Ω–∏—á–Ω—ã–π —Ç–∏–ø** (unit type). –£ –Ω–µ–≥–æ —Ä–æ–≤–Ω–æ –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ: `()`.

**–ó–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω?**

```rust
// –§—É–Ω–∫—Ü–∏—è –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
fn print_message(msg: &str) {
    println!("{}", msg);
    // –Ω–µ—è–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ()
}

// –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ:
fn print_message_explicit(msg: &str) -> () {
    println!("{}", msg);
    ()
}

// () –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ, –≥–¥–µ "–Ω–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è"
let result: () = {
    let x = 5;
    let y = 10;
    // –±–ª–æ–∫ –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
};

// –ü—É—Å—Ç–æ–π –∫–æ—Ä—Ç–µ–∂
let empty: () = ();
```

**–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Result/Option:**

```rust
// Result<(), Error> - –æ–ø–µ—Ä–∞—Ü–∏—è –ª–∏–±–æ —É—Å–ø–µ—à–Ω–∞ (–±–µ–∑ –¥–∞–Ω–Ω—ã—Ö), –ª–∏–±–æ –æ—à–∏–±–∫–∞
fn write_file(path: &str, content: &str) -> Result<(), std::io::Error> {
    std::fs::write(path, content)?;
    Ok(()) // —É—Å–ø–µ—Ö, –Ω–æ –Ω–µ—Ç –ø–æ–ª–µ–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
}

// Option<()> - –ª–∏–±–æ "—á—Ç–æ-—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ", –ª–∏–±–æ –Ω–µ—Ç
fn check_cache() -> Option<()> {
    if cache_is_valid() {
        Some(()) // –¥–∞, –∫—ç—à –≤–∞–ª–∏–¥–µ–Ω
    } else {
        None
    }
}
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä:**

```rust
use std::collections::HashMap;

let mut map: HashMap<String, ()> = HashMap::new();
map.insert("visited".to_string(), ());
map.insert("seen".to_string(), ());

// –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ Set! –ó–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –≤–∞–∂–Ω–æ, –≤–∞–∂–Ω–æ –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞
if map.contains_key("visited") {
    println!("Already visited");
}
```

---

### üéÅ Option<T> - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ó–Ω–∞—á–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞ –≤ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö:**
```python
# Python
def find_user(id):
    if id in users:
        return users[id]
    return None  # –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None

user = find_user(123)
print(user.name)  # üí• AttributeError –µ—Å–ª–∏ None!
```

**–†–µ—à–µ–Ω–∏–µ Rust:**
```rust
fn find_user(id: u32) -> Option<User> {
    if let Some(user) = users.get(&id) {
        Some(user.clone())
    } else {
        None
    }
}

// –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ó–ê–°–¢–ê–í–ò–¢ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å None
let user = find_user(123);
match user {
    Some(u) => println!("Name: {}", u.name),
    None => println!("User not found"),
}
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Option:**

```rust
// –£–ø—Ä–æ—â—ë–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
pub enum Option<T> {
    None,
    Some(T),
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
let some_number: Option<i32> = Some(5);
let no_number: Option<i32> = None;

// Option –∑–∞–Ω–∏–º–∞–µ—Ç –ø–∞–º—è—Ç—å –∫–∞–∫ T + –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç (–æ–±—ã—á–Ω–æ 1 –±–∞–π—Ç)
// –ù–æ –¥–ª—è Option<&T> –∏ Option<Box<T>> –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
// None –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∫–∞–∫ null pointer - —Ä–∞–∑–º–µ—Ä = sizeof(T)!
```

**–ú–µ—Ç–æ–¥—ã Option - —Ç–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π:**

```rust
let x: Option<i32> = Some(5);
let y: Option<i32> = None;

// –ü—Ä–æ–≤–µ—Ä–∫–∞
x.is_some();  // true
x.is_none();  // false
y.is_some();  // false
y.is_none();  // true

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (–û–ü–ê–°–ù–û - –º–æ–∂–µ—Ç –ø–∞–Ω–∏–∫–æ–≤–∞—Ç—å!)
x.unwrap();              // 5
// y.unwrap();           // üí• –ü–ê–ù–ò–ö–ê!

// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
x.unwrap_or(0);          // 5
y.unwrap_or(0);          // 0

x.unwrap_or_else(|| {
    // –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ None
    expensive_computation()
});

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ
if let Some(value) = x {
    println!("Got: {}", value);
}

// –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å)
let doubled = x.map(|v| v * 2);  // Some(10)
let doubled_none = y.map(|v| v * 2); // None

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
let big = x.filter(|v| *v > 3);  // Some(5)
let small = x.filter(|v| *v > 10); // None

// –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã
x.and(Some(10));     // Some(10) –µ—Å–ª–∏ x = Some, –∏–Ω–∞—á–µ None
x.or(Some(10));      // Some(5) –µ—Å–ª–∏ x = Some, –∏–Ω–∞—á–µ Some(10)

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Option<Option<T>> -> Option<T>
let nested: Option<Option<i32>> = Some(Some(5));
nested.flatten();    // Some(5)
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω - –º–µ—Ç–æ–¥ —Ü–µ–ø–æ—á–µ–∫:**

```rust
fn get_user_email(user_id: u32) -> Option<String> {
    find_user(user_id)
        .map(|user| user.profile)    // Option<Profile>
        .and_then(|profile| profile.email) // Option<String>
        .filter(|email| email.contains('@'))
}

// –ï—Å–ª–∏ —Ö–æ—Ç—å –æ–¥–∏–Ω —à–∞–≥ –≤–µ—Ä–Ω—ë—Ç None - –≤—Å—è —Ü–µ–ø–æ—á–∫–∞ –≤–µ—Ä–Ω—ë—Ç None
```

---

### ‚ö° Result<T, E> - –û–±—Ä–∞–±–æ—Ç–∫–∞ –û—à–∏–±–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞ –≤ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö:**
```python
# Python - –∏—Å–∫–ª—é—á–µ–Ω–∏—è "–Ω–µ–≤–∏–¥–∏–º—ã" –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ
def read_config(path: str) -> dict:
    with open(path) as f:  # –º–æ–∂–µ—Ç –±—Ä–æ—Å–∏—Ç—å FileNotFoundError
        return json.load(f)  # –º–æ–∂–µ—Ç –±—Ä–æ—Å–∏—Ç—å JSONDecodeError
    # –í—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥ –Ω–µ –∑–Ω–∞–µ—Ç –æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö!
```

**–†–µ—à–µ–Ω–∏–µ Rust:**
```rust
use std::fs;
use std::io;

// –û—à–∏–±–∫–∞ —è–≤–Ω–æ –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ!
fn read_config(path: &str) -> Result<String, io::Error> {
    fs::read_to_string(path) // Result<String, io::Error>
}

// –í—ã–∑—ã–≤–∞—é—â–∏–π –û–ë–Ø–ó–ê–ù –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É
match read_config("config.json") {
    Ok(content) => println!("Config: {}", content),
    Err(e) => eprintln!("Error: {}", e),
}
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Result:**

```rust
// –£–ø—Ä–æ—â—ë–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ std
pub enum Result<T, E> {
    Ok(T),   // —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    Err(E),  // –æ—à–∏–±–∫–∞
}

// –ü—Ä–∏–º–µ—Ä—ã —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
type IoResult<T> = Result<T, io::Error>;
type ParseResult<T> = Result<T, ParseError>;

// –ö–∞—Å—Ç–æ–º–Ω–∞—è –æ—à–∏–±–∫–∞
#[derive(Debug)]
enum MyError {
    NotFound,
    PermissionDenied,
    InvalidFormat(String),
}

fn process() -> Result<Data, MyError> {
    if !exists() {
        return Err(MyError::NotFound);
    }
    Ok(data)
}
```

**–ú–µ—Ç–æ–¥—ã Result:**

```rust
let ok: Result<i32, &str> = Ok(5);
let err: Result<i32, &str> = Err("error");

// –ü—Ä–æ–≤–µ—Ä–∫–∞
ok.is_ok();   // true
ok.is_err();  // false
err.is_ok();  // false
err.is_err(); // true

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (–û–ü–ê–°–ù–û!)
ok.unwrap();              // 5
// err.unwrap();          // üí• –ü–ê–ù–ò–ö–ê —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ—à–∏–±–∫–∏

ok.unwrap_or(0);          // 5
err.unwrap_or(0);         // 0

ok.expect("Should be ok"); // 5
// err.expect("Custom msg"); // üí• –ü–ê–ù–ò–ö–ê —Å "Custom msg"

// –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
ok.map(|v| v * 2);        // Ok(10)
err.map(|v| v * 2);       // Err("error") - –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

// –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—à–∏–±–∫–∏
err.map_err(|e| format!("Error: {}", e));
// Err("Error: error")

// –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã
ok.and(Ok(10));           // Ok(10)
err.and(Ok(10));          // Err("error")

ok.or(Ok(10));            // Ok(5)
err.or(Ok(10));           // Ok(10)

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Result -> Option
ok.ok();                  // Some(5)
err.ok();                 // None

ok.err();                 // None
err.err();                // Some("error")
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω - —Ü–µ–ø–æ—á–∫–∏ Result:**

```rust
fn load_and_parse() -> Result<Config, Box<dyn std::error::Error>> {
    let content = fs::read_to_string("config.json")?; // Result<String, io::Error>
    let config: Config = serde_json::from_str(&content)?; // Result<Config, serde_json::Error>
    Ok(config)
}

// ? –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫ –≤ Box<dyn Error>
```

---

### üîÑ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ Option –∏ Result

```rust
// Option -> Result
let opt: Option<i32> = Some(5);
let res: Result<i32, &str> = opt.ok_or("value not found");

// Result -> Option
let res: Result<i32, &str> = Ok(5);
let opt: Option<i32> = res.ok();

// –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä
fn get_config_value(key: &str) -> Result<String, String> {
    let config = load_config()?; // Result
    config
        .get(key)                // Option
        .cloned()
        .ok_or_else(|| format!("Key '{}' not found", key)) // Option -> Result
}
```

**–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**

```rust
// Option<Result<T, E>> -> Result<Option<T>, E>
let opt_res: Option<Result<i32, &str>> = Some(Ok(5));
let res_opt: Result<Option<i32>, &str> = opt_res.transpose();

// –ó–∞—á–µ–º? –ö–æ–≥–¥–∞ —Ö–æ—á–µ—à—å "–≤—ã—Ç–∞—â–∏—Ç—å" –æ—à–∏–±–∫—É –Ω–∞—Ä—É–∂—É
fn process_batch(items: Vec<Option<String>>) -> Result<Vec<String>, Error> {
    items
        .into_iter()
        .map(|opt| {
            opt.map(|s| parse(&s)) // Option<Result<T, E>>
               .transpose()         // Result<Option<T>, E>
        })
        .collect() // Result —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –æ—à–∏–±–∫–∏
}
```

---

### üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è —Å–∏—Å—Ç–µ–º—ã —Ç–∏–ø–æ–≤ Rust

**"Parse, don't validate" (–ê–ª–µ–∫—Å–∏—Å –ö–∏–Ω–≥)**

‚ùå **–ü–ª–æ—Ö–æ (validate):**
```rust
fn process_age(age: i32) {
    assert!(age >= 0 && age <= 150);
    // ... –∏—Å–ø–æ–ª—å–∑—É–µ–º age
}
// –ü—Ä–æ–±–ª–µ–º–∞: –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
```

‚úÖ **–•–æ—Ä–æ—à–æ (parse):**
```rust
struct Age(u8); // –Ω–æ–≤—ã–π —Ç–∏–ø, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å

impl Age {
    fn new(value: u8) -> Option<Self> {
        if value <= 150 {
            Some(Age(value))
        } else {
            None
        }
    }
}

fn process_age(age: Age) {
    // age –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤–∞–ª–∏–¥–µ–Ω!
}

// –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π Age –Ω–∞–ø—Ä—è–º—É—é
```

**–¢–∏–ø—ã –∫–æ–¥–∏—Ä—É—é—Ç –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:**

```rust
// –í–º–µ—Å—Ç–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ "–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –ø—É—Å—Ç—ã–º"
struct NonEmptyVec<T> {
    first: T,
    rest: Vec<T>,
}

impl<T> NonEmptyVec<T> {
    fn new(first: T) -> Self {
        NonEmptyVec { first, rest: vec![] }
    }
    
    // –í—Å–µ–≥–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ - –≥–∞—Ä–∞–Ω—Ç–∏—è –≤ —Ç–∏–ø–µ!
    fn head(&self) -> &T {
        &self.first
    }
}
```

---

## üî• –¢–µ–º–∞ 11: –õ—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏–∏ (–ó–∞–º—ã–∫–∞–Ω–∏—è)

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

**–ó–∞–º—ã–∫–∞–Ω–∏–µ (closure)** - —ç—Ç–æ –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç **–∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** –∏–∑ –æ–∫—Ä—É–∂–∞—é—â–µ–≥–æ scope.

**–û—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:**
```rust
// –û–±—ã—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –ù–ï –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
fn add_one(x: i32) -> i32 {
    x + 1
}

// –ó–∞–º—ã–∫–∞–Ω–∏–µ - –ú–û–ñ–ï–¢ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å
let num = 5;
let add_num = |x| x + num; // –∑–∞—Ö–≤–∞—Ç–∏–ª–∏ num –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
println!("{}", add_num(3)); // 8
```

---

### üìù –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∑–∞–º—ã–∫–∞–Ω–∏–π

```rust
// –ü–æ–ª–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å (—Ä–µ–¥–∫–æ –Ω—É–∂–µ–Ω)
let add = |x: i32, y: i32| -> i32 { x + y };

// –¢–∏–ø—ã –≤—ã–≤–æ–¥—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
let add = |x, y| { x + y };

// –ï—Å–ª–∏ –æ–¥–Ω–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ - —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏ –Ω–µ –Ω—É–∂–Ω—ã
let add = |x, y| x + y;

// –ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
let get_five = || 5;

// –û–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä
let double = |x| x * 2;

// –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ —Ç–µ–ª–æ
let complex = |x| {
    let temp = x * 2;
    let result = temp + 10;
    result
};
```

**–í—ã–≤–æ–¥ —Ç–∏–ø–æ–≤:**

```rust
// –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ —Ç–∏–ø—ã "–∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—é—Ç—Å—è"
let add = |x, y| x + y;

let a = add(1, 2);      // —Ç–∏–ø—ã –≤—ã–≤–µ–¥–µ–Ω—ã –∫–∞–∫ i32
// let b = add(1.0, 2.0); // ‚ùå –û–®–ò–ë–ö–ê! –¢–∏–ø—ã —É–∂–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ i32

// –î–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –Ω—É–∂–Ω—ã —Ä–∞–∑–Ω—ã–µ –∑–∞–º—ã–∫–∞–Ω–∏—è
let add_int = |x: i32, y: i32| x + y;
let add_float = |x: f64, y: f64| x + y;
```

---

### üé£ –ó–∞—Ö–≤–∞—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞

Rust –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç **–º–∏–Ω–∏–º–∞–ª—å–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π** —Å–ø–æ—Å–æ–± –∑–∞—Ö–≤–∞—Ç–∞.

**1. –ó–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ (&T) - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**

```rust
let numbers = vec![1, 2, 3];

// –ó–∞—Ö–≤–∞—Ç –ø–æ —Å—Å—ã–ª–∫–µ - numbers –æ—Å—Ç–∞—ë—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º
let print_first = || {
    println!("First: {}", numbers[0]);
};

print_first();
println!("{:?}", numbers); // ‚úÖ numbers –≤—Å—ë –µ—â—ë –¥–æ—Å—Ç—É–ø–µ–Ω
```

**2. –ò–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ (&mut T)**

```rust
let mut counter = 0;

// –ó–∞—Ö–≤–∞—Ç –ø–æ –∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ - –∑–∞–º—ã–∫–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å mut
let mut increment = || {
    counter += 1;
};

increment();
increment();
println!("Counter: {}", counter); // 2
```

**3. –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ (T) - —Å move**

```rust
let numbers = vec![1, 2, 3];

// move –ó–ê–°–¢–ê–í–õ–Ø–ï–¢ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å ownership
let consume = move || {
    println!("Consumed: {:?}", numbers);
    // numbers —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∑–∞–º—ã–∫–∞–Ω–∏—é
};

consume();
// println!("{:?}", numbers); // ‚ùå –û–®–ò–ë–ö–ê! numbers –ø–µ—Ä–µ–º–µ—â—ë–Ω
```

**–ö–æ–≥–¥–∞ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞–∂–¥—ã–π —Å–ø–æ—Å–æ–±:**

```rust
let s = String::from("hello");

// –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ -> –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ &T
let closure1 = || println!("{}", s);

// –ò–∑–º–µ–Ω–µ–Ω–∏–µ -> &mut T
let mut s = String::from("hello");
let mut closure2 = || s.push_str(" world");

// –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—Ä—É–∂—É -> T
let s = String::from("hello");
let closure3 = || s; // –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç String
let owned = closure3();
// closure3(); // ‚ùå –û–®–ò–ë–ö–ê! s —É–∂–µ –ø–µ—Ä–µ–º–µ—â—ë–Ω –ø–µ—Ä–≤—ã–º –≤—ã–∑–æ–≤–æ–º
```

---

### üß¨ –¢—Ä–µ–π—Ç—ã –∑–∞–º—ã–∫–∞–Ω–∏–π: Fn, FnMut, FnOnce

–ö–∞–∂–¥–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–µ–π—Ç–æ–≤:

```rust
// FnOnce - –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –û–î–ò–ù —Ä–∞–∑ (–ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
// FnMut  - –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑ —Å –∏–∑–º–µ–Ω—è–µ–º—ã–º –¥–æ—Å—Ç—É–ø–æ–º
// Fn     - –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑ —Å –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º –¥–æ—Å—Ç—É–ø–æ–º

// –ò–µ—Ä–∞—Ä—Ö–∏—è: Fn : FnMut : FnOnce
// –ï—Å–ª–∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç Fn -> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç FnMut –∏ FnOnce
```

**FnOnce - —Ä–∞–∑–æ–≤–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ:**

```rust
let s = String::from("hello");

// –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç s –ø—Ä–∏ –≤—ã–∑–æ–≤–µ
let consume = move || {
    drop(s); // —è–≤–Ω–æ –ø–æ—Ç—Ä–µ–±–ª—è–µ–º s
};

consume(); // –ø–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ - OK
// consume(); // ‚ùå –û–®–ò–ë–ö–ê! –Ω–µ–ª—å–∑—è –≤—ã–∑–≤–∞—Ç—å –¥–≤–∞–∂–¥—ã

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è FnOnce
fn call_once<F>(f: F) where F: FnOnce() {
    f(); // –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
}
```

**FnMut - –∏–∑–º–µ–Ω—è—é—â–µ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ:**

```rust
let mut counter = 0;

let mut increment = || {
    counter += 1;
    counter
};

println!("{}", increment()); // 1
println!("{}", increment()); // 2

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è FnMut
fn call_twice<F>(mut f: F) where F: FnMut() -> i32 {
    println!("{}", f());
    println!("{}", f());
}

call_twice(increment);
```

**Fn - –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ:**

```rust
let x = 5;

let read_x = || x; // —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç

println!("{}", read_x()); // 5
println!("{}", read_x()); // 5 - –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è Fn
fn call_many<F>(f: F) where F: Fn() -> i32 {
    for _ in 0..10 {
        println!("{}", f());
    }
}

call_many(read_x);
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä:**

```rust
// Iterator::map —Ç—Ä–µ–±—É–µ—Ç Fn (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–Ω–æ–≥–æ —Ä–∞–∑, –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç)
let numbers = vec![1, 2, 3];
let doubled: Vec<_> = numbers.iter().map(|x| x * 2).collect();

// Iterator::for_each –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å FnMut
let mut sum = 0;
numbers.iter().for_each(|x| sum += x);

// Thread::spawn —Ç—Ä–µ–±—É–µ—Ç FnOnce + Send (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ç–æ–∫–µ –æ–¥–∏–Ω —Ä–∞–∑)
use std::thread;

let s = String::from("hello");
thread::spawn(move || {
    println!("{}", s);
}).join().unwrap();
```

---

### üé® –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**1. –ö–æ–ª–±—ç–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:**

```rust
fn on_event<F>(callback: F) 
where
    F: Fn(Event) -> ()
{
    let event = get_event();
    callback(event);
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
on_event(|e| {
    println!("Got event: {:?}", e);
});
```

**2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π:**

```rust
let numbers = vec![1, 2, 3, 4, 5];

// map - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
let doubled: Vec<_> = numbers.iter()
    .map(|x| x * 2)
    .collect();

// filter - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
let evens: Vec<_> = numbers.iter()
    .filter(|x| *x % 2 == 0)
    .collect();

// fold - —Å–≤—ë—Ä—Ç–∫–∞
let sum = numbers.iter()
    .fold(0, |acc, x| acc + x);

// –¶–µ–ø–æ—á–∫–∏
let result: Vec<_> = numbers.iter()
    .filter(|x| *x % 2 == 0)
    .map(|x| x * x)
    .collect();
```

**3. –õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:**

```rust
fn expensive_operation() -> i32 {
    println!("Computing...");
    42
}

// –í–∞—Ä–∏–∞–Ω—Ç 1: eager - –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É
let value = expensive_operation();

// –í–∞—Ä–∏–∞–Ω—Ç 2: lazy - –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ
let compute = || expensive_operation();
// –ù–∏—á–µ–≥–æ –Ω–µ –≤—ã—á–∏—Å–ª–∏–ª–æ—Å—å!

if need_value {
    let value = compute(); // —Ç–æ–ª—å–∫–æ –∑–¥–µ—Å—å –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è
}
```

**4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ builder –ø–∞—Ç—Ç–µ—Ä–Ω:**

```rust
struct HttpClient {
    timeout: u64,
    retries: u32,
}

impl HttpClient {
    fn new() -> Self {
        HttpClient {
            timeout: 30,
            retries: 3,
        }
    }
    
    fn configure<F>(mut self, config: F) -> Self 
    where
        F: FnOnce(&mut Self)
    {
        config(&mut self);
        self
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
let client = HttpClient::new()
    .configure(|c| {
        c.timeout = 60;
        c.retries = 5;
    });
```

**5. –ö–∞—Å—Ç–æ–º–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:**

```rust
let mut people = vec![
    Person { name: "Alice", age: 30 },
    Person { name: "Bob", age: 25 },
];

// –ü–æ –≤–æ–∑—Ä–∞—Å—Ç—É
people.sort_by(|a, b| a.age.cmp(&b.age));

// –ü–æ –∏–º–µ–Ω–∏
people.sort_by_key(|p| &p.name);

// –ö–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞
people.sort_by(|a, b| {
    match a.age.cmp(&b.age) {
        std::cmp::Ordering::Equal => a.name.cmp(&b.name),
        other => other,
    }
});
```

---

### ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏

**1. –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫:**

```rust
fn create_closure() -> impl Fn() -> i32 {
    let x = 5;
    // ‚ùå –û–®–ò–ë–ö–ê! x –Ω–µ –∂–∏–≤—ë—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ
    // || x
    
    // ‚úÖ –†–µ—à–µ–Ω–∏–µ: move
    move || x // —Ç–µ–ø–µ—Ä—å x –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∑–∞–º—ã–∫–∞–Ω–∏—é
}
```

**2. –¢–∏–ø –∑–∞–º—ã–∫–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```rust
let mut x = 5;
let closure = || x; // —Ç–∏–ø –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è x

// –ï—Å–ª–∏ –¥–æ–±–∞–≤–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ:
let mut x = 5;
let mut closure = || {
    x += 1; // —Ç–µ–ø–µ—Ä—å –∑–∞–º—ã–∫–∞–Ω–∏–µ FnMut, –Ω–µ Fn!
    x
};
```

**3. move –∏ Copy —Ç–∏–ø—ã:**

```rust
let x = 5; // i32 implements Copy

let closure = move || x;
println!("{}", x); // ‚úÖ OK! i32 –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è

let s = String::from("hello"); // String –ù–ï Copy
let closure = move || s;
// println!("{}", s); // ‚ùå –û–®–ò–ë–ö–ê! s –ø–µ—Ä–µ–º–µ—â—ë–Ω
```

---

## üö® –¢–µ–º–∞ 12: –û–±—Ä–∞–±–æ—Ç–∫–∞ –û—à–∏–±–æ–∫. –û–ø–µ—Ä–∞—Ç–æ—Ä ?. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Result, Option

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

Rust –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—è–≤–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫** —á–µ—Ä–µ–∑ —Ç–∏–ø Result. –ù–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π (exceptions), –Ω–µ—Ç —Å–∫—Ä—ã—Ç–æ–≥–æ control flow.

**–§–∏–ª–æ—Å–æ—Ñ–∏—è:** –û—à–∏–±–∫–∏ - —ç—Ç–æ —á–∞—Å—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –Ω–µ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è.

---

### ‚ö° –û–ø–µ—Ä–∞—Ç–æ—Ä ? - –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

–û–ø–µ—Ä–∞—Ç–æ—Ä `?` - —ç—Ç–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –¥–ª—è —Ä–∞–Ω–Ω–µ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ.

**–ë–µ–∑ ?:**

```rust
fn read_username() -> Result<String, io::Error> {
    let f = File::open("username.txt");
    
    let mut f = match f {
        Ok(file) => file,
        Err(e) => return Err(e), // —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ
    };
    
    let mut s = String::new();
    
    match f.read_to_string(&mut s) {
        Ok(_) => Ok(s),
        Err(e) => Err(e),
    }
}
```

**–° ? (—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–π –∫–æ–¥):**

```rust
fn read_username() -> Result<String, io::Error> {
    let mut f = File::open("username.txt")?; // –µ—Å–ª–∏ Err - —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç
    let mut s = String::new();
    f.read_to_string(&mut s)?; // –µ—Å–ª–∏ Err - —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç
    Ok(s)
}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ?:**

```rust
// expression? —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤:
match expression {
    Ok(value) => value,
    Err(e) => return Err(From::from(e)), // –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è –æ—à–∏–±–æ–∫!
}
```

---

### üîÑ ? —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –æ—à–∏–±–æ–∫

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è:**

```rust
use std::fs::File;
use std::io::{self, Read};

// –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Box<dyn Error> - –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ª—é–±—É—é –æ—à–∏–±–∫—É
fn run() -> Result<(), Box<dyn std::error::Error>> {
    let mut f = File::open("data.txt")?;    // io::Error
    let mut s = String::new();
    f.read_to_string(&mut s)?;              // io::Error
    
    let num: i32 = s.trim().parse()?;       // ParseIntError
    // ? –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –≤ Box<dyn Error>
    
    Ok(())
}
```

**–ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è —Å From:**

```rust
#[derive(Debug)]
enum MyError {
    Io(io::Error),
    Parse(std::num::ParseIntError),
}

// –†–µ–∞–ª–∏–∑—É–µ–º From –¥–ª—è –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏–∏
impl From<io::Error> for MyError {
    fn from(error: io::Error) -> Self {
        MyError::Io(error)
    }
}

impl From<std::num::ParseIntError> for MyError {
    fn from(error: std::num::ParseIntError) -> Self {
        MyError::Parse(error)
    }
}

// –¢–µ–ø–µ—Ä—å ? —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
fn process() -> Result<i32, MyError> {
    let mut f = File::open("num.txt")?;  // –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è io::Error -> MyError
    let mut s = String::new();
    f.read_to_string(&mut s)?;           // –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è io::Error -> MyError
    let num = s.trim().parse()?;         // –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è ParseIntError -> MyError
    Ok(num)
}
```

---

### üéØ ? —Å Option

`?` —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å Option, –Ω–æ —Ç–æ–ª—å–∫–æ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö Option:

```rust
fn get_first_char(text: &str) -> Option<char> {
    text.chars().next() // –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Option<char>
}

fn get_first_two_chars(text: &str) -> Option<(char, char)> {
    let first = get_first_char(text)?;  // –µ—Å–ª–∏ None - —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç
    let second = text.chars().nth(1)?;  // –µ—Å–ª–∏ None - —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç
    Some((first, second))
}

// –ü—Ä–∏–º–µ—Ä—ã –≤—ã–∑–æ–≤–∞
assert_eq!(get_first_two_chars("ab"), Some(('a', 'b')));
assert_eq!(get_first_two_chars("a"), None);
assert_eq!(get_first_two_chars(""), None);
```

**–°–º–µ—à–∏–≤–∞–Ω–∏–µ Result –∏ Option:**

```rust
// –ù–ï –ö–û–ú–ü–ò–õ–ò–†–£–ï–¢–°–Ø - —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –≤–æ–∑–≤—Ä–∞—Ç–∞!
fn bad_example() -> Result<i32, Error> {
    let x = some_option()?; // ‚ùå Option –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å Result
    Ok(x)
}

// –†–ï–®–ï–ù–ò–ï 1: –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å Option -> Result
fn good_example() -> Result<i32, MyError> {
    let x = some_option()
        .ok_or(MyError::NotFound)?; // Option -> Result
    Ok(x)
}

// –†–ï–®–ï–ù–ò–ï 2: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞
fn option_example() -> Option<i32> {
    let x = some_option()?;
    Some(x)
}
```

---

### üõ†Ô∏è –ú–µ—Ç–æ–¥—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ Result

**1. –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```rust
let result: Result<i32, &str> = Ok(5);

// unwrap - –ø–∞–Ω–∏–∫—É–µ—Ç –ø—Ä–∏ Err (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–≤!)
let value = result.unwrap(); // 5
// Err("error").unwrap(); // üí• –ü–ê–ù–ò–ö–ê

// expect - –ø–∞–Ω–∏–∫—É–µ—Ç —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
let value = result.expect("Should be a valid number");

// unwrap_or - –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
let value = Err("error").unwrap_or(0); // 0

// unwrap_or_else - –ª–µ–Ω–∏–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
let value = Err("error").unwrap_or_else(|e| {
    eprintln!("Error: {}", e);
    0
});

// unwrap_or_default - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Default::default()
let value: i32 = Err("error").unwrap_or_default(); // 0
```

**2. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è:**

```rust
let result: Result<i32, &str> = Ok(5);

// map - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è Ok –∑–Ω–∞—á–µ–Ω–∏—è
let doubled = result.map(|x| x * 2); // Ok(10)

// map_err - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è Err –∑–Ω–∞—á–µ–Ω–∏—è
let custom_err = result.map_err(|e| format!("Error: {}", e));

// and_then (flatMap) - —Ü–µ–ø–æ—á–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö Result
let result = Ok(5)
    .and_then(|x| Ok(x * 2))      // Ok(10)
    .and_then(|x| {
        if x > 5 {
            Ok(x)
        } else {
            Err("Too small")
        }
    }); // Ok(10)
```

**3. –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã:**

```rust
let ok1: Result<i32, &str> = Ok(5);
let ok2: Result<i32, &str> = Ok(10);
let err: Result<i32, &str> = Err("error");

// and - –µ—Å–ª–∏ –æ–±–∞ Ok, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ç–æ—Ä–æ–π
ok1.and(ok2);    // Ok(10)
ok1.and(err);    // Err("error")
err.and(ok1);    // Err("error")

// or - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π Ok –∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π Err
ok1.or(ok2);     // Ok(5)
ok1.or(err);     // Ok(5)
err.or(ok1);     // Ok(5)

// –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: fallback
let primary = connect_to_primary();
let secondary = connect_to_secondary();
let connection = primary.or(secondary)?; // –ø–æ–ø—Ä–æ–±—É–µ–º –≤—Ç–æ—Ä–∏—á–Ω—ã–π –µ—Å–ª–∏ –ø–µ—Ä–≤–∏—á–Ω—ã–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

---

### üì¶ –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö Result

**1. –¶–µ–ø–æ—á–∫–∏ —Å ?:**

```rust
fn complex_operation() -> Result<String, Error> {
    let data = fetch_data()?;
    let parsed = parse_data(&data)?;
    let validated = validate(parsed)?;
    let transformed = transform(validated)?;
    Ok(format_output(transformed))
}
```

**2. collect() –¥–ª—è Vec<Result>:**

```rust
let results: Vec<Result<i32, _>> = vec![
    Ok(1),
    Ok(2),
    Err("error"),
    Ok(4),
];

// –°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ Ok –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—É—é –æ—à–∏–±–∫—É
let collected: Result<Vec<i32>, _> = results.into_iter().collect();
// Err("error") - –ø–µ—Ä–≤–∞—è –æ—à–∏–±–∫–∞

// –¢–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
let numbers: Vec<i32> = vec![Ok(1), Err("e"), Ok(3)]
    .into_iter()
    .filter_map(Result::ok)
    .collect(); // vec![1, 3]
```

**3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:**

```rust
fn process_all(items: Vec<String>) -> Result<Vec<Data>, Error> {
    items
        .into_iter()
        .map(|item| process_item(&item))  // Vec<Result<Data, Error>>
        .collect()                         // Result<Vec<Data>, Error>
    // –ï—Å–ª–∏ —Ö–æ—Ç—å –æ–¥–∏–Ω Err - –≤—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Err
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö, —Å–æ–±–∏—Ä–∞–µ–º –æ—à–∏–±–∫–∏
fn process_all_collect_errors(items: Vec<String>) -> (Vec<Data>, Vec<Error>) {
    items
        .into_iter()
        .map(|item| process_item(&item))
        .fold((vec![], vec![]), |(mut oks, mut errs), result| {
            match result {
                Ok(data) => oks.push(data),
                Err(e) => errs.push(e),
            }
            (oks, errs)
        })
}
```

---

### üé≠ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**1. Fail Fast (—Ä–∞–Ω–Ω–µ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ):**

```rust
fn validate_user(user: &User) -> Result<(), ValidationError> {
    if user.name.is_empty() {
        return Err(ValidationError::EmptyName);
    }
    
    if user.age < 18 {
        return Err(ValidationError::TooYoung);
    }
    
    if !user.email.contains('@') {
        return Err(ValidationError::InvalidEmail);
    }
    
    Ok(())
}
```

**2. Accumulate Errors (–Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫):**

```rust
fn validate_user_all(user: &User) -> Result<(), Vec<ValidationError>> {
    let mut errors = Vec::new();
    
    if user.name.is_empty() {
        errors.push(ValidationError::EmptyName);
    }
    
    if user.age < 18 {
        errors.push(ValidationError::TooYoung);
    }
    
    if !user.email.contains('@') {
        errors.push(ValidationError::InvalidEmail);
    }
    
    if errors.is_empty() {
        Ok(())
    } else {
        Err(errors)
    }
}
```

**3. Retry Pattern:**

```rust
fn retry<F, T, E>(mut operation: F, max_attempts: u32) -> Result<T, E>
where
    F: FnMut() -> Result<T, E>,
{
    let mut attempts = 0;
    loop {
        match operation() {
            Ok(result) => return Ok(result),
            Err(e) => {
                attempts += 1;
                if attempts >= max_attempts {
                    return Err(e);
                }
                // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å delay
            }
        }
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
let data = retry(|| fetch_from_api(), 3)?;
```

**4. Fallback Pattern:**

```rust
fn get_config() -> Config {
    load_from_file()
        .or_else(|_| load_from_env())
        .or_else(|_| load_from_network())
        .unwrap_or_else(|_| Config::default())
}
```

**5. Context Pattern (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫ –æ—à–∏–±–∫–∞–º):**

```rust
// –° –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π anyhow
use anyhow::{Context, Result};

fn process_file(path: &str) -> Result<String> {
    let content = std::fs::read_to_string(path)
        .with_context(|| format!("Failed to read file: {}", path))?;
    
    let parsed = parse(&content)
        .context("Failed to parse content")?;
    
    Ok(parsed)
}

// –û—à–∏–±–∫–∞ –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–µ–ø–æ—á–∫—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
// "Failed to parse content"
// Caused by: "Invalid JSON at line 5"
// Caused by: "Failed to read file: config.json"
```

---

### üîß –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```rust
use std::fmt;

#[derive(Debug)]
pub enum MyError {
    NotFound,
    PermissionDenied,
    InvalidInput(String),
}

impl fmt::Display for MyError {
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {
        match self {
            MyError::NotFound => write!(f, "Resource not found"),
            MyError::PermissionDenied => write!(f, "Permission denied"),
            MyError::InvalidInput(msg) => write!(f, "Invalid input: {}", msg),
        }
    }
}

impl std::error::Error for MyError {}
```

**–° –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏:**

```rust
#[derive(Debug)]
pub enum AppError {
    Io(io::Error),
    Parse(ParseError),
    Database(DatabaseError),
    Custom(String),
}

impl fmt::Display for AppError {
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {
        match self {
            AppError::Io(e) => write!(f, "IO error: {}", e),
            AppError::Parse(e) => write!(f, "Parse error: {}", e),
            AppError::Database(e) => write!(f, "Database error: {}", e),
            AppError::Custom(msg) => write!(f, "{}", msg),
        }
    }
}

impl std::error::Error for AppError {
    fn source(&self) -> Option<&(dyn std::error::Error + 'static)> {
        match self {
            AppError::Io(e) => Some(e),
            AppError::Parse(e) => Some(e),
            AppError::Database(e) => Some(e),
            AppError::Custom(_) => None,
        }
    }
}

// –ê–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è
impl From<io::Error> for AppError {
    fn from(error: io::Error) -> Self {
        AppError::Io(error)
    }
}
```

---

### üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å panic! vs Result

**panic! (–ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è):**
- –ù–µ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–º—ã–µ –æ—à–∏–±–∫–∏
- –ù–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ)
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API (programmer error)

```rust
fn get_user(id: UserId) -> &User {
    self.users.get(&id)
        .expect("User must exist - this is a bug")
}
```

**Result (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫):**
- –û–∂–∏–¥–∞–µ–º—ã–µ –æ—à–∏–±–∫–∏ (—Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (API, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)

```rust
fn fetch_user(id: UserId) -> Result<User, ApiError> {
    // –°–µ—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
    api_client.get(&format!("/users/{}", id))
}
```

---

### üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫

1. **Result<T, E>** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (—è–≤–Ω–æ –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ)
2. **? –æ–ø–µ—Ä–∞—Ç–æ—Ä** - –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤–≤–µ—Ä—Ö (—Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç)
3. **–¢–∏–ø—ã –æ—à–∏–±–æ–∫** - –∏—Å–ø–æ–ª—å–∑—É–π –∫–∞—Å—Ç–æ–º–Ω—ã–µ enum –¥–ª—è –¥–æ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
4. **–ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã** - map, and_then, or_else –¥–ª—è –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
5. **–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ vs —Ä–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥** - –≤—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
6. **panic! —Ç–æ–ª—å–∫–æ –¥–ª—è bugs** - Result –¥–ª—è –æ–∂–∏–¥–∞–µ–º—ã—Ö –æ—à–∏–±–æ–∫

---

## üéØ –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å (1-3)

1. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Option<T> –∏ Result<T, E>?** –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Ç–∏–ø?

2. **–ß—Ç–æ —Ç–∞–∫–æ–µ unit type `()`?** –ü—Ä–∏–≤–µ–¥–∏ —Ç—Ä–∏ –ø—Ä–∏–º–µ—Ä–∞ –µ–≥–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

3. **–ù–∞–ø–∏—à–∏ –∑–∞–º—ã–∫–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —á–∏—Å–ª–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç.** –ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π –µ–≥–æ –≤ –º–µ—Ç–æ–¥–µ `map()` –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∞ —á–∏—Å–µ–ª.

### –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (4-7)

4. **–û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —ç—Ç–∏–º–∏ —Ç—Ä–µ–º—è –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏:**
   ```rust
   let x = String::from("hello");
   
   let c1 = || println!("{}", x);
   let c2 = || x.clone();
   let c3 = move || x;
   ```
   –ö–∞–∫–æ–π —Ç—Ä–µ–π—Ç (Fn/FnMut/FnOnce) —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–∞–∂–¥–æ–µ?

5. **–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é `safe_divide(a: f64, b: f64) -> Option<f64>`** –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `None` –ø—Ä–∏ –¥–µ–ª–µ–Ω–∏–∏ –Ω–∞ –Ω–æ–ª—å. –ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π –µ—ë –≤ —Ü–µ–ø–æ—á–∫–µ —Å `map()` –∏ `unwrap_or()`.

6. **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä `?` –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ?** –ü–æ–∫–∞–∂–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–π –∫–æ–¥ –±–µ–∑ `?` –¥–ª—è:
   ```rust
   let value = some_operation()?;
   ```

7. **–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —á–∏—Ç–∞–µ—Ç –¥–≤–∞ —á–∏—Å–ª–∞ –∏–∑ –¥–≤—É—Ö —Ñ–∞–π–ª–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ö —Å—É–º–º—É.** –ò—Å–ø–æ–ª—å–∑—É–π `?` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫. –¢–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞: `Result<i32, Box<dyn std::error::Error>>`.

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å (8-10)

8. **–†–µ–∞–ª–∏–∑—É–π —Ñ—É–Ω–∫—Ü–∏—é `retry`**, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–º—ã–∫–∞–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–µ `Result<T, E>` –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫. –ü—Ä–∏ –æ—à–∏–±–∫–µ - –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –≤—ã–∑–æ–≤. –°–∏–≥–Ω–∞—Ç—É—Ä–∞:
   ```rust
   fn retry<F, T, E>(operation: F, attempts: u32) -> Result<T, E>
   where
       F: FnMut() -> Result<T, E>
   { /* ... */ }
   ```

9. **–°–æ–∑–¥–∞–π enum –¥–ª—è HTTP –æ—à–∏–±–æ–∫** (`NotFound`, `Unauthorized`, `ServerError(String)`). –†–µ–∞–ª–∏–∑—É–π —Ç—Ä–µ–π—Ç—ã `Display` –∏ `Error`. –î–æ–±–∞–≤—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏–∑ `io::Error` —á–µ—Ä–µ–∑ `From`.

10. **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π API –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ HTTP –∫–ª–∏–µ–Ω—Ç–∞** –∏—Å–ø–æ–ª—å–∑—É—è builder pattern —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏:
    ```rust
    let client = HttpClient::new()
        .configure(|config| {
            config.timeout = Duration::from_secs(30);
            config.retries = 3;
        })
        .with_middleware(|req| {
            req.headers.insert("User-Agent", "MyApp");
        })
        .build();
    ```
    –ö–∞–∫–∏–µ —Ç—Ä–µ–π—Ç—ã –¥–æ–ª–∂–Ω—ã —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –∑–∞–º—ã–∫–∞–Ω–∏—è?

---

## üéì –§–∏–Ω–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏

–≠—Ç–∏ —Ç—Ä–∏ —Ç–µ–º—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç **—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å** –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ Rust:

- **–°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤** - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∫–∞–∫ –ø–æ–º–æ—â–Ω–∏–∫, —Ç–∏–ø—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
- **–ó–∞–º—ã–∫–∞–Ω–∏—è** - —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏—è, –∑–∞—Ö–≤–∞—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —è–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã, –∫–æ–º–ø–æ–∑–∏—Ü–∏—è —á–µ—Ä–µ–∑ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã

**–ì–ª–∞–≤–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø:** Rust –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –¥—É–º–∞—Ç—å –æ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö (None, Err) –Ω–∞ —ç—Ç–∞–ø–µ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞, –∞ –Ω–µ –¥–µ–±–∞–≥–∞ –≤ –ø—Ä–æ–¥–µ.

---

# Rust: –ö—É—á–∞, —É–º–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å

## –¢–µ–º–∞ 13: –†–∞–±–æ—Ç–∞ —Å –∫—É—á–µ–π. Box, Arc, Rc. RAII

### –ü–æ—á–µ–º—É –∫—É—á–∞ –≤–æ–æ–±—â–µ –Ω—É–∂–Ω–∞?

–í Rust –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å—ë –∂–∏–≤—ë—Ç –Ω–∞ —Å—Ç–µ–∫–µ. –°—Ç–µ–∫ –±—ã—Å—Ç—Ä—ã–π, –Ω–æ —É –Ω–µ–≥–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –∏–∑–≤–µ—Å—Ç–Ω—ã–π –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏. –ö—É—á–∞ (heap) –Ω—É–∂–Ω–∞ –∫–æ–≥–¥–∞:

1. **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏** (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
2. **–î–∞–Ω–Ω—ã–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ** –¥–ª—è —Å—Ç–µ–∫–∞
3. **–ù—É–∂–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –≤–ª–∞–¥–µ–Ω–∏—è** –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ —Ç–∏–ø—ã** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏)

### Box<T> - –±–∞–∑–æ–≤—ã–π —É–º–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å

`Box<T>` - —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ. –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π.

```rust
// –°–æ–∑–¥–∞–Ω–∏–µ Box
let x = Box::new(5);
println!("{}", x); // 5

// Box –≤–ª–∞–¥–µ–µ—Ç –¥–∞–Ω–Ω—ã–º–∏ - –∫–æ–≥–¥–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Å–∫–æ–ø–∞, 
// –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ –∫—É—á–∏
{
    let boxed = Box::new(String::from("hello"));
} // –∑–¥–µ—Å—å boxed –∏ –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ —É–Ω–∏—á—Ç–æ–∂–∞—é—Ç—Å—è
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç**: `Box` —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω RAII - –∫–æ–≥–¥–∞ `Box` —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è, –ø–∞–º—è—Ç—å –≤ –∫—É—á–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è.

#### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Box: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ —Ç–∏–ø—ã

```rust
// –≠—Ç–æ –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –∑–Ω–∞–µ—Ç —Ä–∞–∑–º–µ—Ä
// enum List {
//     Cons(i32, List),  // –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä!
//     Nil,
// }

// –ê —Ç–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç - Box –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä (—É–∫–∞–∑–∞—Ç–µ–ª—å)
enum List {
    Cons(i32, Box<List>),
    Nil,
}

let list = List::Cons(1, 
    Box::new(List::Cons(2, 
        Box::new(List::Nil)
    ))
);
```

### Rc<T> - —É–º–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å —Å –ø–æ–¥—Å—á—ë—Ç–æ–º —Å—Å—ã–ª–æ–∫

`Rc` = Reference Counted. –ü–æ–∑–≤–æ–ª—è–µ—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–∏–º –≤–ª–∞–¥–µ–ª—å—Ü–∞–º** —á–∏—Ç–∞—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ.

```rust
use std::rc::Rc;

let a = Rc::new(5);
let b = Rc::clone(&a);  // –ù–ï –∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, —Ç–æ–ª—å–∫–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫
let c = Rc::clone(&a);

println!("–°—á—ë—Ç—á–∏–∫: {}", Rc::strong_count(&a)); // 3

// –ö–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π Rc —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è, –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª—è—é—Ç—Å—è
```

**–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å**:
- `Rc::clone()` - –¥–µ—à—ë–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (–∫–æ–ø–∏—Ä—É–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ç —Å—á—ë—Ç—á–∏–∫)
- `.clone()` –Ω–∞ —Å–∞–º–∏—Ö –¥–∞–Ω–Ω—ã—Ö - –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (–∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ)
- `Rc` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ **–æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–º** –∫–æ–¥–µ (–Ω–µ Send/Sync)
- `Rc` –¥–∞—ë—Ç —Ç–æ–ª—å–∫–æ **–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π –¥–æ—Å—Ç—É–ø**

#### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –≥—Ä–∞—Ñ

```rust
use std::rc::Rc;

struct Node {
    value: i32,
    children: Vec<Rc<Node>>,
}

let leaf = Rc::new(Node { value: 3, children: vec![] });

let branch1 = Rc::new(Node {
    value: 1,
    children: vec![Rc::clone(&leaf)],
});

let branch2 = Rc::new(Node {
    value: 2,
    children: vec![Rc::clone(&leaf)],
});

// leaf –∏–º–µ–µ—Ç 3 –≤–ª–∞–¥–µ–ª—å—Ü–∞: leaf, branch1.children, branch2.children
println!("–°—Å—ã–ª–æ–∫ –Ω–∞ leaf: {}", Rc::strong_count(&leaf)); // 3
```

### Arc<T> - –∞—Ç–æ–º–∞—Ä–Ω—ã–π Rc –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏

`Arc` = Atomic Reference Counted. –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ `Rc`, –Ω–æ **–ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–µ–Ω**.

```rust
use std::sync::Arc;
use std::thread;

let data = Arc::new(vec![1, 2, 3, 4]);

let handles: Vec<_> = (0..3).map(|i| {
    let data_clone = Arc::clone(&data);
    thread::spawn(move || {
        println!("–ü–æ—Ç–æ–∫ {}: {:?}", i, data_clone);
    })
}).collect();

for handle in handles {
    handle.join().unwrap();
}
```

**–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Rc –∏ Arc**:
- `Rc` - –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞
- `Arc` - –º–µ–¥–ª–µ–Ω–Ω–µ–µ (–∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏), –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- `Arc` —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Send + Sync`

### RAII - Resource Acquisition Is Initialization

RAII - —ç—Ç–æ **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω** –≤ Rust. –ò–¥–µ—è –ø—Ä–æ—Å—Ç–∞—è:

> –†–µ—Å—É—Ä—Å (–ø–∞–º—è—Ç—å, —Ñ–∞–π–ª, –º—å—é—Ç–µ–∫—Å) –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏.

```rust
use std::fs::File;
use std::io::Write;

{
    let mut file = File::create("test.txt").unwrap();
    file.write_all(b"Hello").unwrap();
    // file –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–¥–µ—Å—å!
}

// –¢–æ –∂–µ —Å Box, Rc, Arc, Mutex –∏ —Ç.–¥.
{
    let data = Box::new(vec![1, 2, 3]);
    // –ø–∞–º—è—Ç—å –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
}
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ**:
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–±—ã—Ç—å –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Ä–µ—Å—É—Ä—Å
- –ù–µ—Ç —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏ (–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –∫–æ–¥–µ)
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –ø–∞–Ω–∏–∫–µ (—á–µ—Ä–µ–∑ Drop trait)

#### Drop trait - –æ—Å–Ω–æ–≤–∞ RAII

```rust
struct MyResource {
    name: String,
}

impl Drop for MyResource {
    fn drop(&mut self) {
        println!("–û—Å–≤–æ–±–æ–∂–¥–∞—é —Ä–µ—Å—É—Ä—Å: {}", self.name);
    }
}

{
    let r1 = MyResource { name: "–ø–µ—Ä–≤—ã–π".to_string() };
    let r2 = MyResource { name: "–≤—Ç–æ—Ä–æ–π".to_string() };
    // –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å–∫–æ–ø–∞ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è drop –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:
    // "–û—Å–≤–æ–±–æ–∂–¥–∞—é —Ä–µ—Å—É—Ä—Å: –≤—Ç–æ—Ä–æ–π"
    // "–û—Å–≤–æ–±–æ–∂–¥–∞—é —Ä–µ—Å—É—Ä—Å: –ø–µ—Ä–≤—ã–π"
}
```

### –ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

| –¢–∏–ø | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-----|-------------------|
| `Box<T>` | –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü, –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ |
| `Rc<T>` | –ù–µ—Å–∫–æ–ª—å–∫–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π, –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã–π –∫–æ–¥ |
| `Arc<T>` | –ù–µ—Å–∫–æ–ª—å–∫–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π, –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π –∫–æ–¥ |

---

## –¢–µ–º–∞ 14: –ü–æ—Ç–æ–∫–∏. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤. Send + Sync

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤

```rust
use std::thread;
use std::time::Duration;

fn main() {
    // –°–æ–∑–¥–∞—ë–º –ø–æ—Ç–æ–∫
    let handle = thread::spawn(|| {
        for i in 1..10 {
            println!("–ò–∑ –ø–æ—Ç–æ–∫–∞: {}", i);
            thread::sleep(Duration::from_millis(1));
        }
    });

    for i in 1..5 {
        println!("–ò–∑ main: {}", i);
        thread::sleep(Duration::from_millis(1));
    }

    // –ñ–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞
    handle.join().unwrap();
}
```

**–í–∞–∂–Ω–æ**:
- `thread::spawn` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `JoinHandle`
- –ë–µ–∑ `.join()` –ø–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –Ω–µ —É—Å–ø–µ—Ç—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è
- –ì–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –Ω–µ –∂–¥—ë—Ç –¥–æ—á–µ—Ä–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–æ—Ç–æ–∫ —Å move

```rust
let v = vec![1, 2, 3];

// –ë–µ–∑ move - –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!
// let handle = thread::spawn(|| {
//     println!("{:?}", v); // error: –º–æ–∂–µ—Ç –∂–∏—Ç—å –¥–æ–ª—å—à–µ v
// });

// –° move - –≤–ª–∞–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –ø–æ—Ç–æ–∫
let handle = thread::spawn(move || {
    println!("{:?}", v);
});

// println!("{:?}", v); // error: v —É–∂–µ –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ –ø–æ—Ç–æ–∫

handle.join().unwrap();
```

### Send –∏ Sync - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä–∫–µ—Ä—ã –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

Rust –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ **—Ç–∏–ø–∞–∂–∏-–º–∞—Ä–∫–µ—Ä—ã**:

#### Send - –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏

–¢–∏–ø–∞–∂ `Send` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤–ª–∞–¥–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ç–∏–ø–∞ –º–æ–∂–Ω–æ **–±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å** –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫.

```rust
// –ü—Ä–∏–º–µ—Ä—ã —Ç–∏–ø–æ–≤, —Ä–µ–∞–ª–∏–∑—É—é—â–∏—Ö Send:
// - –ø—Ä–∏–º–∏—Ç–∏–≤—ã: i32, String, Vec<T> –≥–¥–µ T: Send
// - Box<T> –≥–¥–µ T: Send
// - Arc<T> –≥–¥–µ T: Send + Sync

// –ù–ï —Ä–µ–∞–ª–∏–∑—É—é—Ç Send:
// - Rc<T> (–Ω–µ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫)
// - &mut T –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∏–¥–µ—è**: –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –¥–∞—Å—Ç –ø–µ—Ä–µ–¥–∞—Ç—å `Rc` –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫.

```rust
use std::rc::Rc;
use std::thread;

let rc = Rc::new(5);

// –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏! Rc –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç Send
// thread::spawn(move || {
//     println!("{}", rc);
// });
```

#### Sync - –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–µ–ª–∏—Ç—å —Å—Å—ã–ª–∫–∏ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏

–¢–∏–ø–∞–∂ `Sync` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å—Å—ã–ª–∫—É `&T` –º–æ–∂–Ω–æ **–±–µ–∑–æ–ø–∞—Å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

```rust
// T: Sync –µ—Å–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å &T –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏

// Sync:
// - –ø—Ä–∏–º–∏—Ç–∏–≤—ã: i32, bool
// - Arc<T> –≥–¥–µ T: Send + Sync
// - Mutex<T> –≥–¥–µ T: Send

// –ù–ï Sync:
// - Cell<T>, RefCell<T> (–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
// - Rc<T>
```

**–°–≤—è–∑—å Send –∏ Sync**:
```
T: Sync  ‚ü∫  &T: Send
```

–ï—Å–ª–∏ `T` —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Sync`, —Ç–æ –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å `&T` –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫.

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Send –∏ Sync

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

```rust
struct MyStruct {
    data: Vec<i32>,
    count: i32,
}
// MyStruct –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ Send + Sync, 
// –ø–æ—Ç–æ–º—É —á—Ç–æ Vec<i32> –∏ i32 - Send + Sync
```

–ù–æ –º–æ–∂–Ω–æ –∑–∞–ø—Ä–µ—Ç–∏—Ç—å:

```rust
use std::marker::PhantomData;
use std::rc::Rc;

struct NotSend {
    _marker: PhantomData<Rc<()>>,
}
// NotSend –ù–ï —Ä–µ–∞–ª–∏–∑—É–µ—Ç Send –∏–∑-–∑–∞ Rc
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –ø–æ–¥—Å—á—ë—Ç –≤ –ø–æ—Ç–æ–∫–∞—Ö (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** (–Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è):

```rust
let mut counter = 0;

let handles: Vec<_> = (0..10).map(|_| {
    thread::spawn(move || {
        counter += 1; // error: –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –∏–∑–º–µ–Ω—è—é—Ç counter
    })
}).collect();
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ** (—Å Mutex):

```rust
use std::sync::{Arc, Mutex};

let counter = Arc::new(Mutex::new(0));

let handles: Vec<_> = (0..10).map(|_| {
    let counter_clone = Arc::clone(&counter);
    thread::spawn(move || {
        let mut num = counter_clone.lock().unwrap();
        *num += 1;
    })
}).collect();

for handle in handles {
    handle.join().unwrap();
}

println!("–†–µ–∑—É–ª—å—Ç–∞—Ç: {}", *counter.lock().unwrap()); // 10
```

---

## –¢–µ–º–∞ 15: –õ—è–º–±–¥—ã –∏ –ø–æ—Ç–æ–∫–∏. Send + Sync. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ move –∏ Arc

### –ó–∞–º—ã–∫–∞–Ω–∏—è (–ª—è–º–±–¥—ã) –≤ Rust

–ó–∞–º—ã–∫–∞–Ω–∏–µ - —ç—Ç–æ –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç **–∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

```rust
let x = 5;

// –ó–∞–º—ã–∫–∞–Ω–∏–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç x –ø–æ —Å—Å—ã–ª–∫–µ
let print_x = || println!("x = {}", x);
print_x(); // x = 5

// –ú–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å x –¥–∞–ª—å—à–µ
println!("x –≤—Å—ë –µ—â—ë –¥–æ—Å—Ç—É–ø–µ–Ω: {}", x);
```

### –¢—Ä–∏ —Å–ø–æ—Å–æ–±–∞ –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ø–æ—Å–æ–± –∑–∞—Ö–≤–∞—Ç–∞:

1. **–ü–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ** `&T` (FnOnce)
2. **–ü–æ –∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ** `&mut T` (FnMut)
3. **–ü–æ –∑–Ω–∞—á–µ–Ω–∏—é** `T` (Fn)

```rust
let mut list = vec![1, 2, 3];

// –ó–∞—Ö–≤–∞—Ç –ø–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ
let printer = || println!("{:?}", list);
printer();

// –ó–∞—Ö–≤–∞—Ç –ø–æ –∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ
let mut pusher = || list.push(4);
pusher();

// –ó–∞—Ö–≤–∞—Ç –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é (move)
let consumer = move || {
    println!("{:?}", list);
    // list —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∑–∞–º—ã–∫–∞–Ω–∏—é
};
consumer();
// println!("{:?}", list); // error: list –ø–µ—Ä–µ–º–µ—â—ë–Ω
```

### move —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏ –≤ –ø–æ—Ç–æ–∫–∞—Ö

–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `move` **–∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç** –∑–∞–º—ã–∫–∞–Ω–∏–µ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é.

```rust
let data = vec![1, 2, 3];

// –ë–ï–ó move - –æ—à–∏–±–∫–∞!
// let handle = thread::spawn(|| {
//     println!("{:?}", data); 
//     // error: data –º–æ–∂–µ—Ç –∂–∏—Ç—å –º–µ–Ω—å—à–µ, —á–µ–º –ø–æ—Ç–æ–∫
// });

// –° move - –≤–ª–∞–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –ø–æ—Ç–æ–∫
let handle = thread::spawn(move || {
    println!("{:?}", data);
    // data —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ—Ç–æ–∫—É
});

handle.join().unwrap();
```

**–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω move?**
- –ü–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∂–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ñ—É–Ω–∫—Ü–∏—é
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –∑–Ω–∞–µ—Ç, –∫–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è
- `move` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∂–∏–≤—É—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ

### Arc + move: —à–∞—Ä–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏

–ß—Ç–æ–±—ã –¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ—Ç–æ–∫–∞–º –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º `Arc`:

```rust
use std::sync::Arc;
use std::thread;

let data = Arc::new(vec![1, 2, 3, 4, 5]);
let mut handles = vec![];

for i in 0..3 {
    // –ö–ª–æ–Ω–∏—Ä—É–µ–º Arc (—É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ —Å—Å—ã–ª–æ–∫)
    let data_clone = Arc::clone(&data);
    
    // move –ø–µ—Ä–µ–¥–∞—ë—Ç –≤–ª–∞–¥–µ–Ω–∏–µ data_clone –≤ –ø–æ—Ç–æ–∫
    let handle = thread::spawn(move || {
        let sum: i32 = data_clone.iter().sum();
        println!("–ü–æ—Ç–æ–∫ {}: —Å—É–º–º–∞ = {}", i, sum);
    });
    
    handles.push(handle);
}

for handle in handles {
    handle.join().unwrap();
}

// data –≤—Å—ë –µ—â—ë –¥–æ—Å—Ç—É–ø–µ–Ω –≤ main
println!("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {:?}", data);
```

### –ò–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å —Å Arc + Mutex

`Arc` –¥–∞—ë—Ç —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ. –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–µ–Ω `Mutex`:

```rust
use std::sync::{Arc, Mutex};
use std::thread;

let counter = Arc::new(Mutex::new(0));
let mut handles = vec![];

for _ in 0..10 {
    let counter_clone = Arc::clone(&counter);
    
    let handle = thread::spawn(move || {
        for _ in 0..100 {
            let mut num = counter_clone.lock().unwrap();
            *num += 1;
            // –º—å—é—Ç–µ–∫—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è (RAII!)
        }
    });
    
    handles.push(handle);
}

for handle in handles {
    handle.join().unwrap();
}

println!("–†–µ–∑—É–ª—å—Ç–∞—Ç: {}", *counter.lock().unwrap()); // 1000
```

### Send + Sync –≤ –∑–∞–º—ã–∫–∞–Ω–∏—è—Ö

–ó–∞–º—ã–∫–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Send`, –µ—Å–ª–∏ **–≤—Å–µ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑—É—é—Ç Send**.

```rust
use std::rc::Rc;

let rc = Rc::new(5);
let x = 10;

// –≠—Ç–æ –∑–∞–º—ã–∫–∞–Ω–∏–µ –ù–ï Send (–∏–∑-–∑–∞ rc)
let closure = move || {
    println!("{} {}", rc, x);
};

// –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!
// thread::spawn(closure);

// –ù–æ –µ—Å–ª–∏ —É–±—Ä–∞—Ç—å rc:
let closure_ok = move || {
    println!("{}", x);
};

thread::spawn(closure_ok); // OK: i32 —Ä–µ–∞–ª–∏–∑—É–µ—Ç Send
```

### –ü–∞—Ç—Ç–µ—Ä–Ω: —Ä–∞—Å—á—ë—Ç—ã –≤ –ø–æ—Ç–æ–∫–∞—Ö —Å Arc

```rust
use std::sync::Arc;
use std::thread;

fn parallel_sum(data: Vec<i32>) -> i32 {
    let data = Arc::new(data);
    let chunk_size = data.len() / 4;
    
    let handles: Vec<_> = (0..4).map(|i| {
        let data_clone = Arc::clone(&data);
        
        thread::spawn(move || {
            let start = i * chunk_size;
            let end = if i == 3 { data_clone.len() } else { (i + 1) * chunk_size };
            
            data_clone[start..end].iter().sum::<i32>()
        })
    }).collect();
    
    handles.into_iter()
        .map(|h| h.join().unwrap())
        .sum()
}

let nums = vec![1, 2, 3, 4, 5, 6, 7, 8];
println!("–°—É–º–º–∞: {}", parallel_sum(nums));
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è

1. **move + Arc** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏:
   - `Arc` –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö
   - `move` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤–ª–∞–¥–µ–Ω–∏—è Arc –≤ –ø–æ—Ç–æ–∫
   
2. **Send/Sync –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏**:
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–ª—É—á–∞–π–Ω–æ —Å–æ–∑–¥–∞—Ç—å data race
   - –û—à–∏–±–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –¥–æ –∑–∞–ø—É—Å–∫–∞
   
3. **RAII –≤–µ–∑–¥–µ**:
   - `MutexGuard` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
   - `Arc` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç –ø–∞–º—è—Ç—å
   - –ü–æ—Ç–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è

4. **–ó–∞–º—ã–∫–∞–Ω–∏—è –Ω–∞—Å–ª–µ–¥—É—é—Ç Send/Sync** –æ—Ç –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

---

## –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –í–æ–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π

1. **–û–±—ä—è—Å–Ω–∏—Ç–µ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `Box`, `Rc` –∏ `Arc`. –í –∫–∞–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –≤—ã –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö?**

2. **–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç —Å —ç—Ç–∏–º –∫–æ–¥–æ–º –∏ –ø–æ—á–µ–º—É?**
   ```rust
   let x = vec![1, 2, 3];
   let handle = thread::spawn(|| {
       println!("{:?}", x);
   });
   handle.join().unwrap();
   ```

3. **–ü–æ—á–µ–º—É `Rc<T>` –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Send`? –ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫, –µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å `Rc` –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏?**

4. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è –ø–æ–¥—Ö–æ–¥–∞–º–∏ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –∑–∞–º—ã–∫–∞–Ω–∏–π –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤?**
   ```rust
   // –í–∞—Ä–∏–∞–Ω—Ç 1
   let data = Arc::new(vec![1, 2, 3]);
   let handle = thread::spawn(move || println!("{:?}", data));
   
   // –í–∞—Ä–∏–∞–Ω—Ç 2
   let data = Arc::new(vec![1, 2, 3]);
   let data_clone = Arc::clone(&data);
   let handle = thread::spawn(move || println!("{:?}", data_clone));
   ```

5. **–ß—Ç–æ —Ç–∞–∫–æ–µ RAII –∏ –∫–∞–∫ –æ–Ω –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –≤ Rust? –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–º–µ—Ä.**

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

6. **–ù–∞–π–¥–∏—Ç–µ –æ—à–∏–±–∫—É –≤ —ç—Ç–æ–º –∫–æ–¥–µ:**
   ```rust
   use std::sync::Arc;
   let counter = Arc::new(0);
   
   let handles: Vec<_> = (0..10).map(|_| {
       let c = Arc::clone(&counter);
       thread::spawn(move || {
           *c += 1; // error?
       })
   }).collect();
   ```

7. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä —á–∏—Å–µ–ª –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö, –∏—Å–ø–æ–ª—å–∑—É—è `Arc` –∏ `move`. –ö–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É —Å–≤–æ–µ–π —á–∞—Å—Ç–∏ –º–∞—Å—Å–∏–≤–∞.**

8. **–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è? –ö–∞–∫ –µ–≥–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å?**
   ```rust
   use std::rc::Rc;
   let data = Rc::new(vec![1, 2, 3]);
   
   thread::spawn(move || {
       println!("{:?}", data);
   });
   ```

9. **–û–±—ä—è—Å–Ω–∏—Ç–µ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –∏ –ø–æ—á–µ–º—É —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –±—É–¥–µ—Ç 1000:**
   ```rust
   let counter = Arc::new(Mutex::new(0));
   let handles: Vec<_> = (0..10).map(|_| {
       let c = Arc::clone(&counter);
       thread::spawn(move || {
           for _ in 0..100 {
               *c.lock().unwrap() += 1;
           }
       })
   }).collect();
   
   for h in handles { h.join().unwrap(); }
   println!("{}", *counter.lock().unwrap());
   ```

10. **–°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –ù–ï —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Send`, –∏ –æ–±—ä—è—Å–Ω–∏—Ç–µ, –ø–æ—á–µ–º—É –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–µ—Ä–µ–¥–∞—Ç—å –µ—ë –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫. –ó–∞—Ç–µ–º –∏–∑–º–µ–Ω–∏—Ç–µ –µ—ë —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∞ —Å—Ç–∞–ª–∞ `Send`.**

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

- **Box** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –¥–∞–Ω–Ω—ã—Ö –≤ –∫—É—á–µ
- **Rc** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ –¥–ª—è –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞
- **Arc** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞
- **RAII** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ —á–µ—Ä–µ–∑ Drop
- **Send** - —Ç–∏–ø –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- **Sync** - —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–∏–ø –º–æ–∂–Ω–æ —à–∞—Ä–∏—Ç—å –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- **move** —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏ - –ø–µ—Ä–µ–¥–∞—á–∞ –≤–ª–∞–¥–µ–Ω–∏—è –≤ –ø–æ—Ç–æ–∫
- **Arc + Mutex** - –∏–∑–º–µ–Ω—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!

---

# Rust: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

## –¢–µ–º–∞ 16: Mutex, Atomic

### Mutex<T> - –≤–∑–∞–∏–º–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

`Mutex` (mutual exclusion) –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–æ–ª—å–∫–æ **–æ–¥–∏–Ω –ø–æ—Ç–æ–∫** –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.

```rust
use std::sync::Mutex;

let m = Mutex::new(5);

{
    let mut num = m.lock().unwrap();
    *num = 6;
    // –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –∑–¥–µ—Å—å (RAII)
}

println!("m = {:?}", m); // Mutex { data: 6, poisoned: false, .. }
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã**:
- `lock()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Result<MutexGuard<T>>`
- `MutexGuard` - —ç—Ç–æ RAII –æ–±—ë—Ä—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏
- –ï—Å–ª–∏ –ø–æ—Ç–æ–∫ –∑–∞–ø–∞–Ω–∏–∫—É–µ—Ç, –¥–µ—Ä–∂–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, Mutex —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è "–æ—Ç—Ä–∞–≤–ª–µ–Ω–Ω—ã–º" (poisoned)

### Mutex –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–º –∫–æ–¥–µ

```rust
use std::sync::{Arc, Mutex};
use std::thread;

let counter = Arc::new(Mutex::new(0));
let mut handles = vec![];

for _ in 0..10 {
    let counter = Arc::clone(&counter);
    let handle = thread::spawn(move || {
        for _ in 0..1000 {
            let mut num = counter.lock().unwrap();
            *num += 1;
        }
    });
    handles.push(handle);
}

for handle in handles {
    handle.join().unwrap();
}

println!("–†–µ–∑—É–ª—å—Ç–∞—Ç: {}", *counter.lock().unwrap()); // 10000
```

**–ü–æ—á–µ–º—É Arc + Mutex?**
- `Arc` - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- `Mutex` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –í–º–µ—Å—Ç–µ –æ–Ω–∏ –¥–∞—é—Ç: shared mutable state

### Deadlock - –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞

```rust
use std::sync::{Arc, Mutex};
use std::thread;
use std::time::Duration;

let m1 = Arc::new(Mutex::new(0));
let m2 = Arc::new(Mutex::new(0));

let m1_clone = Arc::clone(&m1);
let m2_clone = Arc::clone(&m2);

// –ü–æ—Ç–æ–∫ 1: –±–ª–æ–∫–∏—Ä—É–µ—Ç m1, –∑–∞—Ç–µ–º m2
let t1 = thread::spawn(move || {
    let _guard1 = m1_clone.lock().unwrap();
    println!("T1: –∑–∞—Ö–≤–∞—Ç–∏–ª m1");
    thread::sleep(Duration::from_millis(10));
    
    println!("T1: –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å m2");
    let _guard2 = m2_clone.lock().unwrap(); // DEADLOCK!
    println!("T1: –∑–∞—Ö–≤–∞—Ç–∏–ª m2");
});

// –ü–æ—Ç–æ–∫ 2: –±–ª–æ–∫–∏—Ä—É–µ—Ç m2, –∑–∞—Ç–µ–º m1
let t2 = thread::spawn(move || {
    let _guard2 = m2.lock().unwrap();
    println!("T2: –∑–∞—Ö–≤–∞—Ç–∏–ª m2");
    thread::sleep(Duration::from_millis(10));
    
    println!("T2: –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å m1");
    let _guard1 = m1.lock().unwrap(); // DEADLOCK!
    println!("T2: –∑–∞—Ö–≤–∞—Ç–∏–ª m1");
});

// –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–Ω–µ—Ç –∑–¥–µ—Å—å
// t1.join().unwrap();
// t2.join().unwrap();
```

**–ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å deadlock**:
1. –í—Å–µ–≥–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –º—å—é—Ç–µ–∫—Å—ã –≤ **–æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ**
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `try_lock()` –≤–º–µ—Å—Ç–æ `lock()`
3. –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### RwLock - —á–∏—Ç–∞—Ç–µ–ª–∏ –∏ –ø–∏—Å–∞—Ç–µ–ª–∏

`RwLock` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–∏–±–æ **–º–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π**, –ª–∏–±–æ **–æ–¥–Ω–æ–≥–æ –ø–∏—Å–∞—Ç–µ–ª—è**.

```rust
use std::sync::RwLock;

let lock = RwLock::new(5);

// –ú–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ - OK
{
    let r1 = lock.read().unwrap();
    let r2 = lock.read().unwrap();
    println!("{} {}", *r1, *r2);
}

// –û–¥–∏–Ω –ø–∏—Å–∞—Ç–µ–ª—å
{
    let mut w = lock.write().unwrap();
    *w += 1;
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**:
- –ú–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è, –º–∞–ª–æ –∑–∞–ø–∏—Å–∏
- RwLock –º–µ–¥–ª–µ–Ω–Ω–µ–µ Mutex –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤

### Atomic —Ç–∏–ø—ã - lock-free —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫**, –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.

```rust
use std::sync::atomic::{AtomicUsize, Ordering};
use std::sync::Arc;
use std::thread;

let counter = Arc::new(AtomicUsize::new(0));
let mut handles = vec![];

for _ in 0..10 {
    let counter = Arc::clone(&counter);
    let handle = thread::spawn(move || {
        for _ in 0..1000 {
            counter.fetch_add(1, Ordering::SeqCst);
        }
    });
    handles.push(handle);
}

for handle in handles {
    handle.join().unwrap();
}

println!("–†–µ–∑—É–ª—å—Ç–∞—Ç: {}", counter.load(Ordering::SeqCst)); // 10000
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ —Ç–∏–ø—ã**:
- `AtomicBool`, `AtomicIsize`, `AtomicUsize`
- `AtomicI8`, `AtomicI16`, `AtomicI32`, `AtomicI64`
- `AtomicU8`, `AtomicU16`, `AtomicU32`, `AtomicU64`
- `AtomicPtr<T>`

### Memory Ordering - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

`Ordering` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–Ω—ã –≤ –¥—Ä—É–≥–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö:

```rust
use std::sync::atomic::Ordering;

// –û—Ç —Å–∞–º–æ–≥–æ —Å—Ç—Ä–æ–≥–æ–≥–æ –∫ —Å–∞–º–æ–º—É —Å–ª–∞–±–æ–º—É:

// SeqCst - Sequential Consistency (—Å–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π)
// –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤—Å–µ—Ö –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
counter.fetch_add(1, Ordering::SeqCst);

// Acquire - –¥–ª—è —á—Ç–µ–Ω–∏—è (load)
// Release - –¥–ª—è –∑–∞–ø–∏—Å–∏ (store)
// AcqRel - –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏–µ-–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è-–∑–∞–ø–∏—Å—å
let value = counter.load(Ordering::Acquire);
counter.store(10, Ordering::Release);

// Relaxed - –Ω–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π –ø–æ—Ä—è–¥–∫–∞ (—Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π)
counter.fetch_add(1, Ordering::Relaxed);
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∞–≤–∏–ª–æ**:
- –ù–∞—á–∏–Ω–∞–π—Ç–µ —Å `SeqCst` (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –¥–æ `Acquire/Release` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- `Relaxed` —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—á—ë—Ç—á–∏–∫–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á—Ç–æ?

| –ü—Ä–∏–º–∏—Ç–∏–≤ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
|----------|-------------------|-------------------|
| `Mutex<T>` | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, —Å–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –°—Ä–µ–¥–Ω—è—è |
| `RwLock<T>` | –ú–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π, –º–∞–ª–æ –ø–∏—Å–∞—Ç–µ–ª–µ–π | –°—Ä–µ–¥–Ω—è—è |
| `Atomic*` | –ü—Ä–æ—Å—Ç—ã–µ —Å—á—ë—Ç—á–∏–∫–∏, —Ñ–ª–∞–≥–∏ | –í—ã—Å–æ–∫–∞—è |

```rust
// –°—á—ë—Ç—á–∏–∫ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Atomic
let counter = AtomicUsize::new(0);
counter.fetch_add(1, Ordering::Relaxed);

// –°–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Mutex
let data = Mutex::new(HashMap::new());
data.lock().unwrap().insert("key", "value");

// –ú–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ RwLock
let cache = RwLock::new(HashMap::new());
let value = cache.read().unwrap().get("key");
```

---

## –¢–µ–º–∞ 17: Interior Mutability

### –ü—Ä–æ–±–ª–µ–º–∞: –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –∏ borrowing rules

–û–±—ã—á–Ω–æ –≤ Rust:
- –õ–∏–±–æ –æ–¥–Ω–∞ –∏–∑–º–µ–Ω—è–µ–º–∞—è —Å—Å—ã–ª–∫–∞ `&mut T`
- –õ–∏–±–æ –º–Ω–æ–≥–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã—Ö —Å—Å—ã–ª–æ–∫ `&T`

–ù–æ –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—É—é —Å—Å—ã–ª–∫—É. **Interior mutability** —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É.

### Cell<T> - –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –¥–ª—è Copy —Ç–∏–ø–æ–≤

`Cell` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ, –∏–º–µ—è —Ç–æ–ª—å–∫–æ `&Cell<T>`.

```rust
use std::cell::Cell;

struct Counter {
    count: Cell<i32>,
}

impl Counter {
    fn increment(&self) {  // &self, –Ω–µ &mut self!
        let current = self.count.get();
        self.count.set(current + 1);
    }
    
    fn get(&self) -> i32 {
        self.count.get()
    }
}

let counter = Counter { count: Cell::new(0) };
counter.increment();
counter.increment();
println!("{}", counter.get()); // 2
```

**–í–∞–∂–Ω–æ**:
- `Cell<T>` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å `Copy` —Ç–∏–ø–∞–º–∏
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ runtime - –≤—Å—ë –Ω–∞ —Å–æ–≤–µ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞
- –ù–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Sync` (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞)

### RefCell<T> - –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å —Å runtime –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏

`RefCell` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ç–∏–ø–∞–º–∏, –Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç borrowing rules –≤ **runtime**.

```rust
use std::cell::RefCell;

let data = RefCell::new(vec![1, 2, 3]);

// –ë–µ—Ä—ë–º –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—É—é —Å—Å—ã–ª–∫—É
{
    let r1 = data.borrow();
    let r2 = data.borrow();
    println!("{:?} {:?}", r1, r2); // OK: –º–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π
}

// –ë–µ—Ä—ë–º –∏–∑–º–µ–Ω—è–µ–º—É—é —Å—Å—ã–ª–∫—É
{
    let mut w = data.borrow_mut();
    w.push(4);
}

println!("{:?}", data.borrow()); // [1, 2, 3, 4]
```

**Runtime –ø–∞–Ω–∏–∫–∞**:

```rust
let data = RefCell::new(5);

let r = data.borrow();
// let w = data.borrow_mut(); // –ü–ê–ù–ò–ö–ê! —É–∂–µ –µ—Å—Ç—å —á–∏—Ç–∞—Ç–µ–ª—å

let mut w = data.borrow_mut();
// let r2 = data.borrow(); // –ü–ê–ù–ò–ö–ê! —É–∂–µ –µ—Å—Ç—å –ø–∏—Å–∞—Ç–µ–ª—å
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –¥–µ—Ä–µ–≤–æ —Å —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏

```rust
use std::cell::RefCell;
use std::rc::Rc;

struct Node {
    value: i32,
    children: RefCell<Vec<Rc<Node>>>,
}

let leaf = Rc::new(Node {
    value: 3,
    children: RefCell::new(vec![]),
});

let branch = Rc::new(Node {
    value: 5,
    children: RefCell::new(vec![]),
});

// –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–±—ë–Ω–∫–∞ —á–µ—Ä–µ–∑ &Rc (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—É—é —Å—Å—ã–ª–∫—É!)
branch.children.borrow_mut().push(Rc::clone(&leaf));

println!("Branch –∏–º–µ–µ—Ç {} –¥–µ—Ç–µ–π", branch.children.borrow().len());
```

### OnceCell –∏ LazyCell - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–¥–∏–Ω —Ä–∞–∑

```rust
use std::cell::OnceCell;

struct Config {
    database_url: OnceCell<String>,
}

impl Config {
    fn new() -> Self {
        Config {
            database_url: OnceCell::new(),
        }
    }
    
    fn get_db_url(&self) -> &str {
        self.database_url.get_or_init(|| {
            println!("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é DB URL...");
            "postgres://localhost".to_string()
        })
    }
}

let config = Config::new();
println!("{}", config.get_db_url()); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é DB URL...
println!("{}", config.get_db_url()); // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

### Interior Mutability + –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å

–î–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º `Mutex` –∏–ª–∏ `RwLock`:

```rust
use std::sync::{Arc, Mutex};

struct SharedCounter {
    count: Mutex<i32>,
}

impl SharedCounter {
    fn increment(&self) {  // &self!
        let mut num = self.count.lock().unwrap();
        *num += 1;
    }
}

let counter = Arc::new(SharedCounter {
    count: Mutex::new(0),
});

// –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤ –ø–æ—Ç–æ–∫–∏
let counter_clone = Arc::clone(&counter);
std::thread::spawn(move || {
    counter_clone.increment();
});
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ interior mutability

| –¢–∏–ø | –ü—Ä–æ–≤–µ—Ä–∫–∏ | –ü–æ—Ç–æ–∫–∏ | –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö |
|-----|----------|--------|-------------|
| `Cell<T>` | Compile-time | –ù–µ—Ç | Copy —Ç–æ–ª—å–∫–æ |
| `RefCell<T>` | Runtime | –ù–µ—Ç | –õ—é–±—ã–µ |
| `Mutex<T>` | Runtime | –î–∞ | –õ—é–±—ã–µ |
| `RwLock<T>` | Runtime | –î–∞ | –õ—é–±—ã–µ |
| `Atomic*` | Lock-free | –î–∞ | –ü—Ä–∏–º–∏—Ç–∏–≤—ã |

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è**: Interior mutability –æ–±–º–µ–Ω–∏–≤–∞–µ—Ç compile-time –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ runtime –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –±–æ–ª—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç–∏.

---

## –¢–µ–º–∞ 18: –ú–∞–∫—Ä–æ—Å—ã: –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ

### –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –º–∞–∫—Ä–æ—Å—ã?

–ú–∞–∫—Ä–æ—Å—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∫–æ–¥ **–Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏**. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è:
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –°–æ–∑–¥–∞–Ω–∏—è DSL (domain-specific languages)
- –ú–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã (macro_rules!)

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∏–¥ –º–∞–∫—Ä–æ—Å–æ–≤. –†–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ pattern matching –¥–ª—è –∫–æ–¥–∞.

```rust
// –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –º–∞–∫—Ä–æ—Å
macro_rules! say_hello {
    () => {
        println!("Hello!");
    };
}

say_hello!(); // Hello!
```

#### –ú–∞–∫—Ä–æ—Å—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

```rust
macro_rules! create_function {
    ($func_name:ident) => {
        fn $func_name() {
            println!("–í—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è {:?}", stringify!($func_name));
        }
    };
}

create_function!(foo);
create_function!(bar);

foo(); // –í—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è "foo"
bar(); // –í—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è "bar"
```

**–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è (designators)**:
- `ident` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π/—Ñ—É–Ω–∫—Ü–∏–∏)
- `expr` - –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
- `ty` - —Ç–∏–ø
- `pat` - –ø–∞—Ç—Ç–µ—Ä–Ω
- `stmt` - statement
- `block` - –±–ª–æ–∫ –∫–æ–¥–∞
- `item` - —ç–ª–µ–º–µ–Ω—Ç (struct, fn, etc.)
- `tt` - token tree (–ª—é–±–æ–π —Ç–æ–∫–µ–Ω)

#### –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –≤ –º–∞–∫—Ä–æ—Å–∞—Ö

```rust
macro_rules! vec_of_strings {
    ($($x:expr),*) => {
        {
            let mut temp_vec = Vec::new();
            $(
                temp_vec.push($x.to_string());
            )*
            temp_vec
        }
    };
}

let v = vec_of_strings!("hello", "world", "!");
println!("{:?}", v); // ["hello", "world", "!"]
```

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π**:
- `$(...)*` - –Ω–æ–ª—å –∏–ª–∏ –±–æ–ª–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
- `$(...)+` - –æ–¥–Ω–æ –∏–ª–∏ –±–æ–ª–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
- `$(...)?` - –Ω–æ–ª—å –∏–ª–∏ –æ–¥–Ω–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ

#### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: hashmap macro

```rust
macro_rules! hashmap {
    ($($key:expr => $value:expr),* $(,)?) => {
        {
            let mut map = std::collections::HashMap::new();
            $(
                map.insert($key, $value);
            )*
            map
        }
    };
}

let map = hashmap! {
    "name" => "Alice",
    "age" => "30",
};
```

### –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã

–ü—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã - —ç—Ç–æ **—Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç TokenStream –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç TokenStream**.

–¢—Ä–∏ –≤–∏–¥–∞:
1. **Derive macros** - `#[derive(MyTrait)]`
2. **Attribute macros** - `#[my_attribute]`
3. **Function-like macros** - `my_macro!(...)`

#### Derive –º–∞–∫—Ä–æ—Å—ã (—Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ)

```rust
use serde::{Serialize, Deserialize};

#[derive(Debug, Clone, Serialize, Deserialize)]
struct User {
    name: String,
    age: u32,
}

// –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç impl –¥–ª—è —ç—Ç–∏—Ö —Ç—Ä–µ–π—Ç–æ–≤
let user = User {
    name: "Alice".to_string(),
    age: 30,
};

println!("{:?}", user); // —Ä–∞–±–æ—Ç–∞–µ—Ç –±–ª–∞–≥–æ–¥–∞—Ä—è Debug
let json = serde_json::to_string(&user).unwrap(); // –±–ª–∞–≥–æ–¥–∞—Ä—è Serialize
```

#### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ derive –º–∞–∫—Ä–æ—Å–∞

```toml
# Cargo.toml
[lib]
proc-macro = true

[dependencies]
syn = "2.0"
quote = "1.0"
```

```rust
// lib.rs
use proc_macro::TokenStream;
use quote::quote;
use syn::{parse_macro_input, DeriveInput};

#[proc_macro_derive(HelloMacro)]
pub fn hello_macro_derive(input: TokenStream) -> TokenStream {
    let ast = parse_macro_input!(input as DeriveInput);
    let name = &ast.ident;
    
    let gen = quote! {
        impl HelloMacro for #name {
            fn hello_macro() {
                println!("Hello from {}!", stringify!(#name));
            }
        }
    };
    
    gen.into()
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```rust
trait HelloMacro {
    fn hello_macro();
}

#[derive(HelloMacro)]
struct Pancakes;

#[derive(HelloMacro)]
struct Waffles;

Pancakes::hello_macro(); // Hello from Pancakes!
Waffles::hello_macro();  // Hello from Waffles!
```

#### Attribute –º–∞–∫—Ä–æ—Å—ã

```rust
#[proc_macro_attribute]
pub fn route(attr: TokenStream, item: TokenStream) -> TokenStream {
    // attr - —ç—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞—Ç—Ä–∏–±—É—Ç–∞
    // item - —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–º–µ–Ω—ë–Ω –∞—Ç—Ä–∏–±—É—Ç
    
    let gen = quote! {
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–¥ –¥–ª—è —Ä–æ—É—Ç–∏–Ω–≥–∞
        #item
    };
    
    gen.into()
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–∫–∞–∫ –≤ web-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö):

```rust
#[route(GET, "/users")]
fn get_users() -> String {
    "User list".to_string()
}
```

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫–∏–µ –º–∞–∫—Ä–æ—Å—ã?

| –¢–∏–ø –º–∞–∫—Ä–æ—Å–∞ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ü—Ä–∏–º–µ—Ä—ã |
|-------------|-------------------|---------|
| `macro_rules!` | –ü—Ä–æ—Å—Ç–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞, DSL | `vec!`, `println!` |
| Derive | –ê–≤—Ç–æ–∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è —Ç—Ä–µ–π—Ç–æ–≤ | `#[derive(Debug)]` |
| Attribute | –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ | `#[test]`, `#[tokio::main]` |
| Function-like | –°–ª–æ–∂–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∫–æ–¥–∞ | SQL query builders |

### –û—Ç–ª–∞–¥–∫–∞ –º–∞–∫—Ä–æ—Å–æ–≤

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –≤–æ —á—Ç–æ —Ä–∞—Å–∫—Ä—ã–ª—Å—è –º–∞–∫—Ä–æ—Å
cargo expand

# –ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ–¥—É–ª—è
cargo expand module_name
```

---

## –¢–µ–º–∞ 19: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å. Event Loop. async/await

### –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å?

**–ü—Ä–æ–±–ª–µ–º–∞**: –±–ª–æ–∫–∏—Ä—É—é—â–∏–π I/O —Ç—Ä–∞—Ç–∏—Ç –≤—Ä–µ–º—è –≤–ø—É—Å—Ç—É—é

```rust
// –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ - –ø–æ—Ç–æ–∫ –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç –≤–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
let response1 = fetch_url("http://api1.com"); // –∂–¥—ë–º 100ms
let response2 = fetch_url("http://api2.com"); // –∂–¥—ë–º 100ms
// –û–±—â–µ–µ –≤—Ä–µ–º—è: 200ms
```

**–†–µ—à–µ–Ω–∏–µ**: async/await –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å –¥—Ä—É–≥—É—é —Ä–∞–±–æ—Ç—É –ø–æ–∫–∞ –∂–¥—ë–º I/O

```rust
// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ - –∑–∞–ø—É—Å–∫–∞–µ–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
let future1 = fetch_url("http://api1.com");
let future2 = fetch_url("http://api2.com");
let (response1, response2) = tokio::join!(future1, future2);
// –û–±—â–µ–µ –≤—Ä–µ–º—è: ~100ms
```

### Future - –æ—Å–Ω–æ–≤–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏

`Future` - —ç—Ç–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ **–º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –≤ –±—É–¥—É—â–µ–º**.

```rust
use std::future::Future;

// –£–ø—Ä–æ—â—ë–Ω–Ω–æ, Future –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
trait SimpleFuture {
    type Output;
    
    fn poll(&mut self) -> Poll<Self::Output>;
}

enum Poll<T> {
    Ready(T),      // —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–æ—Ç–æ–≤
    Pending,       // –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤, –æ–ø—Ä–æ—Å–∏—Ç–µ –ø–æ–∑–∂–µ
}
```

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è**: Future –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç, –ø–æ–∫–∞ –µ–≥–æ –Ω–µ –Ω–∞—á–Ω—É—Ç **–æ–ø—Ä–∞—à–∏–≤–∞—Ç—å** (poll).

### async/await —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```rust
// async —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç impl Future
async fn fetch_data() -> String {
    // –°–∏–º—É–ª–∏—Ä—É–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é
    tokio::time::sleep(tokio::time::Duration::from_secs(1)).await;
    "Data".to_string()
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
#[tokio::main]
async fn main() {
    let data = fetch_data().await;
    println!("{}", data);
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º**:
1. `async fn` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é, –≤–æ–∑–≤—Ä–∞—â–∞—é—â—É—é `impl Future`
2. `.await` –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç Future –∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω –Ω–µ –≥–æ—Ç–æ–≤
3. Executor –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –æ–ø—Ä–æ—Å, –∫–æ–≥–¥–∞ Future –º–æ–∂–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—Ä–æ–≤–∞—Ç—å

### Event Loop - —Å–µ—Ä–¥—Ü–µ async runtime

Event Loop - —ç—Ç–æ **–æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã–π —Ü–∏–∫–ª**, –∫–æ—Ç–æ—Ä—ã–π:
1. –û–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Future
2. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ
3. –ó–∞—Å—ã–ø–∞–µ—Ç, –µ—Å–ª–∏ –¥–µ–ª–∞—Ç—å –Ω–µ—á–µ–≥–æ

```rust
// –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å Event Loop
loop {
    for future in futures {
        match future.poll() {
            Poll::Ready(value) => {
                // Future –∑–∞–≤–µ—Ä—à—ë–Ω, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            }
            Poll::Pending => {
                // Future –Ω–µ –≥–æ—Ç–æ–≤, –æ–ø—Ä–æ—Å–∏–º –ø–æ–∑–∂–µ
            }
        }
    }
    
    // –ñ–¥—ë–º —Å–æ–±—ã—Ç–∏–π –æ—Ç –û–° (–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–∫–µ—Ç–µ, —Ç–∞–π–º–µ—Ä –∏ —Ç.–¥.)
    wait_for_events();
}
```

### Tokio - –ø–æ–ø—É–ª—è—Ä–Ω—ã–π async runtime

```rust
use tokio::time::{sleep, Duration};

#[tokio::main]
async fn main() {
    println!("–°—Ç–∞—Ä—Ç");
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º 3 –∑–∞–¥–∞—á–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ
    let task1 = tokio::spawn(async {
        sleep(Duration::from_secs(2)).await;
        println!("–ó–∞–¥–∞—á–∞ 1 –∑–∞–≤–µ—Ä—à–µ–Ω–∞");
    });
    
    let task2 = tokio::spawn(async {
        sleep(Duration::from_secs(1)).await;
        println!("–ó–∞–¥–∞—á–∞ 2 –∑–∞–≤–µ—Ä—à–µ–Ω–∞");
    });
    
    let task3 = tokio::spawn(async {
        sleep(Duration::from_secs(3)).await;
        println!("–ó–∞–¥–∞—á–∞ 3 –∑–∞–≤–µ—Ä—à–µ–Ω–∞");
    });
    
    // –ñ–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á
    let _ = tokio::join!(task1, task2, task3);
    
    println!("–í—Å–µ –∑–∞–¥–∞—á–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã");
}

// –í—ã–≤–æ–¥:
// –°—Ç–∞—Ä—Ç
// –ó–∞–¥–∞—á–∞ 2 –∑–∞–≤–µ—Ä—à–µ–Ω–∞  (—á–µ—Ä–µ–∑ 1 —Å–µ–∫)
// –ó–∞–¥–∞—á–∞ 1 –∑–∞–≤–µ—Ä—à–µ–Ω–∞  (—á–µ—Ä–µ–∑ 2 —Å–µ–∫)
// –ó–∞–¥–∞—á–∞ 3 –∑–∞–≤–µ—Ä—à–µ–Ω–∞  (—á–µ—Ä–µ–∑ 3 —Å–µ–∫)
// –í—Å–µ –∑–∞–¥–∞—á–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã
```

### –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å vs –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º

**–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å** (concurrency) - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏:
```rust
#[tokio::main]
async fn main() {
    // –û–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –Ω–∞ –ø–æ—Ç–æ–∫, –Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ
    let (r1, r2) = tokio::join!(
        async { sleep(Duration::from_secs(1)).await; 1 },
        async { sleep(Duration::from_secs(1)).await; 2 },
    );
}
```

**–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º** (parallelism) - –Ω–∞—Å—Ç–æ—è—â–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:
```rust
#[tokio::main]
async fn main() {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è CPU-bound —Ä–∞–±–æ—Ç—ã
    let handle1 = tokio::task::spawn_blocking(|| {
        // –¢—è–∂—ë–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
        expensive_calculation()
    });
    
    let handle2 = tokio::task::spawn_blocking(|| {
        expensive_calculation()
    });
    
    let (r1, r2) = tokio::join!(handle1, handle2);
}
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã

```rust
use reqwest;
use tokio;

#[tokio::main]
async fn main() {
    let urls = vec![
        "https://api.github.com/users/rust-lang",
        "https://api.github.com/users/tokio-rs",
        "https://api.github.com/users/serde-rs",
    ];
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ
    let futures: Vec<_> = urls
        .into_iter()
        .map(|url| fetch_url(url))
        .collect();
    
    // –ñ–¥—ë–º –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    let results = futures::future::join_all(futures).await;
    
    for result in results {
        match result {
            Ok(body) => println!("–ü–æ–ª—É—á–µ–Ω–æ {} –±–∞–π—Ç", body.len()),
            Err(e) => eprintln!("–û—à–∏–±–∫–∞: {}", e),
        }
    }
}

async fn fetch_url(url: &str) -> Result<String, reqwest::Error> {
    let response = reqwest::get(url).await?;
    let body = response.text().await?;
    Ok(body)
}
```

### Select - –∂–¥—ë–º –ø–µ—Ä–≤—ã–π –∑–∞–≤–µ—Ä—à–∏–≤—à–∏–π—Å—è Future

```rust
use tokio::time::{sleep, Duration};

#[tokio::main]
async fn main() {
    tokio::select! {
        _ = sleep(Duration::from_secs(1)) => {
            println!("–¢–∞–π–º–∞—É—Ç 1 —Å–µ–∫");
        }
        _ = sleep(Duration::from_secs(5)) => {
            println!("–¢–∞–π–º–∞—É—Ç 5 —Å–µ–∫");
        }
    }
    // –í—ã–≤–µ–¥–µ—Ç "–¢–∞–π–º–∞—É—Ç 1 —Å–µ–∫" –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è
}
```

### –ö–∞–Ω–∞–ª—ã –¥–ª—è async –∫–æ–¥–∞

```rust
use tokio::sync::mpsc;

#[tokio::main]
async fn main() {
    let (tx, mut rx) = mpsc::channel(32);
    
    // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
    tokio::spawn(async move {
        for i in 0..10 {
            tx.send(i).await.unwrap();
        }
    });
    
    // –ü–æ–ª—É—á–∞—Ç–µ–ª—å
    while let Some(value) = rx.recv().await {
        println!("–ü–æ–ª—É—á–µ–Ω–æ: {}", value);
    }
}
```

### Async –≤ —Ç—Ä–µ–π—Ç–∞—Ö (–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ)

```rust
// –ü–æ–∫–∞ –Ω—É–∂–µ–Ω –∫—Ä–µ–π—Ç async-trait
use async_trait::async_trait;

#[async_trait]
trait Database {
    async fn fetch(&self, id: u64) -> String;
}

struct PostgresDb;

#[async_trait]
impl Database for PostgresDb {
    async fn fetch(&self, id: u64) -> String {
        // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ –ë–î
        format!("User {}", id)
    }
}
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```rust
// 1. –û–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã–π runtime (–¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)
#[tokio::main(flavor = "current_thread")]
async fn main() {
    // –í—Å—ë –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ
}

// 2. –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π runtime (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
#[tokio::main]  // –∏–ª–∏ #[tokio::main(flavor = "multi_thread")]
async fn main() {
    // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤
}

// 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—É–ª–∞ –ø–æ—Ç–æ–∫–æ–≤
#[tokio::main(worker_threads = 4)]
async fn main() {
    // –†–æ–≤–Ω–æ 4 —Ä–∞–±–æ—á–∏—Ö –ø–æ—Ç–æ–∫–∞
}
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–ª–∏—á–∏—è: sync vs async

| –ê—Å–ø–µ–∫—Ç | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π |
|--------|-----------|-------------|
| –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | `std::sync::Mutex` | `tokio::sync::Mutex` |
| –°–æ–Ω | `std::thread::sleep` | `tokio::time::sleep` |
| –ö–∞–Ω–∞–ª—ã | `std::sync::mpsc` | `tokio::sync::mpsc` |
| –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ | `std::fs::read` | `tokio::fs::read` |

**–ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ sync –ø—Ä–∏–º–∏—Ç–∏–≤—ã –≤ async –∫–æ–¥–µ** - —ç—Ç–æ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å event loop!

```rust
// ‚ùå –ü–õ–û–•–û - –±–ª–æ–∫–∏—Ä—É–µ—Ç event loop
#[tokio::main]
async fn main() {
    std::thread::sleep(Duration::from_secs(1)); // –í–µ—Å—å runtime –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç!
}

// ‚úÖ –•–û–†–û–®–û - –æ—Ç–¥–∞—ë—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ event loop
#[tokio::main]
async fn main() {
    tokio::time::sleep(Duration::from_secs(1)).await; // –î—Ä—É–≥–∏–µ –∑–∞–¥–∞—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
}
```

---
# –¢–µ–º–∞ 1: –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏

## üéØ –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Ç–µ–º—ã

–í —ç—Ç–æ–π —Ç–µ–º–µ –º—ã —Ä–∞–∑–±–µ—Ä—ë–º —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã Rust, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç –µ–≥–æ **–±–µ–∑–æ–ø–∞—Å–Ω—ã–º** –∏ **–±—ã—Å—Ç—Ä—ã–º** –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

- **Immutability by default** ‚Äî –ø–æ—á–µ–º—É –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å —ç—Ç–æ –Ω–µ –±–∞–≥, –∞ —Ñ–∏—á–∞
- **Ownership –∏ borrowing** ‚Äî –±–∞–∑–æ–≤—ã–µ –∏–¥–µ–∏ (—É–≥–ª—É–±–∏–º—Å—è –ø–æ–∑–∂–µ)
- **Type safety** ‚Äî –∫–∞–∫ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –æ—à–∏–±–æ–∫ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- **Zero-cost abstractions** ‚Äî –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –±–µ–∑ overhead'–∞

---

## 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å

### 1.1 Immutable –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```rust
let x = 5;
// x = 6; // ‚ùå –û–®–ò–ë–ö–ê! x –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è
```

**–ü–æ—á–µ–º—É —Ç–∞–∫?**

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —è–∑—ã–∫–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è–µ–º—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. Rust –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —ç—Ç—É –ª–æ–≥–∏–∫—É:

- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ª–µ–≥—á–µ —Ä–∞—Å—Å—É–∂–¥–∞—Ç—å –æ –∫–æ–¥–µ, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è
- **Concurrency**: –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —à–∞—Ä–∏—Ç—å –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –º–æ–∂–µ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–µ–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### 1.2 –Ø–≤–Ω–∞—è –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å

```rust
let mut y = 5;
y = 6; // ‚úÖ OK
y = y + 1; // ‚úÖ OK
```

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è**: –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–æ–ª–∂–Ω–∞ –º–µ–Ω—è—Ç—å—Å—è ‚Äî —Ç—ã —ç—Ç–æ —è–≤–Ω–æ –¥–µ–∫–ª–∞—Ä–∏—Ä—É–µ—à—å —á–µ—Ä–µ–∑ `mut`. –≠—Ç–æ —Å–∏–≥–Ω–∞–ª —á–∏—Ç–∞—Ç–µ–ª—é –∫–æ–¥–∞: "–≠—Ç–∞ —à—Ç—É–∫–∞ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è, –±—É–¥—å –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω!"

### 1.3 Shadowing (–∑–∞—Ç–µ–Ω–µ–Ω–∏–µ)

```rust
let x = 5;
let x = x + 1; // –°–æ–∑–¥–∞—ë–º –ù–û–í–£–Æ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å —Ç–µ–º –∂–µ –∏–º–µ–Ω–µ–º
let x = x * 2;
println!("{}", x); // 12
```

**Shadowing vs Mutability:**

```rust
// Shadowing –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å –¢–ò–ü
let spaces = "   ";
let spaces = spaces.len(); // str -> usize ‚úÖ

// Mut –ù–ï –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å —Ç–∏–ø
let mut spaces = "   ";
// spaces = spaces.len(); // ‚ùå –û–®–ò–ë–ö–ê: –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Ç–∏–ø—ã
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å shadowing:**
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å–º—ã—Å–ª–∞ –∏–º–µ–Ω–∏
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –±–µ–∑ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è namespace

---

## 2. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

### 2.1 –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è

Rust ‚Äî **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π** —è–∑—ã–∫. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å —Ç–∏–ø—ã –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

```rust
let x = 5; // –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—ã–≤–æ–¥–∏—Ç —Ç–∏–ø: i32
let y: u32 = 10; // –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞
```

**Type inference** –≤ Rust –æ—á–µ–Ω—å –º–æ—â–Ω—ã–π, –Ω–æ –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ —è–≤–Ω–æ—Å—Ç—å:

```rust
let guess: u32 = "42".parse().expect("Not a number!");
// –ë–µ–∑ `: u32` –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –∑–Ω–∞–µ—Ç, –≤ –∫–∞–∫–æ–π —Ç–∏–ø –ø–∞—Ä—Å–∏—Ç—å
```

### 2.2 Scalar Types (—Å–∫–∞–ª—è—Ä–Ω—ã–µ —Ç–∏–ø—ã)

#### –¶–µ–ª—ã–µ —á–∏—Å–ª–∞

| –†–∞–∑–º–µ—Ä | –ó–Ω–∞–∫–æ–≤—ã–µ | –ë–µ–∑–∑–Ω–∞–∫–æ–≤—ã–µ |
|--------|----------|-------------|
| 8-bit  | i8       | u8          |
| 16-bit | i16      | u16         |
| 32-bit | i32      | u32         |
| 64-bit | i64      | u64         |
| 128-bit| i128     | u128        |
| arch   | isize    | usize       |

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

1. **–î–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ç–∏–ø** ‚Äî `i32` (–æ–ø—Ç–∏–º–∞–ª–µ–Ω –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö)
2. **isize/usize** ‚Äî –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (32 –∏–ª–∏ 64 –±–∏—Ç–∞). –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–π
3. **–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ**:
   - –í debug-—Ä–µ–∂–∏–º–µ ‚Üí **panic**
   - –í release-—Ä–µ–∂–∏–º–µ ‚Üí **wrapping** (–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ –º–æ–¥—É–ª—é)

```rust
// –Ø–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ–º
let a: u8 = 255;
let b = a.wrapping_add(1); // 0
let c = a.checked_add(1);   // None (Option<u8>)
let d = a.saturating_add(1); // 255 (–º–∞–∫—Å–∏–º—É–º)
```

**–õ–∏—Ç–µ—Ä–∞–ª—ã —á–∏—Å–µ–ª:**

```rust
let decimal = 98_222;      // _ –¥–ª—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
let hex = 0xff;
let octal = 0o77;
let binary = 0b1111_0000;
let byte = b'A';           // —Ç–æ–ª—å–∫–æ u8
```

#### –ß–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π

```rust
let x = 2.0;      // f64 (default)
let y: f32 = 3.0; // f32
```

**f64 vs f32:**
- `f64` ‚Äî –¥–≤–æ–π–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –¥–µ—Ñ–æ–ª—Ç (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ CPU –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å —Ç–æ–π –∂–µ —Å–∫–æ—Ä–æ—Å—Ç—å—é)
- `f32` ‚Äî –æ–¥–∏–Ω–∞—Ä–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ –≤–∞–∂–µ–Ω —Ä–∞–∑–º–µ—Ä –∏–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

**–í–∞–∂–Ω–æ**: floating-point –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –Ω–µ—Ç–æ—á–Ω–∞! –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–π `f32/f64` –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –Ω–∞–ø—Ä—è–º—É—é.

#### –ë—É–ª–µ–≤—ã –∑–Ω–∞—á–µ–Ω–∏—è

```rust
let t = true;
let f: bool = false;
```

–†–∞–∑–º–µ—Ä: **1 –±–∞–π—Ç** (–Ω–µ 1 –±–∏—Ç!), –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏.

#### –°–∏–º–≤–æ–ª—ã

```rust
let c = 'z';
let z = '‚Ñ§';
let heart = '‚ù§';
```

**–í–∞–∂–Ω–æ:**
- `char` –≤ Rust ‚Äî —ç—Ç–æ **4 –±–∞–π—Ç–∞** (Unicode Scalar Value)
- –ù–µ –ø—É—Ç–∞—Ç—å —Å –±–∞–π—Ç–æ–º (`u8`) –∏–ª–∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–º –ª–∏—Ç–µ—Ä–∞–ª–æ–º (`&str`)
- –ú–æ–∂–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –ª—é–±–æ–π Unicode —Å–∏–º–≤–æ–ª

### 2.3 Compound Types (—Å–æ—Å—Ç–∞–≤–Ω—ã–µ —Ç–∏–ø—ã)

#### –ö–æ—Ä—Ç–µ–∂–∏ (Tuples)

```rust
let tup: (i32, f64, u8) = (500, 6.4, 1);

// –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è
let (x, y, z) = tup;

// –î–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É
let five_hundred = tup.0;
let six_point_four = tup.1;
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª–∏–Ω–∞
- –ì–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã (—Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
- Unit type `()` ‚Äî –ø—É—Å—Ç–æ–π –∫–æ—Ä—Ç–µ–∂ (—Ç–∏–ø —Ñ—É–Ω–∫—Ü–∏–π, –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–µ)

#### –ú–∞—Å—Å–∏–≤—ã (Arrays)

```rust
let a = [1, 2, 3, 4, 5];
let months = ["January", "February", "March", /* ... */];

// –Ø–≤–Ω–∞—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è —Ç–∏–ø–∞
let a: [i32; 5] = [1, 2, 3, 4, 5];
//      ^^^  ^
//      —Ç–∏–ø  –¥–ª–∏–Ω–∞

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
let a = [3; 5]; // [3, 3, 3, 3, 3]
```

**–ú–∞—Å—Å–∏–≤—ã vs –í–µ–∫—Ç–æ—Ä—ã:**

| –ú–∞—Å—Å–∏–≤—ã (`[T; N]`) | –í–µ–∫—Ç–æ—Ä—ã (`Vec<T>`) |
|--------------------|--------------------|
| –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä |
| –°—Ç–µ–∫ (–æ–±—ã—á–Ω–æ) | –ö—É—á–∞ |
| –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø | –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø + —Ä–æ—Å—Ç |
| –ò–∑–≤–µ—Å—Ç–µ–Ω –Ω–∞ compile-time | –ò–∑–≤–µ—Å—Ç–µ–Ω –Ω–∞ runtime |

**–î–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º:**

```rust
let a = [1, 2, 3, 4, 5];
let first = a[0];
let second = a[1];

// –í—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã
// let invalid = a[10]; // ‚ùå RUNTIME PANIC (–Ω–µ compile error!)
```

**–í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø—Ä–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
Rust –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞ –≤ **runtime**. –≠—Ç–æ overhead, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç memory safety.

---

## 3. –§—É–Ω–∫—Ü–∏–∏

### 3.1 –û–±—ä—è–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

```rust
fn main() {
    println!("Hello, world!");
    another_function(5);
}

fn another_function(x: i32) {
    println!("The value of x is: {}", x);
}
```

**–°–æ–≥–ª–∞—à–µ–Ω–∏—è –æ–± –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏:**
- `snake_case` –¥–ª—è –∏–º—ë–Ω —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—ã–¥–∞—Å—Ç **warning**, –µ—Å–ª–∏ –Ω–∞—Ä—É—à–∞–µ—à—å –∫–æ–Ω–≤–µ–Ω—Ü–∏—é

### 3.2 –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π

```rust
fn print_labeled_measurement(value: i32, unit_label: char) {
    println!("The measurement is: {}{}", value, unit_label);
}
```

**–ö–ª—é—á–µ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** —Ç–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** —É–∫–∞–∑—ã–≤–∞—Ç—å. Type inference –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Å–∏–≥–Ω–∞—Ç—É—Ä —Ñ—É–Ω–∫—Ü–∏–π.

### 3.3 Statements vs Expressions

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–ê–Ø –ö–û–ù–¶–ï–ü–¶–ò–Ø –í RUST!**

#### Statements (—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)
–í—ã–ø–æ–ª–Ω—è—é—Ç –¥–µ–π—Å—Ç–≤–∏–µ, **–ù–ï –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ**.

```rust
let y = 6; // —ç—Ç–æ statement
```

#### Expressions (–≤—ã—Ä–∞–∂–µ–Ω–∏—è)
–í—ã—á–∏—Å–ª—è—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, **–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç**.

```rust
5 + 6  // expression, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 11

{
    let x = 3;
    x + 1  // ‚ùó –ë–ï–ó —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π! –≠—Ç–æ expression
}
```

**–ö–ª—é—á–µ–≤–∞—è —Ä–∞–∑–Ω–∏—Ü–∞:**

```rust
let y = {
    let x = 3;
    x + 1  // expression ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 4
};
// y == 4

let z = {
    let x = 3;
    x + 1; // statement (–∏–∑-–∑–∞ ;) ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ()
};
// z == () (unit type)
```

### 3.4 –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

```rust
fn five() -> i32 {
    5  // –ù–µ—è–≤–Ω—ã–π return (—ç—Ç–æ expression!)
}

fn plus_one(x: i32) -> i32 {
    x + 1  // –ë–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π!
}

// –¢–æ –∂–µ —Å–∞–º–æ–µ —Å —è–≤–Ω—ã–º return
fn plus_one_explicit(x: i32) -> i32 {
    return x + 1;
}
```

**–ß–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞ –Ω–æ–≤–∏—á–∫–æ–≤:**

```rust
fn plus_one(x: i32) -> i32 {
    x + 1;  // ‚ùå –° —Ç–æ—á–∫–æ–π –∑–∞–ø—è—Ç–æ–π —ç—Ç–æ statement
            //    –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç (), –∞ –Ω–µ i32
}
// error: mismatched types
```

**Early return:**

```rust
fn check_positive(x: i32) -> bool {
    if x < 0 {
        return false;  // Early return
    }
    true  // –ü–æ—Å–ª–µ–¥–Ω–µ–µ expression
}
```

### 3.5 Diverging functions

–§—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è**:

```rust
fn infinite_loop() -> ! {
    loop {
        println!("Forever!");
    }
}

fn panic_function() -> ! {
    panic!("This function never returns normally");
}
```

–¢–∏–ø `!` (never type) ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–∏–ø –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.

---

## 4. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

```rust
// –û–±—ã—á–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π

/* –ë–ª–æ—á–Ω—ã–π
   –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π */

/// Documentation comment –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
/// –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Markdown!
fn documented_function() {}

//! Documentation comment –¥–ª—è —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–æ–¥—É–ª—è
```

**Best practice**: –∏—Å–ø–æ–ª—å–∑—É–π `//` –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, `///` –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API.

---

## 5. –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å)

### 5.1 if Expressions

```rust
let number = 7;

if number < 5 {
    println!("condition was true");
} else {
    println!("condition was false");
}
```

**–í–∞–∂–Ω–æ:** —É—Å–ª–æ–≤–∏–µ **–æ–±—è–∑–∞–Ω–æ** –±—ã—Ç—å `bool`. –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫ boolean!

```rust
let number = 3;
// if number { ... } // ‚ùå –û–®–ò–ë–ö–ê
if number != 0 { /* ... */ } // ‚úÖ OK
```

**if –∫–∞–∫ expression:**

```rust
let condition = true;
let number = if condition { 5 } else { 6 };
// number == 5
```

–¢–∏–ø—ã –≤ –æ–±–µ–∏—Ö –≤–µ—Ç–∫–∞—Ö **–¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å**:

```rust
// let number = if condition { 5 } else { "six" }; // ‚ùå –û–®–ò–ë–ö–ê
```

---

## üéì –§–∏–ª–æ—Å–æ—Ñ–∏—è –∏ –≥–ª—É–±–∏–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### Ownership (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ)

–•–æ—Ç—è ownership –º—ã –±—É–¥–µ–º –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –ø–æ–∑–∂–µ, –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –±–∞–∑–æ–≤—É—é –∏–¥–µ—é —É–∂–µ —Å–µ–π—á–∞—Å:

**–ö–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ Rust –∏–º–µ–µ—Ç "–≤–ª–∞–¥–µ–ª—å—Ü–∞"** ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –∑–∞ –Ω–µ–≥–æ –æ—Ç–≤–µ—á–∞–µ—Ç.

```rust
let s1 = String::from("hello");
let s2 = s1;  // s1 –±–æ–ª—å—à–µ –Ω–µ –≤–∞–ª–∏–¥–Ω–∞!
// println!("{}", s1); // ‚ùå –û–®–ò–ë–ö–ê
```

–î–ª—è –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤ (i32, bool, char) —ç—Ç–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è ‚Äî –æ–Ω–∏ **–∫–æ–ø–∏—Ä—É—é—Ç—Å—è**:

```rust
let x = 5;
let y = x;  // x –≤—Å—ë –µ—â—ë –≤–∞–ª–∏–¥–Ω–∞
println!("{} {}", x, y); // ‚úÖ OK
```

**–ü–æ—á–µ–º—É?** –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ —Ç–∏–ø—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç —Ç—Ä–µ–π—Ç `Copy` –∏ –ª–µ–∂–∞—Ç –Ω–∞ —Å—Ç–µ–∫–µ. –î–µ—à–µ–≤–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å.

### Zero-cost abstractions

–ú–Ω–æ–≥–∏–µ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Rust (iterators, closures) –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –≤ —Ç–æ—Ç –∂–µ –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥, —á—Ç–æ –∏ —Ä—É—á–Ω—ã–µ —Ü–∏–∫–ª—ã.

```rust
// –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ
let sum: i32 = (1..=10).sum();

// –ö–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ —Ç–æ—Ç –∂–µ –∫–æ–¥, —á—Ç–æ –∏:
let mut sum = 0;
for i in 1..=10 {
    sum += i;
}
```

**–ù–µ—Ç runtime overhead** ‚Äî —ç—Ç–æ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è Rust.

### Memory safety –±–µ–∑ garbage collector

Rust –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç memory safety —á–µ—Ä–µ–∑:
1. **Ownership system** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
2. **Borrow checker** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫ –Ω–∞ compile-time
3. **Lifetime annotations** ‚Äî —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ (–∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ)

–í—Å—ë —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç **–±–µ–∑ runtime overhead** GC.

---

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∏–¥–∏–æ–º—ã

### 1. –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π immutable –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```rust
// ‚ùå –ò–∑–±–µ–≥–∞–π
let mut x = calculate_value();
// ... 100 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ ...
x = x + 1;

// ‚úÖ –õ—É—á—à–µ
let x = calculate_value();
// ... 100 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ ...
let x = x + 1; // shadowing
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π type inference —Ä–∞–∑—É–º–Ω–æ

```rust
// ‚úÖ –û—á–µ–≤–∏–¥–Ω—ã–µ —Å–ª—É—á–∞–∏
let x = 5;
let name = "Alice";

// ‚úÖ –ù–µ–æ—á–µ–≤–∏–¥–Ω—ã–µ —Ç–∏–ø—ã ‚Äî –∞–Ω–Ω–æ—Ç–∏—Ä—É–π
let users: Vec<User> = fetch_users();
let result: Result<String, Error> = parse_data();
```

### 3. Expression-oriented —Å—Ç–∏–ª—å

```rust
// ‚ùå Statement-oriented (–∫–∞–∫ –≤ C/Java)
let mut result;
if condition {
    result = 5;
} else {
    result = 6;
}

// ‚úÖ Expression-oriented (idiomatic Rust)
let result = if condition { 5 } else { 6 };
```

### 4. –ò–∑–±–µ–≥–∞–π –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —á–∏—Å–µ–ª

```rust
// ‚ùå
if age > 18 { /* ... */ }

// ‚úÖ
const ADULT_AGE: u8 = 18;
if age > ADULT_AGE { /* ... */ }
```

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å

### 1. –ó–∞–±—ã–ª `mut`

```rust
let x = 5;
x = 6; // ‚ùå cannot assign twice to immutable variable
```

**–†–µ—à–µ–Ω–∏–µ:** –¥–æ–±–∞–≤—å `mut` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π shadowing.

### 2. –¢–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π –≤ return expression

```rust
fn add(a: i32, b: i32) -> i32 {
    a + b;  // ‚ùå –ø–æ–º–æ–≥ –±—ã —É–¥–∞–ª–∏—Ç—å ;
}
```

### 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ f64 –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ

```rust
let x = 0.1 + 0.2;
if x == 0.3 { /* ... */ } // ‚ùå –û–ø–∞—Å–Ω–æ –∏–∑-–∑–∞ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏ floating-point
```

**–†–µ—à–µ–Ω–∏–µ:** –∏—Å–ø–æ–ª—å–∑—É–π epsilon-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ:

```rust
fn approx_equal(a: f64, b: f64, epsilon: f64) -> bool {
    (a - b).abs() < epsilon
}
```

### 4. –í—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞

```rust
let a = [1, 2, 3];
let idx = 10;
let x = a[idx]; // ‚ùå RUNTIME PANIC
```

**–†–µ—à–µ–Ω–∏–µ:** –∏—Å–ø–æ–ª—å–∑—É–π `.get()` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:

```rust
match a.get(idx) {
    Some(value) => println!("Value: {}", value),
    None => println!("Index out of bounds"),
}
```

---

## üìö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ —è–∑—ã–∫–∞–º–∏

### Python vs Rust

```python
# Python
x = 5
x = "hello"  # OK, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
```

```rust
// Rust
let x = 5;
// let x = "hello"; // ‚ùå –û–®–ò–ë–ö–ê –±–µ–∑ shadowing

let x = 5;
let x = "hello"; // ‚úÖ OK —Å shadowing (–Ω–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)
```

### C/C++ vs Rust

```c
// C
int x = 5;
x = 6; // OK, mutable by default

int arr[3] = {1, 2, 3};
int val = arr[10]; // Undefined behavior! üíÄ
```

```rust
// Rust
let x = 5;
// x = 6; // ‚ùå –û–®–ò–ë–ö–ê, immutable by default

let mut x = 5;
x = 6; // ‚úÖ OK

let arr = [1, 2, 3];
// let val = arr[10]; // üí• PANIC, –Ω–æ –Ω–µ UB
```

### Go vs Rust

```go
// Go
x := 5  // —Ç–∏–ø –≤—ã–≤–æ–¥–∏—Ç—Å—è
var y int = 10 // —è–≤–Ω—ã–π —Ç–∏–ø
```

```rust
// Rust
let x = 5;  // —Ç–∏–ø –≤—ã–≤–æ–¥–∏—Ç—Å—è
let y: i32 = 10; // —è–≤–Ω—ã–π —Ç–∏–ø
```

–û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞: Go ‚Äî garbage collected, Rust ‚Äî ownership-based memory management.

---

## üß† –ú–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞–∫ "boxes" —Å –º–µ—Ç–∫–∞–º–∏

```rust
let x = 5;
```

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —ç—Ç–æ –∫–∞–∫:
- **Box** (–º–µ—Å—Ç–æ –≤ –ø–∞–º—è—Ç–∏) —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `5`
- **Label** `x` –ø—Ä–∏–∫–ª–µ–µ–Ω–∞ –∫ —ç—Ç–æ–º—É box
- `let x = 10;` (shadowing) ‚Äî **–Ω–æ–≤–∞—è** –∫–æ—Ä–æ–±–∫–∞ —Å —Ç–æ–π –∂–µ –º–µ—Ç–∫–æ–π

### 2. –§—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ —á—ë—Ä–Ω—ã–µ —è—â–∏–∫–∏ —Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º

```rust
fn add(a: i32, b: i32) -> i32 { /* ... */ }
```

- **–í—Ö–æ–¥:** –¥–≤–∞ `i32`
- **–í—ã—Ö–æ–¥:** –æ–¥–∏–Ω `i32`
- **–ö–æ–Ω—Ç—Ä–∞–∫—Ç** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º

### 3. –¢–∏–ø—ã –∫–∞–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

- `bool` ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ {true, false}
- `u8` ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ {0, 1, 2, ..., 255}
- `i32` ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ {-2¬≥¬π, ..., 2¬≥¬π-1}

–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å = –≥–∞—Ä–∞–Ω—Ç–∏—è, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Å–≤–æ–µ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É.

---

## üî• –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ

1. **–í —á—ë–º –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `let x = 5;` –∏ `let mut x = 5;`?**

2. **–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –∏ –ø–æ—á–µ–º—É?**
   ```rust
   let x = 5;
   let x = x + 1;
   let x = x * 2;
   println!("{}", x);
   ```

3. **–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è?**
   ```rust
   let spaces = "   ";
   let mut spaces = spaces.len();
   ```

4. **–ö–∞–∫–æ–π –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ç–∏–ø –¥–ª—è —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª –≤ Rust? –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –æ–Ω?**

5. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `char` –≤ Rust –∏ `char` –≤ C?**

### –£—Ä–æ–≤–µ–Ω—å 2: –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ

6. **–û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É statement –∏ expression. –ß—Ç–æ –≤–µ—Ä–Ω—ë—Ç —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è?**
   ```rust
   fn mystery() -> i32 {
       let x = 3;
       x + 1;
   }
   ```

7. **–ü–æ—á–µ–º—É Rust –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —á–∏—Å–µ–ª –∫ `bool` –≤ —É—Å–ª–æ–≤–∏—è—Ö?**
   ```rust
   let number = 3;
   if number { /* ... */ } // ‚ùå
   ```

8. **–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å shadowing, –∞ –∫–æ–≥–¥–∞ `mut`? –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä—ã.**

### –£—Ä–æ–≤–µ–Ω—å 3: –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ

9. **–ß—Ç–æ —Ç–∞–∫–æ–µ zero-cost abstractions –∏ –ø–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è Rust? –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä.**

10. **–û–±—ä—è—Å–Ω–∏, –ø–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∞ —Å–ª–µ–¥—É—é—â–∏–π ‚Äî –Ω–µ—Ç:**
    ```rust
    // –†–∞–±–æ—Ç–∞–µ—Ç
    let x = 5;
    let y = x;
    println!("{} {}", x, y);
    
    // –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
    let s1 = String::from("hello");
    let s2 = s1;
    println!("{} {}", s1, s2);
    ```

### –ë–æ–Ω—É—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å üöÄ

11. **–ö–∞–∫ –¥—É–º–∞–µ—à—å, –ø–æ—á–µ–º—É –≤ Rust `bool` –∑–∞–Ω–∏–º–∞–µ—Ç 1 –±–∞–π—Ç, –∞ –Ω–µ 1 –±–∏—Ç?**

---

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–í —Å–ª–µ–¥—É—é—â–µ–π —Ç–µ–º–µ –º—ã —Ä–∞–∑–±–µ—Ä—ë–º:
- **–°–æ—Å—Ç–∞–≤–Ω—ã–µ —Ç–∏–ø—ã** (–∫–æ—Ä—Ç–µ–∂–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, enum'—ã) –¥–µ—Ç–∞–ª—å–Ω–æ
- **Pattern matching** ‚Äî –º–æ—â–Ω–µ–π—à—É—é —Ñ–∏—á—É Rust
- **–ú–µ—Ç–æ–¥—ã –∏ –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**

–≠—Ç–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Å—Ç—Ä–æ—è—Ç—Å—è –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ —Ç–∏–ø–æ–≤ –∏ ownership, —Ç–∞–∫ —á—Ç–æ —É–±–µ–¥–∏—Å—å, —á—Ç–æ —Ö–æ—Ä–æ—à–æ —É—Å–≤–æ–∏–ª –º–∞—Ç–µ—Ä–∏–∞–ª —ç—Ç–æ–π —Ç–µ–º—ã!

---

## üìö –¢–µ–º–∞ 4: –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏. –í–µ—Ç–≤–ª–µ–Ω–∏–µ –∏ —Ü–∏–∫–ª—ã

### üéØ –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è —Ç–µ–º—ã

–í Python —Ç—ã –ø—Ä–∏–≤—ã–∫ –∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ –≥–∏–±–∫–æ—Å—Ç–∏. Rust - —ç—Ç–æ **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è** + **–Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**. –≠—Ç–æ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –∞ —Ñ–∏—á–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

### 1Ô∏è‚É£ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: –ù–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –∫–∞–∫ default

#### –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?

–í Rust –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ **–∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**. –≠—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–±—è —è–≤–Ω–æ –¥—É–º–∞—Ç—å –æ —Ç–æ–º, –≥–¥–µ –Ω—É–∂–Ω–∞ –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å.

```rust
// ‚ùå –≠—Ç–æ –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
let x = 5;
x = 6; // Error: cannot assign twice to immutable variable

// ‚úÖ –ù—É–∂–Ω–∞ —è–≤–Ω–∞—è –º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
let mut y = 5;
y = 6; // OK
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Python:**
```python
# Python - –≤—Å—ë –º—É—Ç–∞–±–µ–ª—å–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
x = 5
x = 6  # –í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

#### Shadowing - –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–µ–∑ mut

```rust
let x = 5;
let x = x + 1;  // –ù–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, —Å—Ç–∞—Ä–∞—è "–∑–∞—Ç–µ–Ω–µ–Ω–∞"
let x = x * 2;  // –ò —Å–Ω–æ–≤–∞ –Ω–æ–≤–∞—è
println!("{}", x); // 12

// –ú–æ–∂–Ω–æ –¥–∞–∂–µ –º–µ–Ω—è—Ç—å —Ç–∏–ø!
let spaces = "   ";
let spaces = spaces.len(); // String -> usize
```

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–º—ë–Ω –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

### 2Ô∏è‚É£ –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö: –ß—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –∑–Ω–∞—Ç—å

#### –°–∫–∞–ª—è—Ä–Ω—ã–µ —Ç–∏–ø—ã

```rust
// –¶–µ–ª—ã–µ —á–∏—Å–ª–∞ - —Ä–∞–∑–º–µ—Ä –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ!
let small: i8 = -128;      // 1 –±–∞–π—Ç: -128..127
let medium: i32 = 42;      // 4 –±–∞–π—Ç–∞ (default –¥–ª—è int)
let big: i64 = 1_000_000;  // 8 –±–∞–π—Ç
let unsigned: u32 = 42;    // –¢–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ

// –ß–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
let pi: f64 = 3.14159;     // 8 –±–∞–π—Ç (default)
let small_float: f32 = 3.14; // 4 –±–∞–π—Ç–∞

// –ë—É–ª–µ–≤—ã –∏ —Å–∏–º–≤–æ–ª—ã
let is_ready: bool = true;
let emoji: char = 'ü¶Ä';    // Unicode, 4 –±–∞–π—Ç–∞!
```

**–í–∞–∂–Ω–æ –¥–ª—è ML:** –ö–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—à—å —Å —Ç–µ–Ω–∑–æ—Ä–∞–º–∏/–º–∞—Å—Å–∏–≤–∞–º–∏, —Ä–∞–∑–º–µ—Ä —Ç–∏–ø–∞ = —Ä–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏. `Vec<f32>` –∑–∞–π–º—ë—Ç –≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ —á–µ–º `Vec<f64>`.

#### –°–æ—Å—Ç–∞–≤–Ω—ã–µ —Ç–∏–ø—ã

```rust
// –ö–æ—Ä—Ç–µ–∂–∏ - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã
let user: (&str, i32, bool) = ("alice", 25, true);
let (name, age, _) = user; // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è
let age = user.1;          // –î–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É

// –ú–∞—Å—Å–∏–≤—ã - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –æ–¥–∏–Ω —Ç–∏–ø
let months: [&str; 12] = ["Jan", "Feb", /*...*/ "Dec"];
let zeros = [0; 100];  // [0, 0, 0, ...] - 100 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
```

**–ú–∞—Å—Å–∏–≤ vs Vector:**
```rust
// –ú–∞—Å—Å–∏–≤ - —Ä–∞–∑–º–µ—Ä –∏–∑–≤–µ—Å—Ç–µ–Ω –≤ compile time
let arr: [i32; 3] = [1, 2, 3];  // –°—Ç–µ–∫, –±—ã—Å—Ç—Ä–æ, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ

// Vector - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä
let mut vec: Vec<i32> = vec![1, 2, 3];  // –ö—É—á–∞, –≥–∏–±–∫–æ
vec.push(4);  // –ú–æ–∂–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å
```

---

### 3Ô∏è‚É£ –§—É–Ω–∫—Ü–∏–∏: –í—ã—Ä–∞–∂–µ–Ω–∏—è vs –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

#### –ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Python

–í Rust –ø–æ—á—Ç–∏ –≤—Å—ë - **–≤—ã—Ä–∞–∂–µ–Ω–∏–µ** (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ). –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (statements) –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è.

```rust
fn add(x: i32, y: i32) -> i32 {
    x + y  // ‚úÖ –í—ã—Ä–∞–∂–µ–Ω–∏–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–±–µ–∑ ;)
}

fn bad_add(x: i32, y: i32) -> i32 {
    x + y;  // ‚ùå –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ - –≤–µ—Ä–Ω—ë—Ç (), –Ω–µ i32
}

fn main() {
    let result = add(5, 3);  // 8
    
    // –ë–ª–æ–∫–∏ - —Ç–æ–∂–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è!
    let computed = {
        let a = 10;
        let b = 20;
        a + b  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –±–µ–∑ return
    };
    println!("{}", computed); // 30
}
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**
- –ú–µ–Ω—å—à–µ `return` –≤ –∫–æ–¥–µ
- –ë–æ–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å
- –ë–ª–æ–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏—è

#### –°–∏–≥–Ω–∞—Ç—É—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π

```rust
// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—Å–µ–≥–¥–∞ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
fn process(data: &str, count: usize) -> Result<String, Error> {
    // ...
}

// Unit type () - "–Ω–∏—á–µ–≥–æ" (–∫–∞–∫ None –≤ Python)
fn log(message: &str) {  // -> () –Ω–µ—è–≤–Ω–æ
    println!("{}", message);
}

// –ù–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤
fn classify(score: f32) -> &'static str {
    if score >= 0.9 {
        return "excellent";
    }
    if score >= 0.7 {
        return "good";
    }
    "needs improvement"  // –ü–æ—Å–ª–µ–¥–Ω–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
}
```

---

### 4Ô∏è‚É£ –í–µ—Ç–≤–ª–µ–Ω–∏–µ: if –∫–∞–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ

```rust
// if –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ!
let score = 85;
let grade = if score >= 90 {
    "A"
} else if score >= 80 {
    "B"
} else {
    "C"
};  // –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ ;

// –í–µ—Ç–∫–∏ –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–¥–∏–Ω —Ç–∏–ø
let number = if condition { 5 } else { 10 };  // ‚úÖ
let mixed = if condition { 5 } else { "no" }; // ‚ùå –û—à–∏–±–∫–∞ —Ç–∏–ø–æ–≤
```

**Pattern matching - –±–æ–ª–µ–µ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:**

```rust
let status_code = 404;

match status_code {
    200 => println!("OK"),
    404 => println!("Not Found"),
    500 => println!("Server Error"),
    code => println!("Unknown: {}", code),  // Default case
}

// –í–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ match
let message = match status_code {
    200 => "Success",
    404 => "Not Found",
    _ => "Other",  // _ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
};

// –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
match temperature {
    -100..=-1 => "freezing",
    0..=15 => "cold",
    16..=25 => "comfortable",
    26..=35 => "hot",
    _ => "extreme",
}
```

---

### 5Ô∏è‚É£ –¶–∏–∫–ª—ã: loop, while, for

#### loop - –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º

```rust
let mut counter = 0;

// –ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ loop!
let result = loop {
    counter += 1;
    
    if counter == 10 {
        break counter * 2;  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
    }
};
println!("{}", result); // 20
```

#### while - —É—Å–ª–æ–≤–Ω—ã–π —Ü–∏–∫–ª

```rust
let mut n = 0;
while n < 5 {
    println!("{}", n);
    n += 1;
}
```

#### for - –∏—Ç–µ—Ä–∞—Ü–∏—è (—Å–∞–º—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π)

```rust
// –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É
for i in 0..5 {  // 0, 1, 2, 3, 4 (–Ω–µ –≤–∫–ª—é—á–∞—è 5)
    println!("{}", i);
}

for i in 0..=5 {  // 0, 1, 2, 3, 4, 5 (–≤–∫–ª—é—á–∞—è 5)
    println!("{}", i);
}

// –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
let numbers = vec![1, 2, 3, 4, 5];

for num in &numbers {  // –ó–∞–∏–º—Å—Ç–≤—É–µ–º, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ–º
    println!("{}", num);
}

for (index, value) in numbers.iter().enumerate() {
    println!("{}: {}", index, value);
}
```

**–í–∞–∂–Ω–æ:** –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Python, `for` –≤ Rust **–≤—Å–µ–≥–¥–∞** –∏—Ç–µ—Ä–∏—Ä—É–µ—Ç, –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ `for i in range()` —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º —à–∞–≥–æ–º –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏—Ç–µ—Ä–∞—Ç–æ—Ä–æ–≤.

---

## üìö –¢–µ–º–∞ 5: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ. –¢—Ä–µ–π—Ç Copy. –ü—Ä–∏–Ω—Ü–∏–ø –≤–ª–∞–¥–µ–Ω–∏—è

### üéØ –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è —Ç–µ–º—ã

–≠—Ç–æ **–°–ê–ú–ê–Ø –í–ê–ñ–ù–ê–Ø** —Ç–µ–º–∞ –≤ Rust. Ownership (–≤–ª–∞–¥–µ–Ω–∏–µ) - —ç—Ç–æ —Ç–æ, —á—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç Rust –æ—Ç –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–≥–æ = –ø–æ–Ω–∏–º–∞–Ω–∏–µ 80% —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —è–∑—ã–∫–∞.

**–ì–ª–∞–≤–Ω–∞—è –º—ã—Å–ª—å:** –í Rust —É –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –µ—Å—Ç—å **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü**. –ö–æ–≥–¥–∞ –≤–ª–∞–¥–µ–ª–µ—Ü –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏, –∑–Ω–∞—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è.

---

### 1Ô∏è‚É£ –ü–æ—á–µ–º—É —ç—Ç–æ –Ω—É–∂–Ω–æ?

#### –ü—Ä–æ–±–ª–µ–º—ã –≤ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö

**C/C++:**
```c
// –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
int* data = malloc(sizeof(int) * 100);
// ... –∏—Å–ø–æ–ª—å–∑—É–µ–º data ...
free(data);  // –õ–µ–≥–∫–æ –∑–∞–±—ã—Ç—å!
// double free, use after free, memory leaks
```

**Python:**
```python
# Garbage collection - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ, –Ω–æ:
# - –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –ø–∞—É–∑—ã
# - –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏
# - Overhead –Ω–∞ –ø–æ–¥—Å—á—ë—Ç —Å—Å—ã–ª–æ–∫
data = [1, 2, 3]  # GC —Å–ª–µ–¥–∏—Ç –∑–∞ —Å—Å—ã–ª–∫–∞–º–∏
```

**Rust:**
```rust
{
    let data = vec![1, 2, 3];  // –í–ª–∞–¥–µ–ª–µ—Ü - data
    // ... –∏—Å–ø–æ–ª—å–∑—É–µ–º data ...
}  // data –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ scope -> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
// –ù–∏–∫–∞–∫–∏—Ö —É—Ç–µ—á–µ–∫, –Ω–∏–∫–∞–∫–æ–≥–æ GC, –Ω–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫
```

---

### 2Ô∏è‚É£ Move semantics - –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–ª–∞–¥–µ–Ω–∏—è

#### –ë–∞–∑–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ

```rust
let s1 = String::from("hello");
let s2 = s1;  // s1 –ü–ï–†–ï–ú–ï–©–Å–ù –≤ s2

println!("{}", s2);  // ‚úÖ OK
println!("{}", s1);  // ‚ùå Error: value borrowed after move
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. `s1` –≤–ª–∞–¥–µ–µ—Ç —Å—Ç—Ä–æ–∫–æ–π "hello" –≤ –∫—É—á–µ
2. `s2 = s1` **–ø–µ—Ä–µ–º–µ—â–∞–µ—Ç** –≤–ª–∞–¥–µ–Ω–∏–µ –∫ `s2`
3. `s1` –±–æ–ª—å—à–µ –Ω–µ –≤–∞–ª–∏–¥–Ω–∞ - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –¥–∞—Å—Ç –µ—ë –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
```
–î–æ:    s1 -> ["hello" –≤ –∫—É—á–µ]
–ü–æ—Å–ª–µ: s1 (–Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞)
       s2 -> ["hello" –≤ –∫—É—á–µ]
```

#### –ó–∞—á–µ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ, –∞ –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ?

```rust
// –ü—Ä–µ–¥—Å—Ç–∞–≤—å –±–æ–ª—å—à–æ–π –≤–µ–∫—Ç–æ—Ä
let big_data = vec![0; 1_000_000];  // 1 –º–∏–ª–ª–∏–æ–Ω —ç–ª–µ–º–µ–Ω—Ç–æ–≤

let data2 = big_data;  // Move, –∞ –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ!
// –û–ø–µ—Ä–∞—Ü–∏—è O(1), –∞ –Ω–µ O(n)
// –¢–æ–ª—å–∫–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è, –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞–ª–∏—Å—å –Ω–∞ –º–µ—Å—Ç–µ
```

---

### 3Ô∏è‚É£ Clone - –Ø–≤–Ω–æ–µ –≥–ª—É–±–æ–∫–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω—ã –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–æ–ø–∏–∏:

```rust
let s1 = String::from("hello");
let s2 = s1.clone();  // –Ø–≤–Ω–æ–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

println!("{}", s1);  // ‚úÖ OK
println!("{}", s2);  // ‚úÖ OK
// –¢–µ–ø–µ—Ä—å –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ –ø–∞–º—è—Ç–∏
```

**Clone - –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è:**
```rust
let big_vec = vec![1; 1_000_000];
let copy = big_vec.clone();  // –ö–æ–ø–∏—Ä—É–µ–º 1–ú —ç–ª–µ–º–µ–Ω—Ç–æ–≤ - –º–µ–¥–ª–µ–Ω–Ω–æ!

// –ò—Å–ø–æ–ª—å–∑—É–π clone –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ
```

---

### 4Ô∏è‚É£ Copy trait - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–∏–ø—ã **–∫–æ–ø–∏—Ä—É—é—Ç—Å—è** –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è:

```rust
let x = 5;
let y = x;  // –ö–æ–ø–∏—Ä—É–µ—Ç—Å—è, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è

println!("{}", x);  // ‚úÖ OK - x –≤—Å—ë –µ—â—ë –≤–∞–ª–∏–¥–Ω–∞
println!("{}", y);  // ‚úÖ OK
```

**–ö–∞–∫–∏–µ —Ç–∏–ø—ã –∏–º–µ—é—Ç Copy:**
- –í—Å–µ —á–∏—Å–ª–æ–≤—ã–µ —Ç–∏–ø—ã: `i32`, `u64`, `f64`, etc.
- `bool`
- `char`
- –ö–æ—Ä—Ç–µ–∂–∏, –µ—Å–ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç Copy: `(i32, i32)`
- **–ù–ï –∏–º–µ—é—Ç Copy:** `String`, `Vec<T>`, –∏ –ª—é–±—ã–µ —Ç–∏–ø—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –∫—É—á–µ

```rust
// Copy —Ç–∏–ø—ã - –Ω–∞ —Å—Ç–µ–∫–µ, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä
let a = 42;
let b = a;  // –ö–æ–ø–∏—è

// –ù–µ-Copy —Ç–∏–ø—ã - –º–æ–≥—É—Ç –±—ã—Ç—å –≤ –∫—É—á–µ
let s1 = String::from("hello");
let s2 = s1;  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ
```

**–ü–æ—á–µ–º—É String –Ω–µ Copy?**
```rust
// String —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:
// - —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ
// - –¥–ª–∏–Ω—ã
// - —ë–º–∫–æ—Å—Ç–∏
// –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞—Ç–µ–ª—è -> –¥–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–ª–∞–¥–µ—é—Ç –æ–¥–Ω–æ–π –ø–∞–º—è—Ç—å—é -> double free!
// –ü–æ—ç—Ç–æ–º—É String –∏—Å–ø–æ–ª—å–∑—É–µ—Ç move
```

---

### 5Ô∏è‚É£ Ownership –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö

#### –ü–µ—Ä–µ–¥–∞—á–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—é = –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ

```rust
fn take_ownership(s: String) {
    println!("{}", s);
}  // s —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è –∑–¥–µ—Å—å

fn main() {
    let my_string = String::from("hello");
    take_ownership(my_string);  // my_string –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞
    
    // println!("{}", my_string);  // ‚ùå Error - —É–∂–µ –Ω–µ –≤–ª–∞–¥–µ–µ–º
}
```

#### –í–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏—è = –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ

```rust
fn give_ownership() -> String {
    let s = String::from("hello");
    s  // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –Ω–∞—Ä—É–∂—É
}

fn take_and_give(s: String) -> String {
    s  // –ë–µ—Ä—ë–º –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
}

fn main() {
    let s1 = give_ownership();        // OK
    let s2 = String::from("world");
    let s3 = take_and_give(s2);       // s2 –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞, –ø–æ–ª—É—á–∏–ª–∏ s3
}
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω "–≤–∑—è—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å" –≥—Ä–æ–º–æ–∑–¥–∫–∏–π:

```rust
fn calculate_length(s: String) -> (String, usize) {
    let length = s.len();
    (s, length)  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ + —Ä–µ–∑—É–ª—å—Ç–∞—Ç
}

fn main() {
    let s1 = String::from("hello");
    let (s2, len) = calculate_length(s1);
    // –ì—Ä–æ–º–æ–∑–¥–∫–æ! –ï—Å—Ç—å –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± - —Å—Å—ã–ª–∫–∏
}
```

---

## üìö –¢–µ–º–∞ 6: –í–ª–∞–¥–µ–Ω–∏–µ. –°—Å—ã–ª–∫–∏ –∏ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ

### üéØ –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è —Ç–µ–º—ã

**–ó–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ (borrowing)** –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ **–±–µ–∑ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–ª–∞–¥–µ–Ω–∏—è**. –≠—Ç–æ –∫–∞–∫ –≤–∑—è—Ç—å –∫–Ω–∏–≥—É –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ - –º–æ–∂–µ—à—å —á–∏—Ç–∞—Ç—å, –Ω–æ –Ω–µ –≤–ª–∞–¥–µ–µ—à—å.

---

### 1Ô∏è‚É£ –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (&T)

```rust
fn calculate_length(s: &String) -> usize {
    s.len()
}  // s –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ scope, –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥—Ä–æ–ø–∞–µ—Ç—Å—è - –º—ã –Ω–µ –≤–ª–∞–¥–µ–µ–º

fn main() {
    let s1 = String::from("hello");
    let len = calculate_length(&s1);  // –ó–∞–∏–º—Å—Ç–≤—É–µ–º
    
    println!("Length of '{}' is {}", s1, len);  // s1 –≤—Å—ë –µ—â—ë –≤–∞–ª–∏–¥–Ω–∞!
}
```

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
```
s1 -> [String –≤ –∫—É—á–µ: "hello"]
       ‚Üë
       &s1 (—Å—Å—ã–ª–∫–∞, –Ω–µ –≤–ª–∞–¥–µ–µ—Ç)
```

#### –ù–µ—Å–∫–æ–ª—å–∫–æ –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ - OK

```rust
let s = String::from("hello");
let r1 = &s;
let r2 = &s;
let r3 = &s;

println!("{}, {}, {}", r1, r2, r3);  // ‚úÖ –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
// –ú–æ–∂–Ω–æ –∏–º–µ—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ read-only —Å—Å—ã–ª–æ–∫
```

---

### 2Ô∏è‚É£ –ú—É—Ç–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (&mut T)

```rust
fn append_world(s: &mut String) {
    s.push_str(", world");
}

fn main() {
    let mut s = String::from("hello");
    append_world(&mut s);
    println!("{}", s);  // "hello, world"
}
```

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞

```rust
let mut s = String::from("hello");

let r1 = &mut s;
let r2 = &mut s;  // ‚ùå Error: cannot borrow as mutable more than once

println!("{}, {}", r1, r2);
```

**–ü–æ—á–µ–º—É?** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ **data races** –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:
```rust
// –ì–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π data race (–≤ Rust –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω):
let mut data = vec![1, 2, 3];
let ref1 = &mut data;
let ref2 = &mut data;

ref1.push(4);        // –ú–æ–∂–µ—Ç —Ä–µ–∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–∞–º—è—Ç—å
ref2.push(5);        // ref1 —Ç–µ–ø–µ—Ä—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ—Å–≤–æ–±–æ–∂–¥—ë–Ω–Ω—É—é –ø–∞–º—è—Ç—å - BOOM!
```

---

### 3Ô∏è‚É£ –ü—Ä–∞–≤–∏–ª–∞ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—è (The Rules)

**–ì–ª–∞–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞:**

1. **–í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç** –º–æ–∂–µ—Ç –±—ã—Ç—å **–ª–∏–±–æ**:
   - –û–¥–Ω–∞ –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ (`&mut T`)
   - –õ—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ (`&T`)

2. –°—Å—ã–ª–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–≤—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–Ω—ã–º–∏** (no dangling references)

```rust
// ‚ùå –ù–µ–ª—å–∑—è: –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è + –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω–∞—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
let mut s = String::from("hello");
let r1 = &s;      // OK
let r2 = &s;      // OK
let r3 = &mut s;  // ‚ùå Error: cannot borrow as mutable

println!("{}, {}, {}", r1, r2, r3);
```

#### Non-Lexical Lifetimes (NLL)

–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–º–Ω—ã–π:

```rust
let mut s = String::from("hello");

let r1 = &s;
let r2 = &s;
println!("{}, {}", r1, r2);  // r1 –∏ r2 –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–¥–µ—Å—å

let r3 = &mut s;  // ‚úÖ OK - r1 –∏ r2 –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
println!("{}", r3);
```

**–û–±–ª–∞—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—è —Å—Å—ã–ª–∫–∏** = –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ scope.

---

### 4Ô∏è‚É£ –í–∏—Å—è—á–∏–µ —Å—Å—ã–ª–∫–∏ - –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã

```rust
fn dangle() -> &String {  // ‚ùå Error: missing lifetime specifier
    let s = String::from("hello");
    &s  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
}  // s —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è, —Å—Å—ã–ª–∫–∞ —Å—Ç–∞–Ω–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π
```

**–í Python/C++ —Ç–∞–∫–æ–π –∫–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ –≤—ã–∑—ã–≤–∞–µ—Ç undefined behavior:**
```python
def dangle():
    s = "hello"
    return s  # –í Python OK –∏–∑-–∑–∞ GC, –Ω–æ –≤ C++ - –±–µ–¥–∞
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ Rust:**
```rust
fn no_dangle() -> String {
    let s = String::from("hello");
    s  // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –≤–ª–∞–¥–µ–Ω–∏–µ –Ω–∞—Ä—É–∂—É
}
```

---

### 5Ô∏è‚É£ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

#### –ü–∞—Ç—Ç–µ—Ä–Ω 1: –ß—Ç–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```rust
fn analyze_data(data: &Vec<f32>) -> f32 {
    data.iter().sum::<f32>() / data.len() as f32
}

let metrics = vec![1.0, 2.0, 3.0];
let avg = analyze_data(&metrics);  // –ó–∞–∏–º—Å—Ç–≤—É–µ–º –¥–ª—è —á—Ç–µ–Ω–∏—è
println!("Average: {}, Data: {:?}", avg, metrics);  // metrics –≤—Å—ë –µ—â—ë –¥–æ—Å—Ç—É–ø–Ω–∞
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω 2: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –º–µ—Å—Ç–µ

```rust
fn normalize(data: &mut Vec<f32>) {
    let max = data.iter().cloned().fold(f32::MIN, f32::max);
    for val in data.iter_mut() {
        *val /= max;
    }
}

let mut scores = vec![10.0, 20.0, 30.0];
normalize(&mut scores);  // –ò–∑–º–µ–Ω—è–µ–º in-place
println!("{:?}", scores);  // [0.33, 0.67, 1.0]
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω 3: –ú–µ—Ç–æ–¥-—Å—Ç—Ä–æ–∏—Ç–µ–ª—å (builder pattern)

```rust
struct Config {
    host: String,
    port: u16,
}

impl Config {
    fn new() -> Self {
        Config {
            host: "localhost".to_string(),
            port: 8080,
        }
    }
    
    fn set_host(&mut self, host: &str) -> &mut Self {
        self.host = host.to_string();
        self  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º—É—Ç–∞–±–µ–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è chaining
    }
    
    fn set_port(&mut self, port: u16) -> &mut Self {
        self.port = port;
        self
    }
}

let mut config = Config::new();
config.set_host("0.0.0.0").set_port(3000);
```

---

### 6Ô∏è‚É£ Slice - —Å—Å—ã–ª–∫–∏ –Ω–∞ —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

Slice - —ç—Ç–æ —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–∏:

```rust
let s = String::from("hello world");

let hello = &s[0..5];   // "hello"
let world = &s[6..11];  // "world"

// –°–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞
let hello = &s[..5];    // –° –Ω–∞—á–∞–ª–∞ –¥–æ 5
let world = &s[6..];    // –° 6 –¥–æ –∫–æ–Ω—Ü–∞
let full = &s[..];      // –í—Å—è —Å—Ç—Ä–æ–∫–∞
```

#### String slices (&str)

```rust
fn first_word(s: &String) -> &str {
    let bytes = s.as_bytes();
    
    for (i, &byte) in bytes.iter().enumerate() {
        if byte == b' ' {
            return &s[..i];
        }
    }
    
    &s[..]
}

let sentence = String::from("hello world");
let word = first_word(&sentence);
println!("{}", word);  // "hello"
```

**String vs &str:**
- `String` - –≤–ª–∞–¥–µ—é—â–∏–π —Ç–∏–ø, –∏–∑–º–µ–Ω—è–µ–º—ã–π, –≤ –∫—É—á–µ
- `&str` - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç—Ä–æ–∫—É, –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π, –º–æ–∂–µ—Ç –±—ã—Ç—å —á–∞—Å—Ç—å—é String –∏–ª–∏ string literal

```rust
let owned: String = String::from("hello");  // –í–ª–∞–¥–µ—é—â–∏–π
let borrowed: &str = "hello";               // String literal
let slice: &str = &owned[..];               // Slice –∏–∑ String
```

#### Array slices

```rust
let arr = [1, 2, 3, 4, 5];
let slice: &[i32] = &arr[1..3];  // [2, 3]

fn sum_slice(data: &[i32]) -> i32 {
    data.iter().sum()
}

let numbers = vec![1, 2, 3, 4];
println!("{}", sum_slice(&numbers));     // –†–∞–±–æ—Ç–∞–µ—Ç —Å Vec
println!("{}", sum_slice(&arr[..]));     // –†–∞–±–æ—Ç–∞–µ—Ç —Å –º–∞—Å—Å–∏–≤–æ–º
```

---

## üéì –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ—ë –ø–æ–Ω–∏–º–∞–Ω–∏–µ. –ü–æ–ø—Ä–æ–±—É–π –æ—Ç–≤–µ—Ç–∏—Ç—å –±–µ–∑ –ø–æ–¥–≥–ª—è–¥—ã–≤–∞–Ω–∏—è –≤ –º–∞—Ç–µ—Ä–∏–∞–ª:

### –ë–ª–æ–∫ 1: –¢–∏–ø—ã –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `let x = 5;` –∏ `let mut x = 5;`? –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç?**

2. **–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –∏ –ø–æ—á–µ–º—É?**
   ```rust
   let x = 5;
   let x = x + 1;
   let x = x * 2;
   println!("{}", x);
   ```

3. **–ü–æ—á–µ–º—É –≤ ML-–∑–∞–¥–∞—á–∞—Ö –≤—ã–±–æ—Ä –º–µ–∂–¥—É `Vec<f32>` –∏ `Vec<f64>` –∫—Ä–∏—Ç–∏—á–µ–Ω? –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä —Ä–∞—Å—á—ë—Ç–∞ –ø–∞–º—è—Ç–∏ –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∞ –∏–∑ 1–ú —ç–ª–µ–º–µ–Ω—Ç–æ–≤.**

4. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –º–∞—Å—Å–∏–≤–æ–º –∏ –≤–µ–∫—Ç–æ—Ä–æ–º? –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π?**

5. **–ß—Ç–æ –≤–µ—Ä–Ω—ë—Ç —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏ –ø–æ—á–µ–º—É?**
   ```rust
   fn mystery() -> i32 {
       let x = 5;
       x + 1;
   }
   ```

### –ë–ª–æ–∫ 2: Ownership –∏ Move

6. **–û–±—ä—è—Å–Ω–∏, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —ç—Ç–æ–º –∫–æ–¥–µ –∏ –ø–æ—á–µ–º—É –≤—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è:**
   ```rust
   let s1 = String::from("hello");
   let s2 = s1;
   println!("{}", s1);  // Error
   ```

7. **–ó–∞—á–µ–º Rust –∏—Å–ø–æ–ª—å–∑—É–µ—Ç move –≤–º–µ—Å—Ç–æ copy –¥–ª—è —Ç–∏–ø–æ–≤ –≤—Ä–æ–¥–µ String –∏ Vec? –ö–∞–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–∞–µ—Ç—Å—è?**

8. **–ö–∞–∫–∏–µ —Ç–∏–ø—ã –∏–º–µ—é—Ç —Ç—Ä–µ–π—Ç Copy –∏ –ø–æ—á–µ–º—É? –ü–æ—á–µ–º—É String –Ω–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å Copy?**

9. **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å `data` –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏?**
   ```rust
   fn process(data: Vec<i32>) {
       println!("{:?}", data);
   }
   let data = vec![1, 2, 3];
   process(data);
   // –ú–æ–∂–µ–º –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å data –∑–¥–µ—Å—å?
   ```

10. **–ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –µ–≥–æ –ø—Ä–∏–Ω—è–ª–∞ –ø–æ –≤–ª–∞–¥–µ–Ω–∏—é? –ü–æ–∫–∞–∂–∏ –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞.**

### –ë–ª–æ–∫ 3: Borrowing –∏ References

11. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `&T` –∏ `&mut T`? –ú–æ–∂–Ω–æ –ª–∏ –∏–º–µ—Ç—å –æ–±–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ?**

12. **–ü–æ—á–µ–º—É –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Ä–∞–∑—Ä–µ—à–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥?**
    ```rust
    let mut s = String::from("hello");
    let r1 = &s;
    let r2 = &s;
    println!("{} {}", r1, r2);
    let r3 = &mut s;
    println!("{}", r3);
    ```

13. **–ö–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–æ "–æ–¥–Ω–∞ –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è –ò–õ–ò –º–Ω–æ–≥–æ –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫"?**

14. **–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ –∫–∞–∫ –µ–≥–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å?**
    ```rust
    fn get_first() -> &str {
        let s = String::from("hello");
        &s[..]
    }
    ```

15. **–û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `String`, `&String` –∏ `&str`. –ö–∞–∫–æ–π —Ç–∏–ø –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É?**

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –¥–ª—è ML Backend Developer

1. **–ò–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** - —Ñ–∏—á–∞, –Ω–µ –±–∞–≥. –ü–æ–º–æ–≥–∞–µ—Ç –ø–∏—Å–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–¥.

2. **Ownership** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –±–µ–∑ GC.

3. **Move vs Copy** - –¥–æ—Ä–æ–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (String, Vec) –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è, –¥–µ—à—ë–≤—ã–µ (i32, bool) –∫–æ–ø–∏—Ä—É—é—Ç—Å—è.

4. **Borrowing** - –∏—Å–ø–æ–ª—å–∑—É–π –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è. –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ, –º—É—Ç–∞–±–µ–ª—å–Ω–∞—è - —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞.

5. **–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä - —Ç–≤–æ–π –¥—Ä—É–≥** - –≤—Å–µ —ç—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ compile time. –†–∞–Ω—Ç–∞–π–º-–æ—à–∏–±–æ–∫ –Ω–µ –±—É–¥–µ—Ç.

**–î–ª—è ML:**
- –†–∞–±–æ—Ç–∞—è —Å –±–æ–ª—å—à–∏–º–∏ —Ç–µ–Ω–∑–æ—Ä–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É–π –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –ú—É—Ç–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è in-place –æ–ø–µ—Ä–∞—Ü–∏–π (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è)
- Slices –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞—Ç—á–∞–º–∏ –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü—Ä–∞–∫—Ç–∏–∫–∞! –ù–∞–ø–∏—à–∏ –ø—Ä–æ—Å—Ç—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ —ç—Ç–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏.

---

## üéØ –¢–µ–º–∞ 7: –ö–æ–ª–ª–µ–∫—Ü–∏–∏. –°–ª–∞–π—Å—ã, –ú–∞—Å—Å–∏–≤—ã, –°—Ç—Ä–æ–∫–∏

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

–í Rust –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–µ–ª—è—Ç—Å—è –Ω–∞:
- **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ** (–º–∞—Å—Å–∏–≤—ã) - —Ä–∞–∑–º–µ—Ä –∏–∑–≤–µ—Å—Ç–µ–Ω –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ** (Vec, String) - —Ä–∞–∑–º–µ—Ä –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –≤ runtime
- **–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è** (—Å–ª–∞–π—Å—ã) - "–æ–∫–Ω–∞" –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ —Å Python:** –í Python `list` –∏ `str` - —ç—Ç–æ –≤—Å–µ–≥–¥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã –≤ –∫—É—á–µ. –í Rust –º–∞—Å—Å–∏–≤ `[T; N]` –º–æ–∂–µ—Ç –∂–∏—Ç—å –Ω–∞ —Å—Ç–µ–∫–µ, –∞ `Vec<T>` - –≤ –∫—É—á–µ.

---

### üì¶ –ú–∞—Å—Å–∏–≤—ã `[T; N]`

```rust
// –ú–∞—Å—Å–∏–≤ - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –∏–∑–≤–µ—Å—Ç–Ω—ã–π –≤ compile-time
let numbers: [i32; 5] = [1, 2, 3, 4, 5];
let zeros = [0; 100]; // [0, 0, 0, ... 0] - 100 —ç–ª–µ–º–µ–Ω—Ç–æ–≤

// –î–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É
let first = numbers[0]; // 1
let last = numbers[4];  // 5

// –í–ê–ñ–ù–û: –≤—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã = –ø–∞–Ω–∏–∫–∞ –≤ runtime
// let invalid = numbers[10]; // panic!
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –†–∞–∑–º–µ—Ä —Ç–æ—á–Ω–æ –∏–∑–≤–µ—Å—Ç–µ–Ω (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã 3D: `[f32; 3]`)
- –ù—É–∂–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ç–µ–∫–∞
- –†–∞–±–æ—Ç–∞–µ—à—å —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ (—Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞, –±—É—Ñ–µ—Ä–∞)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å ‚Üí `Vec<T>`

---

### üöÄ –í–µ–∫—Ç–æ—Ä—ã `Vec<T>`

```rust
// –°–æ–∑–¥–∞–Ω–∏–µ
let mut v1: Vec<i32> = Vec::new();
let mut v2 = vec![1, 2, 3]; // –º–∞–∫—Ä–æ—Å vec!

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
v1.push(10);
v1.push(20);

// –î–æ—Å—Ç—É–ø
let third = &v2[2];           // –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø (–º–æ–∂–µ—Ç –ø–∞–Ω–∏–∫–æ–≤–∞—Ç—å)
let safe = v2.get(2);         // Option<&i32> - –±–µ–∑–æ–ø–∞—Å–Ω–æ
match safe {
    Some(value) => println!("–ó–Ω–∞—á–µ–Ω–∏–µ: {}", value),
    None => println!("–ò–Ω–¥–µ–∫—Å –∑–∞ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏"),
}

// –ò—Ç–µ—Ä–∞—Ü–∏—è
for item in &v2 {
    println!("{}", item);
}

// –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏
for item in &mut v2 {
    *item += 10; // —Ä–∞–∑—ã–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
}
```

**–í–∞–∂–Ω–∞—è –¥–µ—Ç–∞–ª—å –ø—Ä–æ –≤–ª–∞–¥–µ–Ω–∏–µ:**

```rust
let mut v = vec![1, 2, 3];

let first = &v[0]; // –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ

// v.push(4); // ‚ùå –û–®–ò–ë–ö–ê! –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω—è—Ç—å, –ø–æ–∫–∞ –µ—Å—Ç—å –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
// println!("{}", first);

// –ü–æ—á–µ–º—É? push() –º–æ–∂–µ—Ç —Ä–µ–∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–∞–º—è—Ç—å,
// –∏ —Å—Å—ã–ª–∫–∞ first —Å—Ç–∞–Ω–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π (dangling pointer)
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:**
```
Vec<T> = { 
    ptr: *mut T,      // —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ
    capacity: usize,  // —Å–∫–æ–ª—å–∫–æ –≤—ã–¥–µ–ª–µ–Ω–æ –ø–∞–º—è—Ç–∏
    len: usize        // —Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
}
```

---

### üî™ –°–ª–∞–π—Å—ã `&[T]` –∏ `&mut [T]`

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:** –°–ª–∞–π—Å - —ç—Ç–æ "—Ç–æ–ª—Å—Ç—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å" (fat pointer) = —É–∫–∞–∑–∞—Ç–µ–ª—å + –¥–ª–∏–Ω–∞. –û–Ω –ù–ï –≤–ª–∞–¥–µ–µ—Ç –¥–∞–Ω–Ω—ã–º–∏, —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–∏—Ö.

```rust
let array = [1, 2, 3, 4, 5];
let vec = vec![10, 20, 30, 40];

// –°–ª–∞–π—Å - —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
let slice1: &[i32] = &array[1..4];  // [2, 3, 4]
let slice2: &[i32] = &vec[..2];     // [10, 20]
let slice3: &[i32] = &array[..];    // –≤–µ—Å—å –º–∞—Å—Å–∏–≤

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è —Å–ª–∞–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å Vec, –∏ —Å –º–∞—Å—Å–∏–≤–∞–º–∏!
fn sum(data: &[i32]) -> i32 {
    data.iter().sum()
}

println!("{}", sum(&array));      // —Ä–∞–±–æ—Ç–∞–µ—Ç
println!("{}", sum(&vec));        // —Ç–æ–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
println!("{}", sum(&vec[1..3]));  // –∏ —Ç–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –º–æ—â–Ω–æ:**

1. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å:** –û–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –º–∞—Å—Å–∏–≤–æ–≤, –≤–µ–∫—Ç–æ—Ä–æ–≤, —á–∞—Å—Ç–µ–π –¥–∞–Ω–Ω—ã—Ö
2. **Zero-cost:** –ù–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞—á–∞ —É–∫–∞–∑–∞—Ç–µ–ª—è + –¥–ª–∏–Ω—ã
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** Borrow checker –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å

```rust
let mut numbers = vec![1, 2, 3, 4, 5];

// –ò–∑–º–µ–Ω—è–µ–º—ã–π —Å–ª–∞–π—Å
let slice: &mut [i32] = &mut numbers[1..4];
slice[0] = 100; // numbers[1] —Ç–µ–ø–µ—Ä—å = 100

println!("{:?}", numbers); // [1, 100, 3, 4, 5]
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–∞–π—Å–∞:**
```
&[T] = {
    ptr: *const T,  // —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
    len: usize      // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
}
```

**–î–∏–∞–ø–∞–∑–æ–Ω—ã (ranges):**
```rust
let data = [0, 1, 2, 3, 4, 5];

&data[1..4]   // [1, 2, 3] - –æ—Ç 1 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–æ 4 –Ω–µ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ
&data[..3]    // [0, 1, 2] - —Å –Ω–∞—á–∞–ª–∞ –¥–æ 3
&data[2..]    // [2, 3, 4, 5] - —Å 2 –¥–æ –∫–æ–Ω—Ü–∞
&data[..]     // [0, 1, 2, 3, 4, 5] - –≤–µ—Å—å —Å–ª–∞–π—Å
&data[1..=3]  // [1, 2, 3] - –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
```

---

### üìù –°—Ç—Ä–æ–∫–∏: `String` vs `&str`

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è:** –í Rust —Å—Ç—Ä–æ–∫–∏ - —ç—Ç–æ UTF-8 –±–∞–π—Ç–æ–≤—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ù–ï–¢ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –ø–æ —Å–∏–º–≤–æ–ª–∞–º!

```rust
// String - –≤–ª–∞–¥–µ—é—â–∞—è, –∏–∑–º–µ–Ω—è–µ–º–∞—è, –≤ –∫—É—á–µ
let mut s1 = String::from("–ü—Ä–∏–≤–µ—Ç");
let mut s2 = String::new();

s1.push_str(", –º–∏—Ä!");
s1.push('!');

// &str - –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–π —Å–ª–∞–π—Å —Å—Ç—Ä–æ–∫–∏ (string slice)
let slice: &str = "—ç—Ç–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–π –ª–∏—Ç–µ—Ä–∞–ª";
let part: &str = &s1[0..12]; // "–ü—Ä–∏–≤–µ—Ç"
```

**–ü–æ—á–µ–º—É –Ω–µ—Ç `s[0]`?**

```rust
let hello = String::from("–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π");

// ‚ùå –û–®–ò–ë–ö–ê: –Ω–µ–ª—å–∑—è –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é
// let h = hello[0];

// –ü–æ—Ç–æ–º—É —á—Ç–æ '–ó' –∑–∞–Ω–∏–º–∞–µ—Ç 2 –±–∞–π—Ç–∞ –≤ UTF-8!
// –ò–Ω–¥–µ–∫—Å 0 —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä–≤—ã–π –ë–ê–ô–¢, –Ω–µ —Å–∏–º–≤–æ–ª

// –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã:
// 1. –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ —Å–∏–º–≤–æ–ª–∞–º
for c in hello.chars() {
    println!("{}", c);
}

// 2. –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –±–∞–π—Ç–∞–º
for b in hello.bytes() {
    println!("{}", b);
}

// 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ä–µ–∑–∞ –ø–æ –ë–ê–ô–¢–ê–ú (–æ–ø–∞—Å–Ω–æ!)
let slice = &hello[0..4]; // "–ó–¥" - –µ—Å–ª–∏ —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º –≥—Ä–∞–Ω–∏—Ü—ã UTF-8
```

**String vs &str - –∫–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

| –°–∏—Ç—É–∞—Ü–∏—è | –ò—Å–ø–æ–ª—å–∑—É–π |
|----------|-----------|
| –§—É–Ω–∫—Ü–∏—è —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É | `&str` |
| –ù—É–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å | `String` |
| –í–æ–∑–≤—Ä–∞—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞) | `String` |
| –°—Ç—Ä–æ–∫–æ–≤—ã–π –ª–∏—Ç–µ—Ä–∞–ª –≤ –∫–æ–¥–µ | `&str` (—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±–∏–Ω–∞—Ä–Ω–∏–∫–µ) |
| –ß—Ç–µ–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞/—Å–µ—Ç–∏ | `String` (–¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ) |

```rust
// –•–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞: –ø—Ä–∏–Ω–∏–º–∞—Ç—å &str, –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å String
fn process(input: &str) -> String {
    let mut result = String::new();
    result.push_str(input);
    result.push_str(" processed");
    result
}

// –†–∞–±–æ—Ç–∞–µ—Ç –∏ —Å–æ String, –∏ —Å–æ &str
let s = String::from("data");
process(&s);        // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ String -> &str
process("literal"); // –Ω–∞–ø—Ä—è–º—É—é &str
```

**–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è:**

```rust
let s1 = String::from("Hello");
let s2 = String::from("World");

// –°–ø–æ—Å–æ–± 1: –æ–ø–µ—Ä–∞—Ç–æ—Ä + (s1 –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è!)
let s3 = s1 + " " + &s2; // s1 –±–æ–ª—å—à–µ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

// –°–ø–æ—Å–æ–± 2: format! (–Ω–∏—á–µ–≥–æ –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç)
let s1 = String::from("Hello");
let s4 = format!("{} {}", s1, s2); // s1 –∏ s2 –æ—Å—Ç–∞—é—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º–∏

// –°–ø–æ—Å–æ–± 3: push_str
let mut s5 = String::from("Hello");
s5.push_str(" ");
s5.push_str(&s2);
```

---

### üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º

1. **–ú–∞—Å—Å–∏–≤—ã** - —Å—Ç–µ–∫, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –±—ã—Å—Ç—Ä–æ
2. **Vec** - –∫—É—á–∞, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä, –≥–∏–±–∫–æ
3. **–°–ª–∞–π—Å—ã** - "–æ–∫–Ω–∞" –≤ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è, —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
4. **String** - –≤–ª–∞–¥–µ—é—â–∞—è UTF-8 —Å—Ç—Ä–æ–∫–∞ –≤ –∫—É—á–µ
5. **&str** - –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–π —Å—Ä–µ–∑ —Å—Ç—Ä–æ–∫–∏

**–®–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç —Å–ª–∞–π—Å—ã (`&[T]`, `&str`), –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≤–ª–∞–¥–µ—é—â–∏–µ —Ç–∏–ø—ã (`Vec<T>`, `String`). –≠—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≥–∏–±–∫–æ.

---

## üèóÔ∏è –¢–µ–º–∞ 8: –°—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –ú–µ—Ç–æ–¥—ã. –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

–°—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ Rust - —ç—Ç–æ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Python –∫–ª–∞—Å—Å–æ–≤, –≤ Rust:
- **–î–∞–Ω–Ω—ã–µ** (–ø–æ–ª—è) –∏ **–ø–æ–≤–µ–¥–µ–Ω–∏–µ** (–º–µ—Ç–æ–¥—ã) –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
- –ù–µ—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è (–µ—Å—Ç—å —Ç—Ä–µ–π—Ç—ã - –æ–± —ç—Ç–æ–º –ø–æ–∑–∂–µ)
- –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏ –∏ –≤–∏–¥–∏–º–æ—Å—Ç—å

---

### üì¶ –¢—Ä–∏ –≤–∏–¥–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä

```rust
// 1. –û–±—ã—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (named fields)
struct User {
    username: String,
    email: String,
    age: u32,
    active: bool,
}

// 2. –ö–æ—Ä—Ç–µ–∂–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (tuple struct)
struct Point(i32, i32, i32);
struct Color(u8, u8, u8);

// 3. –ï–¥–∏–Ω–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (unit struct) - –Ω–µ—Ç –ø–æ–ª–µ–π
struct Marker;
```

**–°–æ–∑–¥–∞–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```rust
// –û–±—ã—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
let user1 = User {
    username: String::from("alice"),
    email: String::from("alice@example.com"),
    age: 30,
    active: true,
};

// –î–æ—Å—Ç—É–ø –∫ –ø–æ–ª—è–º
println!("{}", user1.username);

// –ò–∑–º–µ–Ω—è–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–≤—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ mut, –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!)
let mut user2 = User {
    username: String::from("bob"),
    email: String::from("bob@example.com"),
    age: 25,
    active: false,
};

user2.age = 26; // –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å, —Ç.–∫. –≤—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ mut

// –°–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
let username = String::from("charlie");
let email = String::from("charlie@example.com");

let user3 = User {
    username,  // = username: username
    email,     // = email: email
    age: 28,
    active: true,
};

// –°–∏–Ω—Ç–∞–∫—Å–∏—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
let user4 = User {
    email: String::from("new@example.com"),
    ..user3  // –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –∏–∑ user3
    // –í–ù–ò–ú–ê–ù–ò–ï: user3.username –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è! user3 —Ç–µ–ø–µ—Ä—å —á–∞—Å—Ç–∏—á–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
};
```

**–ö–æ—Ä—Ç–µ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**

```rust
let origin = Point(0, 0, 0);
let black = Color(0, 0, 0);

// origin –∏ black - –†–ê–ó–ù–´–ï —Ç–∏–ø—ã, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É!
// let p: Point = black; // ‚ùå –û–®–ò–ë–ö–ê

// –î–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É
let x = origin.0;
let y = origin.1;

// –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è
let Point(x, y, z) = origin;
```

---

### ‚öôÔ∏è –ú–µ—Ç–æ–¥—ã –∏ –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–ª–∏—á–∏–µ:**
- **–ú–µ—Ç–æ–¥—ã** - –ø—Ä–∏–Ω–∏–º–∞—é—Ç `self` (–∏–ª–∏ `&self`, `&mut self`)
- **–ê—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç `self` (–∫–∞–∫ `@staticmethod` –≤ Python)

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    // –ê—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä)
    // –í—ã–∑–æ–≤: Rectangle::new(10, 20)
    fn new(width: u32, height: u32) -> Rectangle {
        Rectangle { width, height }
    }
    
    // –ê—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–≤–∞–¥—Ä–∞—Ç–∞
    fn square(size: u32) -> Rectangle {
        Rectangle {
            width: size,
            height: size,
        }
    }

    // –ú–µ—Ç–æ–¥ (–∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è)
    fn area(&self) -> u32 {
        self.width * self.height
    }

    // –ú–µ—Ç–æ–¥ (–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ)
    fn scale(&mut self, factor: u32) {
        self.width *= factor;
        self.height *= factor;
    }

    // –ú–µ—Ç–æ–¥ (–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ self - –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–ª–∞–¥–µ–Ω–∏—è)
    fn into_square(self) -> Rectangle {
        let size = self.width.max(self.height);
        Rectangle::square(size)
    }

    // –ú–µ—Ç–æ–¥ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    fn can_hold(&self, other: &Rectangle) -> bool {
        self.width > other.width && self.height > other.height
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
let mut rect = Rectangle::new(30, 50);
println!("Area: {}", rect.area());

rect.scale(2); // rect —Ç–µ–ø–µ—Ä—å 60x100

let rect2 = Rectangle::new(20, 40);
println!("Can hold: {}", rect.can_hold(&rect2));

// into_square() –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç rect
let square = rect.into_square();
// rect –±–æ–ª—å—à–µ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!
```

**–ü–∞—Ç—Ç–µ—Ä–Ω `&self` vs `&mut self` vs `self`:**

| –°–∏–≥–Ω–∞—Ç—É—Ä–∞ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ü—Ä–∏–º–µ—Ä |
|-----------|-------------------|--------|
| `&self` | –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ, –Ω–µ –∏–∑–º–µ–Ω—è–µ–º | `area()`, `can_hold()` |
| `&mut self` | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π | `scale()`, `update()` |
| `self` | –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ/—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è | `into_square()`, `into_iter()` |

```rust
impl Rectangle {
    // –ì–µ—Ç—Ç–µ—Ä—ã (—á–∞—Å—Ç–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞)
    fn width(&self) -> u32 {
        self.width
    }
    
    // –ú–æ–∂–Ω–æ –∏–º–µ—Ç—å –º–µ—Ç–æ–¥ –∏ –ø–æ–ª–µ —Å –æ–¥–Ω–∏–º –∏–º–µ–Ω–µ–º!
    // rect.width - –ø–æ–ª–µ
    // rect.width() - –º–µ—Ç–æ–¥
}
```

---

### üîí –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏

–í Rust –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ **–º–æ–¥—É–ª–µ–π**, –∞ –Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä.

```rust
mod user_system {
    pub struct User {
        pub username: String,  // –ø—É–±–ª–∏—á–Ω–æ–µ –ø–æ–ª–µ
        email: String,         // –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –ø–æ–ª–µ
        age: u32,              // –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –ø–æ–ª–µ
    }

    impl User {
        // –ü—É–±–ª–∏—á–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
        pub fn new(username: String, email: String, age: u32) -> User {
            User { username, email, age }
        }

        // –ü—É–±–ª–∏—á–Ω—ã–π –≥–µ—Ç—Ç–µ—Ä –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –ø–æ–ª—è
        pub fn email(&self) -> &str {
            &self.email
        }

        // –ü—É–±–ª–∏—á–Ω—ã–π —Å–µ—Ç—Ç–µ—Ä —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
        pub fn set_email(&mut self, email: String) -> Result<(), String> {
            if email.contains('@') {
                self.email = email;
                Ok(())
            } else {
                Err(String::from("Invalid email"))
            }
        }

        // –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥ (–¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è)
        fn validate(&self) -> bool {
            self.age >= 18
        }
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–Ω–µ –º–æ–¥—É–ª—è
use user_system::User;

let mut user = User::new(
    String::from("alice"),
    String::from("alice@example.com"),
    25
);

println!("{}", user.username);     // OK - –ø–æ–ª–µ –ø—É–±–ª–∏—á–Ω–æ–µ
// println!("{}", user.email);     // ‚ùå –û–®–ò–ë–ö–ê - –ø–æ–ª–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ
println!("{}", user.email());      // OK - —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥

user.set_email(String::from("newemail@example.com")).unwrap();
```

**–ü—Ä–∞–≤–∏–ª–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
- –í—Å—ë **–ø—Ä–∏–≤–∞—Ç–Ω–æ–µ** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–ø–æ–ª—è, –º–µ—Ç–æ–¥—ã, –º–æ–¥—É–ª–∏)
- `pub` –¥–µ–ª–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –ø—É–±–ª–∏—á–Ω—ã–º
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è –∏ –≤—Å–µ—Ö –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π

```rust
pub struct Config {
    pub api_key: String,
    secret: String,  // –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ - –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–Ω–µ –º–æ–¥—É–ª—è!
}

impl Config {
    // –ë–µ–∑ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
    // –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –≤–Ω–µ –º–æ–¥—É–ª—è
    pub fn new(api_key: String, secret: String) -> Config {
        Config { api_key, secret }
    }
}
```

---

### üéØ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏ impl

–ú–æ–∂–Ω–æ —Ä–∞–∑–±–∏–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–ª–æ–∫–æ–≤:

```rust
struct Point {
    x: f64,
    y: f64,
}

// –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã
impl Point {
    fn distance(&self, other: &Point) -> f64 {
        let dx = self.x - other.x;
        let dy = self.y - other.y;
        (dx * dx + dy * dy).sqrt()
    }
}

// –ú–µ—Ç–æ–¥—ã —Å–æ–∑–¥–∞–Ω–∏—è
impl Point {
    fn new(x: f64, y: f64) -> Point {
        Point { x, y }
    }
    
    fn origin() -> Point {
        Point { x: 0.0, y: 0.0 }
    }
}

// –≠—Ç–æ —á–∏—Å—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–µ - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –æ–±—ä–µ–¥–∏–Ω–∏—Ç –≤—Å—ë
```

---

### üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º

1. **–°—Ç—Ä—É–∫—Ç—É—Ä—ã** - –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (–¥–∞–Ω–Ω—ã–µ + –º–µ—Ç–æ–¥—ã)
2. **impl –±–ª–æ–∫–∏** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –¥–∞–Ω–Ω—ã—Ö
3. **&self** –¥–ª—è —á—Ç–µ–Ω–∏—è, **&mut self** –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è, **self** –¥–ª—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
4. **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è** —á–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏ –∏ `pub`, –Ω–µ —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
5. **–ê—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã –∏ —É—Ç–∏–ª–∏—Ç—ã –±–µ–∑ `self`

---

## üé≠ –¢–µ–º–∞ 9: –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –∏ Pattern Matching

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

**Enum** –≤ Rust - —ç—Ç–æ –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö (ADT). –≠—Ç–æ –ù–ï –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–æ—Ä –∫–æ–Ω—Å—Ç–∞–Ω—Ç (–∫–∞–∫ –≤ Python/C), –∞ —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–∞–∂–¥–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ.

**Pattern matching** - —ç—Ç–æ —Å–ø–æ—Å–æ–± —Ä–∞–∑–æ–±—Ä–∞—Ç—å enum –∏ –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ. –≠—Ç–æ –º–æ—â–Ω–µ–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ —á–µ–º `if/else` —Ü–µ–ø–æ—á–∫–∏.

---

### üé® –ë–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è

```rust
// –ü—Ä–æ—Å—Ç–æ–π enum (–∫–∞–∫ –≤ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö)
enum Direction {
    North,
    South,
    East,
    West,
}

let dir = Direction::North;

// Enum —Å –¥–∞–Ω–Ω—ã–º–∏ (–≤–æ—Ç —Ç—É—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –º–∞–≥–∏—è!)
enum IpAddr {
    V4(u8, u8, u8, u8),       // —Ö—Ä–∞–Ω–∏—Ç 4 —á–∏—Å–ª–∞
    V6(String),                // —Ö—Ä–∞–Ω–∏—Ç —Å—Ç—Ä–æ–∫—É
}

let home = IpAddr::V4(127, 0, 0, 1);
let loopback = IpAddr::V6(String::from("::1"));

// –ö–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã!
enum Message {
    Quit,                       // –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
    Move { x: i32, y: i32 },   // –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
    Write(String),              // –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ
    ChangeColor(i32, i32, i32), // —Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è
}

let msg1 = Message::Quit;
let msg2 = Message::Move { x: 10, y: 20 };
let msg3 = Message::Write(String::from("Hello"));
let msg4 = Message::ChangeColor(255, 0, 0);
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è:** Enum - —ç—Ç–æ "–æ–¥–Ω–æ –ò–ó", –∞ –Ω–µ "–≤—Å—ë —Å—Ä–∞–∑—É". –í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–µ—Ç –û–î–ò–ù –≤–∞—Ä–∏–∞–Ω—Ç.

```rust
// –≠—Ç–æ –∫–∞–∫ size-of —Å–∞–º–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ + —Ç–µ–≥
// sizeof(Message) = max(—Ä–∞–∑–º–µ—Ä—ã –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤) + sizeof(tag)
```

---

### üéØ Pattern Matching —Å `match`

`match` - —ç—Ç–æ **–∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∞—è** –ø—Ä–æ–≤–µ—Ä–∫–∞. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∑–∞—Å—Ç–∞–≤–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –í–°–ï –≤–∞—Ä–∏–∞–Ω—Ç—ã.

```rust
enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter,
}

fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
        // –ï—Å–ª–∏ –∑–∞–±—ã—Ç—å —Ö–æ—Ç—å –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç - –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!
    }
}

// match —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
let coin = Coin::Dime;
let cents = match coin {
    Coin::Penny => 1,
    Coin::Nickel => 5,
    Coin::Dime => 10,
    Coin::Quarter => 25,
}; // cents = 10
```

**–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ enum:**

```rust
enum IpAddr {
    V4(u8, u8, u8, u8),
    V6(String),
}

fn process_ip(ip: IpAddr) {
    match ip {
        // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –∫–æ—Ä—Ç–µ–∂–∞
        IpAddr::V4(a, b, c, d) => {
            println!("IPv4: {}.{}.{}.{}", a, b, c, d);
        }
        // –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
        IpAddr::V6(addr) => {
            println!("IPv6: {}", addr);
        }
    }
}

process_ip(IpAddr::V4(192, 168, 1, 1));
process_ip(IpAddr::V6(String::from("::1")));
```

**–°–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

fn process_message(msg: Message) {
    match msg {
        Message::Quit => {
            println!("Quit message");
        }
        // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
        Message::Move { x, y } => {
            println!("Move to ({}, {})", x, y);
        }
        // –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∏ —É—Å–ª–æ–≤–∏–µ (guard)
        Message::Write(text) if text.len() > 10 => {
            println!("Long message: {}", text);
        }
        Message::Write(text) => {
            println!("Short message: {}", text);
        }
        // –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
        Message::ChangeColor(r, _, _) => {
            println!("Red component: {}", r);
        }
    }
}
```

**–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω `_`:**

```rust
let number = 7;

match number {
    1 => println!("One"),
    2 => println!("Two"),
    3 => println!("Three"),
    _ => println!("Something else"), // "catch-all"
}

// –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
match some_value {
    Some(_) => println!("Got some value"),
    None => println!("Got nothing"),
}
```

---

### üíé Option<T> - —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π enum

`Option<T>` –≤—Å—Ç—Ä–æ–µ–Ω –≤ —è–∑—ã–∫ –∏ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ë–ï–ó null pointer.

```rust
// –û–ø—Ä–µ–¥–µ–ª—ë–Ω –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –∫–∞–∫:
enum Option<T> {
    Some(T),
    None,
}

// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ
let some_number: Option<i32> = Some(5);
let no_number: Option<i32> = None;

// Option –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ prelude - –Ω–µ –Ω—É–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
let x: Option<i32> = Some(5);
let y: Option<i32> = None;
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≥–µ–Ω–∏–∞–ª—å–Ω–æ:**

```rust
let x: i8 = 5;
let y: Option<i8> = Some(5);

// let sum = x + y; // ‚ùå –û–®–ò–ë–ö–ê! –ù–µ–ª—å–∑—è —Å–ª–æ–∂–∏—Ç—å i8 –∏ Option<i8>

// –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ó–ê–°–¢–ê–í–õ–Ø–ï–¢ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–ª—É—á–∞–π None
let sum = match y {
    Some(value) => x + value,
    None => x, // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
};
```

**–†–∞–±–æ—Ç–∞ —Å Option:**

```rust
fn divide(a: i32, b: i32) -> Option<i32> {
    if b == 0 {
        None
    } else {
        Some(a / b)
    }
}

let result = divide(10, 2);

match result {
    Some(value) => println!("Result: {}", value),
    None => println!("Cannot divide by zero"),
}

// –ú–µ—Ç–æ–¥—ã Option (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –º–Ω–æ–≥–∏—Ö)
let x: Option<i32> = Some(5);

x.is_some();           // true
x.is_none();           // false
x.unwrap();            // 5 (–ø–∞–Ω–∏–∫—É–µ—Ç –µ—Å–ª–∏ None!)
x.unwrap_or(0);        // 5, –µ—Å–ª–∏ Some; 0 –µ—Å–ª–∏ None
x.unwrap_or_else(|| 42); // 5, –µ—Å–ª–∏ Some; –≤—ã–∑–æ–≤ –∑–∞–º—ã–∫–∞–Ω–∏—è –µ—Å–ª–∏ None

// –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
x.map(|v| v * 2);      // Some(10)
x.and_then(|v| Some(v * 2)); // Some(10)
x.filter(|v| *v > 3);  // Some(5)

// –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
let y: Option<i32> = None;
y.unwrap_or(10);       // 10
```

---

### ‚ö° Result<T, E> - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

`Result<T, E>` - –≤—Ç–æ—Ä–æ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π enum –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –æ—à–∏–±–∫–æ–π.

```rust
enum Result<T, E> {
    Ok(T),   // —É—Å–ø–µ—Ö —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ç–∏–ø–∞ T
    Err(E),  // –æ—à–∏–±–∫–∞ —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ç–∏–ø–∞ E
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
use std::fs::File;
use std::io::ErrorKind;

fn open_file() -> Result<File, std::io::Error> {
    File::open("hello.txt")
}

let f = open_file();

match f {
    Ok(file) => {
        println!("File opened successfully");
    }
    Err(error) => {
        println!("Failed to open file: {}", error);
    }
}
```

**–í–ª–æ–∂–µ–Ω–Ω—ã–µ match –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:**

```rust
let f = File::open("hello.txt");

let f = match f {
    Ok(file) => file,
    Err(error) => match error.kind() {
        ErrorKind::NotFound => {
            println!("File not found, creating...");
            match File::create("hello.txt") {
                Ok(fc) => fc,
                Err(e) => panic!("Can't create file: {:?}", e),
            }
        }
        other_error => {
            panic!("Error opening file: {:?}", other_error);
        }
    }
};
```

**–°–æ–∫—Ä–∞—â–µ–Ω–∏—è –¥–ª—è Result:**

```rust
let f = File::open("hello.txt").unwrap(); // –ø–∞–Ω–∏–∫—É–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ

let f = File::open("hello.txt")
    .expect("Failed to open file"); // –ø–∞–Ω–∏–∫—É–µ—Ç —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º

// ? –æ–ø–µ—Ä–∞—Ç–æ—Ä - —Ä–∞–Ω–Ω–µ–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
fn read_username() -> Result<String, io::Error> {
    let mut f = File::open("username.txt")?; // –µ—Å–ª–∏ Err - –≤–æ–∑–≤—Ä–∞—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
    let mut s = String::new();
    f.read_to_string(&mut s)?; // –µ—Å–ª–∏ Err - –≤–æ–∑–≤—Ä–∞—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
    Ok(s)
}

// ? –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö Result –∏–ª–∏ Option
```

---

### üîç if let –∏ while let - —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π matching

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –¢–û–õ–¨–ö–û –æ–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω:

```rust
let some_value: Option<i32> = Some(3);

// –í–º–µ—Å—Ç–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ–≥–æ match:
match some_value {
    Some(3) => println!("three"),
    _ => (), // –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω–æ–µ
}

// –ò—Å–ø–æ–ª—å–∑—É–µ–º if let:
if let Some(3) = some_value {
    println!("three");
}

// –° else:
if let Some(value) = some_value {
    println!("Value: {}", value);
} else {
    println!("No value");
}
```

**while let –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏:**

```rust
let mut stack = vec![1, 2, 3];

while let Some(top) = stack.pop() {
    println!("{}", top);
}
// –í—ã–≤–µ–¥–µ—Ç: 3, 2, 1
```

---

### üõ†Ô∏è –ú–µ—Ç–æ–¥—ã –¥–ª—è Enum

Enum –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –º–µ—Ç–æ–¥—ã —Ç–∞–∫ –∂–µ –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
}

impl Message {
    fn call(&self) {
        match self {
            Message::Quit => println!("Quitting"),
            Message::Move { x, y } => println!("Moving to ({}, {})", x, y),
            Message::Write(text) => println!("Writing: {}", text),
        }
    }

    fn is_quit(&self) -> bool {
        matches!(self, Message::Quit)
    }
}

let msg = Message::Write(String::from("Hello"));
msg.call(); // "Writing: Hello"
```

---

### üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ Enum –∏ Pattern Matching

1. **Enum** - –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
2. **match** - –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤
3. **Option<T>** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ null
4. **Result<T, E>** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
5. **if let / while let** - —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞
6. **? –æ–ø–µ—Ä–∞—Ç–æ—Ä** - –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤–≤–µ—Ä—Ö

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ó–ê–°–¢–ê–í–õ–Ø–ï–¢ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ —Å–ª—É—á–∞–∏. –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–±—ã—Ç—å –ø—Ä–æ –æ—à–∏–±–∫—É –∏–ª–∏ None.

---

## üéØ –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å (1-3)

1. **–í —á—ë–º –≥–ª–∞–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –º–µ–∂–¥—É `Vec<T>` –∏ `[T; N]`?** –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö?

2. **–ü–æ—á–µ–º—É –≤ Rust –Ω–µ–ª—å–∑—è –Ω–∞–ø—Ä—è–º—É—é –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É `s[0]`?** –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π —Å–∏–º–≤–æ–ª?

3. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `&self`, `&mut self` –∏ `self` –≤ –º–µ—Ç–æ–¥–∞—Ö?** –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ.

### –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (4-7)

4. **–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–∞–π—Å —á–∏—Å–µ–ª –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Option —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º.** –ü–æ—á–µ–º—É –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å Option, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ?

5. **–û–±—ä—è—Å–Ω–∏, —á—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç —Å —ç—Ç–∏–º –∫–æ–¥–æ–º –∏ –ø–æ—á–µ–º—É:**
   ```rust
   let mut v = vec![1, 2, 3];
   let first = &v[0];
   v.push(4);
   println!("{}", first);
   ```

6. **–°–æ–∑–¥–∞–π enum `Shape` —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ `Circle(f64)`, `Rectangle(f64, f64)`, `Triangle(f64, f64, f64)`.** –ù–∞–ø–∏—à–∏ –º–µ—Ç–æ–¥ `area()` –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø–ª–æ—â–∞–¥–∏.

7. **–ß–µ–º `if let Some(x) = value` –ª—É—á—à–µ —á–µ–º `match value { Some(x) => ..., None => () }`?** –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç?

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å (8-10)

8. **–†–∞–∑—Ä–∞–±–æ—Ç–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É `Stack<T>` —Å –º–µ—Ç–æ–¥–∞–º–∏ `push`, `pop`, –∏ `peek`.** `pop` –∏ `peek` –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `Option<T>`. –û–±—ä—è—Å–Ω–∏ –≤—ã–±–æ—Ä —Å–∏–≥–Ω–∞—Ç—É—Ä –º–µ—Ç–æ–¥–æ–≤.

9. **–û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è –ø–æ–¥—Ö–æ–¥–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:**
   ```rust
   // –í–∞—Ä–∏–∞–Ω—Ç 1
   let file = File::open("file.txt").unwrap();
   
   // –í–∞—Ä–∏–∞–Ω—Ç 2
   let file = match File::open("file.txt") {
       Ok(f) => f,
       Err(e) => return Err(e),
   };
   
   // –í–∞—Ä–∏–∞–Ω—Ç 3
   let file = File::open("file.txt")?;
   ```
   –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π?

10. **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è HTTP –∑–∞–ø—Ä–æ—Å–∞:** –ò—Å–ø–æ–ª—å–∑—É–π enum –¥–ª—è –º–µ—Ç–æ–¥–æ–≤ (GET, POST, PUT, DELETE), struct –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ (–º–µ—Ç–æ–¥, –ø—É—Ç—å, –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Ç–µ–ª–æ). –†–µ–∞–ª–∏–∑—É–π –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è GET –∑–∞–ø—Ä–æ—Å–∞ –∏ –º–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–ø—Ä–æ—Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º (GET –∏–ª–∏ HEAD).

---

## üéì –§–∏–Ω–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏

–≠—Ç–∏ —Ç—Ä–∏ —Ç–µ–º—ã - **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç Rust**:

- **–ö–æ–ª–ª–µ–∫—Ü–∏–∏** - –∫–∞–∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ (–≤–ª–∞–¥–µ–Ω–∏–µ vs –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ)
- **–°—Ç—Ä—É–∫—Ç—É—Ä—ã** - –∫–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –∫–æ–¥ (–¥–∞–Ω–Ω—ã–µ + –ø–æ–≤–µ–¥–µ–Ω–∏–µ)
- **Enum + Pattern Matching** - –∫–∞–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã (–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä = –∑–∞—â–∏—Ç–Ω–∞—è —Å–µ—Ç–∫–∞)

–ö–ª—é—á–µ–≤–∞—è —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è Rust: **–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø–æ–º–æ–≥–∞–µ—Ç –ø–∏—Å–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ–¥**. –ï—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –¥–æ–≤–æ–ª–µ–Ω - –∫–æ–¥ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.

---

## üéØ –¢–µ–º–∞ 10: –í–≤–µ–¥–µ–Ω–∏–µ –≤ –°–∏—Å—Ç–µ–º—É –¢–∏–ø–æ–≤. Result, Option, ()

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

–°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤ Rust - —ç—Ç–æ **–∫–æ–Ω—Ç—Ä–∞–∫—Ç –º–µ–∂–¥—É —Ç–æ–±–æ–π –∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º**. –¢–∏–ø—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ–ø–∏—Å—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ, –æ–Ω–∏ **–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å** –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Python:**
```python
# Python - —É—Ç–∏–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ runtime
def divide(a, b):
    return a / b  # —É–ø–∞–¥—ë—Ç –≤ runtime –ø—Ä–∏ b=0

result = divide(10, 0)  # ZeroDivisionError
```

```rust
// Rust - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫–∏
fn divide(a: i32, b: i32) -> Option<i32> {
    if b == 0 {
        None
    } else {
        Some(a / b)
    }
}

// –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ù–ï –ø–æ–∑–≤–æ–ª–∏—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å None!
```

---

### üß© –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã

```rust
// –¶–µ–ª—ã–µ —á–∏—Å–ª–∞ (signed)
let a: i8 = -128;      // –æ—Ç -128 –¥–æ 127
let b: i16 = -32768;   // –æ—Ç -32,768 –¥–æ 32,767
let c: i32 = 42;       // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ü–µ–ª—ã—Ö
let d: i64 = 1000;
let e: i128 = 1_000_000;

// –¶–µ–ª—ã–µ —á–∏—Å–ª–∞ (unsigned)
let f: u8 = 255;       // –æ—Ç 0 –¥–æ 255
let g: u16 = 65535;
let h: u32 = 4_294_967_295;
let i: u64 = 18_446_744_073_709_551_615;

// –î–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: 32bit –∏–ª–∏ 64bit)
let j: usize = 100;    // –∏–Ω–¥–µ–∫—Å—ã, —Ä–∞–∑–º–µ—Ä—ã –∫–æ–ª–ª–µ–∫—Ü–∏–π
let k: isize = -50;

// –ß–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
let pi: f32 = 3.14;
let e: f64 = 2.71828;  // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è float

// –ë—É–ª–µ–≤—ã
let is_active: bool = true;
let is_valid: bool = false;

// –°–∏–º–≤–æ–ª—ã (Unicode scalar value, 4 –±–∞–π—Ç–∞!)
let c: char = 'z';
let emoji: char = 'üòé';
let cyrillic: char = '–Ø';
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** Rust –ù–ï –¥–µ–ª–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤!

```rust
let x: i32 = 5;
let y: i64 = 10;

// let sum = x + y; // ‚ùå –û–®–ò–ë–ö–ê! –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã
let sum = x as i64 + y; // ‚úÖ –Ø–≤–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ

// –î–∞–∂–µ —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
let a: f32 = 3.0;
let b: f64 = 4.0;
// let c = a + b; // ‚ùå –û–®–ò–ë–ö–ê!
let c = a as f64 + b; // ‚úÖ
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ö–æ—Ä–æ—à–æ?** –ù–∏–∫–∞–∫–∏—Ö —Å—é—Ä–ø—Ä–∏–∑–æ–≤. –ï—Å–ª–∏ –∫–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è - –æ–Ω –¥–µ–ª–∞–µ—Ç –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ —Ç—ã –Ω–∞–ø–∏—Å–∞–ª.

---

### üíé Unit Type: ()

`()` - —ç—Ç–æ **–µ–¥–∏–Ω–∏—á–Ω—ã–π —Ç–∏–ø** (unit type). –£ –Ω–µ–≥–æ —Ä–æ–≤–Ω–æ –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ: `()`.

**–ó–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω?**

```rust
// –§—É–Ω–∫—Ü–∏—è –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
fn print_message(msg: &str) {
    println!("{}", msg);
    // –Ω–µ—è–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ()
}

// –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ:
fn print_message_explicit(msg: &str) -> () {
    println!("{}", msg);
    ()
}

// () –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ, –≥–¥–µ "–Ω–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è"
let result: () = {
    let x = 5;
    let y = 10;
    // –±–ª–æ–∫ –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
};

// –ü—É—Å—Ç–æ–π –∫–æ—Ä—Ç–µ–∂
let empty: () = ();
```

**–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Result/Option:**

```rust
// Result<(), Error> - –æ–ø–µ—Ä–∞—Ü–∏—è –ª–∏–±–æ —É—Å–ø–µ—à–Ω–∞ (–±–µ–∑ –¥–∞–Ω–Ω—ã—Ö), –ª–∏–±–æ –æ—à–∏–±–∫–∞
fn write_file(path: &str, content: &str) -> Result<(), std::io::Error> {
    std::fs::write(path, content)?;
    Ok(()) // —É—Å–ø–µ—Ö, –Ω–æ –Ω–µ—Ç –ø–æ–ª–µ–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
}

// Option<()> - –ª–∏–±–æ "—á—Ç–æ-—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ", –ª–∏–±–æ –Ω–µ—Ç
fn check_cache() -> Option<()> {
    if cache_is_valid() {
        Some(()) // –¥–∞, –∫—ç—à –≤–∞–ª–∏–¥–µ–Ω
    } else {
        None
    }
}
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä:**

```rust
use std::collections::HashMap;

let mut map: HashMap<String, ()> = HashMap::new();
map.insert("visited".to_string(), ());
map.insert("seen".to_string(), ());

// –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ Set! –ó–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –≤–∞–∂–Ω–æ, –≤–∞–∂–Ω–æ –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞
if map.contains_key("visited") {
    println!("Already visited");
}
```

---

### üéÅ Option<T> - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ó–Ω–∞—á–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞ –≤ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö:**
```python
# Python
def find_user(id):
    if id in users:
        return users[id]
    return None  # –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None

user = find_user(123)
print(user.name)  # üí• AttributeError –µ—Å–ª–∏ None!
```

**–†–µ—à–µ–Ω–∏–µ Rust:**
```rust
fn find_user(id: u32) -> Option<User> {
    if let Some(user) = users.get(&id) {
        Some(user.clone())
    } else {
        None
    }
}

// –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ó–ê–°–¢–ê–í–ò–¢ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å None
let user = find_user(123);
match user {
    Some(u) => println!("Name: {}", u.name),
    None => println!("User not found"),
}
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Option:**

```rust
// –£–ø—Ä–æ—â—ë–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
pub enum Option<T> {
    None,
    Some(T),
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
let some_number: Option<i32> = Some(5);
let no_number: Option<i32> = None;

// Option –∑–∞–Ω–∏–º–∞–µ—Ç –ø–∞–º—è—Ç—å –∫–∞–∫ T + –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç (–æ–±—ã—á–Ω–æ 1 –±–∞–π—Ç)
// –ù–æ –¥–ª—è Option<&T> –∏ Option<Box<T>> –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
// None –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∫–∞–∫ null pointer - —Ä–∞–∑–º–µ—Ä = sizeof(T)!
```

**–ú–µ—Ç–æ–¥—ã Option - —Ç–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π:**

```rust
let x: Option<i32> = Some(5);
let y: Option<i32> = None;

// –ü—Ä–æ–≤–µ—Ä–∫–∞
x.is_some();  // true
x.is_none();  // false
y.is_some();  // false
y.is_none();  // true

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (–û–ü–ê–°–ù–û - –º–æ–∂–µ—Ç –ø–∞–Ω–∏–∫–æ–≤–∞—Ç—å!)
x.unwrap();              // 5
// y.unwrap();           // üí• –ü–ê–ù–ò–ö–ê!

// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
x.unwrap_or(0);          // 5
y.unwrap_or(0);          // 0

x.unwrap_or_else(|| {
    // –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ None
    expensive_computation()
});

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ
if let Some(value) = x {
    println!("Got: {}", value);
}

// –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å)
let doubled = x.map(|v| v * 2);  // Some(10)
let doubled_none = y.map(|v| v * 2); // None

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
let big = x.filter(|v| *v > 3);  // Some(5)
let small = x.filter(|v| *v > 10); // None

// –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã
x.and(Some(10));     // Some(10) –µ—Å–ª–∏ x = Some, –∏–Ω–∞—á–µ None
x.or(Some(10));      // Some(5) –µ—Å–ª–∏ x = Some, –∏–Ω–∞—á–µ Some(10)

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Option<Option<T>> -> Option<T>
let nested: Option<Option<i32>> = Some(Some(5));
nested.flatten();    // Some(5)
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω - –º–µ—Ç–æ–¥ —Ü–µ–ø–æ—á–µ–∫:**

```rust
fn get_user_email(user_id: u32) -> Option<String> {
    find_user(user_id)
        .map(|user| user.profile)    // Option<Profile>
        .and_then(|profile| profile.email) // Option<String>
        .filter(|email| email.contains('@'))
}

// –ï—Å–ª–∏ —Ö–æ—Ç—å –æ–¥–∏–Ω —à–∞–≥ –≤–µ—Ä–Ω—ë—Ç None - –≤—Å—è —Ü–µ–ø–æ—á–∫–∞ –≤–µ—Ä–Ω—ë—Ç None
```

---

### ‚ö° Result<T, E> - –û–±—Ä–∞–±–æ—Ç–∫–∞ –û—à–∏–±–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞ –≤ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö:**
```python
# Python - –∏—Å–∫–ª—é—á–µ–Ω–∏—è "–Ω–µ–≤–∏–¥–∏–º—ã" –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ
def read_config(path: str) -> dict:
    with open(path) as f:  # –º–æ–∂–µ—Ç –±—Ä–æ—Å–∏—Ç—å FileNotFoundError
        return json.load(f)  # –º–æ–∂–µ—Ç –±—Ä–æ—Å–∏—Ç—å JSONDecodeError
    # –í—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥ –Ω–µ –∑–Ω–∞–µ—Ç –æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö!
```

**–†–µ—à–µ–Ω–∏–µ Rust:**
```rust
use std::fs;
use std::io;

// –û—à–∏–±–∫–∞ —è–≤–Ω–æ –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ!
fn read_config(path: &str) -> Result<String, io::Error> {
    fs::read_to_string(path) // Result<String, io::Error>
}

// –í—ã–∑—ã–≤–∞—é—â–∏–π –û–ë–Ø–ó–ê–ù –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É
match read_config("config.json") {
    Ok(content) => println!("Config: {}", content),
    Err(e) => eprintln!("Error: {}", e),
}
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Result:**

```rust
// –£–ø—Ä–æ—â—ë–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ std
pub enum Result<T, E> {
    Ok(T),   // —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    Err(E),  // –æ—à–∏–±–∫–∞
}

// –ü—Ä–∏–º–µ—Ä—ã —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
type IoResult<T> = Result<T, io::Error>;
type ParseResult<T> = Result<T, ParseError>;

// –ö–∞—Å—Ç–æ–º–Ω–∞—è –æ—à–∏–±–∫–∞
#[derive(Debug)]
enum MyError {
    NotFound,
    PermissionDenied,
    InvalidFormat(String),
}

fn process() -> Result<Data, MyError> {
    if !exists() {
        return Err(MyError::NotFound);
    }
    Ok(data)
}
```

**–ú–µ—Ç–æ–¥—ã Result:**

```rust
let ok: Result<i32, &str> = Ok(5);
let err: Result<i32, &str> = Err("error");

// –ü—Ä–æ–≤–µ—Ä–∫–∞
ok.is_ok();   // true
ok.is_err();  // false
err.is_ok();  // false
err.is_err(); // true

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (–û–ü–ê–°–ù–û!)
ok.unwrap();              // 5
// err.unwrap();          // üí• –ü–ê–ù–ò–ö–ê —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ—à–∏–±–∫–∏

ok.unwrap_or(0);          // 5
err.unwrap_or(0);         // 0

ok.expect("Should be ok"); // 5
// err.expect("Custom msg"); // üí• –ü–ê–ù–ò–ö–ê —Å "Custom msg"

// –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
ok.map(|v| v * 2);        // Ok(10)
err.map(|v| v * 2);       // Err("error") - –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

// –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—à–∏–±–∫–∏
err.map_err(|e| format!("Error: {}", e));
// Err("Error: error")

// –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã
ok.and(Ok(10));           // Ok(10)
err.and(Ok(10));          // Err("error")

ok.or(Ok(10));            // Ok(5)
err.or(Ok(10));           // Ok(10)

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Result -> Option
ok.ok();                  // Some(5)
err.ok();                 // None

ok.err();                 // None
err.err();                // Some("error")
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω - —Ü–µ–ø–æ—á–∫–∏ Result:**

```rust
fn load_and_parse() -> Result<Config, Box<dyn std::error::Error>> {
    let content = fs::read_to_string("config.json")?; // Result<String, io::Error>
    let config: Config = serde_json::from_str(&content)?; // Result<Config, serde_json::Error>
    Ok(config)
}

// ? –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫ –≤ Box<dyn Error>
```

---

### üîÑ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ Option –∏ Result

```rust
// Option -> Result
let opt: Option<i32> = Some(5);
let res: Result<i32, &str> = opt.ok_or("value not found");

// Result -> Option
let res: Result<i32, &str> = Ok(5);
let opt: Option<i32> = res.ok();

// –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä
fn get_config_value(key: &str) -> Result<String, String> {
    let config = load_config()?; // Result
    config
        .get(key)                // Option
        .cloned()
        .ok_or_else(|| format!("Key '{}' not found", key)) // Option -> Result
}
```

**–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**

```rust
// Option<Result<T, E>> -> Result<Option<T>, E>
let opt_res: Option<Result<i32, &str>> = Some(Ok(5));
let res_opt: Result<Option<i32>, &str> = opt_res.transpose();

// –ó–∞—á–µ–º? –ö–æ–≥–¥–∞ —Ö–æ—á–µ—à—å "–≤—ã—Ç–∞—â–∏—Ç—å" –æ—à–∏–±–∫—É –Ω–∞—Ä—É–∂—É
fn process_batch(items: Vec<Option<String>>) -> Result<Vec<String>, Error> {
    items
        .into_iter()
        .map(|opt| {
            opt.map(|s| parse(&s)) // Option<Result<T, E>>
               .transpose()         // Result<Option<T>, E>
        })
        .collect() // Result —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –æ—à–∏–±–∫–∏
}
```

---

### üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è —Å–∏—Å—Ç–µ–º—ã —Ç–∏–ø–æ–≤ Rust

**"Parse, don't validate" (–ê–ª–µ–∫—Å–∏—Å –ö–∏–Ω–≥)**

‚ùå **–ü–ª–æ—Ö–æ (validate):**
```rust
fn process_age(age: i32) {
    assert!(age >= 0 && age <= 150);
    // ... –∏—Å–ø–æ–ª—å–∑—É–µ–º age
}
// –ü—Ä–æ–±–ª–µ–º–∞: –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
```

‚úÖ **–•–æ—Ä–æ—à–æ (parse):**
```rust
struct Age(u8); // –Ω–æ–≤—ã–π —Ç–∏–ø, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å

impl Age {
    fn new(value: u8) -> Option<Self> {
        if value <= 150 {
            Some(Age(value))
        } else {
            None
        }
    }
}

fn process_age(age: Age) {
    // age –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤–∞–ª–∏–¥–µ–Ω!
}

// –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π Age –Ω–∞–ø—Ä—è–º—É—é
```

**–¢–∏–ø—ã –∫–æ–¥–∏—Ä—É—é—Ç –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:**

```rust
// –í–º–µ—Å—Ç–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ "–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –ø—É—Å—Ç—ã–º"
struct NonEmptyVec<T> {
    first: T,
    rest: Vec<T>,
}

impl<T> NonEmptyVec<T> {
    fn new(first: T) -> Self {
        NonEmptyVec { first, rest: vec![] }
    }
    
    // –í—Å–µ–≥–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ - –≥–∞—Ä–∞–Ω—Ç–∏—è –≤ —Ç–∏–ø–µ!
    fn head(&self) -> &T {
        &self.first
    }
}
```

---

## üî• –¢–µ–º–∞ 11: –õ—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏–∏ (–ó–∞–º—ã–∫–∞–Ω–∏—è)

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

**–ó–∞–º—ã–∫–∞–Ω–∏–µ (closure)** - —ç—Ç–æ –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç **–∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** –∏–∑ –æ–∫—Ä—É–∂–∞—é—â–µ–≥–æ scope.

**–û—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:**
```rust
// –û–±—ã—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –ù–ï –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
fn add_one(x: i32) -> i32 {
    x + 1
}

// –ó–∞–º—ã–∫–∞–Ω–∏–µ - –ú–û–ñ–ï–¢ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å
let num = 5;
let add_num = |x| x + num; // –∑–∞—Ö–≤–∞—Ç–∏–ª–∏ num –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
println!("{}", add_num(3)); // 8
```

---

### üìù –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∑–∞–º—ã–∫–∞–Ω–∏–π

```rust
// –ü–æ–ª–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å (—Ä–µ–¥–∫–æ –Ω—É–∂–µ–Ω)
let add = |x: i32, y: i32| -> i32 { x + y };

// –¢–∏–ø—ã –≤—ã–≤–æ–¥—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
let add = |x, y| { x + y };

// –ï—Å–ª–∏ –æ–¥–Ω–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ - —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏ –Ω–µ –Ω—É–∂–Ω—ã
let add = |x, y| x + y;

// –ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
let get_five = || 5;

// –û–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä
let double = |x| x * 2;

// –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ —Ç–µ–ª–æ
let complex = |x| {
    let temp = x * 2;
    let result = temp + 10;
    result
};
```

**–í—ã–≤–æ–¥ —Ç–∏–ø–æ–≤:**

```rust
// –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ —Ç–∏–ø—ã "–∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—é—Ç—Å—è"
let add = |x, y| x + y;

let a = add(1, 2);      // —Ç–∏–ø—ã –≤—ã–≤–µ–¥–µ–Ω—ã –∫–∞–∫ i32
// let b = add(1.0, 2.0); // ‚ùå –û–®–ò–ë–ö–ê! –¢–∏–ø—ã —É–∂–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ i32

// –î–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –Ω—É–∂–Ω—ã —Ä–∞–∑–Ω—ã–µ –∑–∞–º—ã–∫–∞–Ω–∏—è
let add_int = |x: i32, y: i32| x + y;
let add_float = |x: f64, y: f64| x + y;
```

---

### üé£ –ó–∞—Ö–≤–∞—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞

Rust –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç **–º–∏–Ω–∏–º–∞–ª—å–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π** —Å–ø–æ—Å–æ–± –∑–∞—Ö–≤–∞—Ç–∞.

**1. –ó–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ (&T) - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**

```rust
let numbers = vec![1, 2, 3];

// –ó–∞—Ö–≤–∞—Ç –ø–æ —Å—Å—ã–ª–∫–µ - numbers –æ—Å—Ç–∞—ë—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º
let print_first = || {
    println!("First: {}", numbers[0]);
};

print_first();
println!("{:?}", numbers); // ‚úÖ numbers –≤—Å—ë –µ—â—ë –¥–æ—Å—Ç—É–ø–µ–Ω
```

**2. –ò–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ (&mut T)**

```rust
let mut counter = 0;

// –ó–∞—Ö–≤–∞—Ç –ø–æ –∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ - –∑–∞–º—ã–∫–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å mut
let mut increment = || {
    counter += 1;
};

increment();
increment();
println!("Counter: {}", counter); // 2
```

**3. –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ (T) - —Å move**

```rust
let numbers = vec![1, 2, 3];

// move –ó–ê–°–¢–ê–í–õ–Ø–ï–¢ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å ownership
let consume = move || {
    println!("Consumed: {:?}", numbers);
    // numbers —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∑–∞–º—ã–∫–∞–Ω–∏—é
};

consume();
// println!("{:?}", numbers); // ‚ùå –û–®–ò–ë–ö–ê! numbers –ø–µ—Ä–µ–º–µ—â—ë–Ω
```

**–ö–æ–≥–¥–∞ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞–∂–¥—ã–π —Å–ø–æ—Å–æ–±:**

```rust
let s = String::from("hello");

// –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ -> –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ &T
let closure1 = || println!("{}", s);

// –ò–∑–º–µ–Ω–µ–Ω–∏–µ -> &mut T
let mut s = String::from("hello");
let mut closure2 = || s.push_str(" world");

// –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—Ä—É–∂—É -> T
let s = String::from("hello");
let closure3 = || s; // –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç String
let owned = closure3();
// closure3(); // ‚ùå –û–®–ò–ë–ö–ê! s —É–∂–µ –ø–µ—Ä–µ–º–µ—â—ë–Ω –ø–µ—Ä–≤—ã–º –≤—ã–∑–æ–≤–æ–º
```

---

### üß¨ –¢—Ä–µ–π—Ç—ã –∑–∞–º—ã–∫–∞–Ω–∏–π: Fn, FnMut, FnOnce

–ö–∞–∂–¥–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–µ–π—Ç–æ–≤:

```rust
// FnOnce - –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –û–î–ò–ù —Ä–∞–∑ (–ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
// FnMut  - –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑ —Å –∏–∑–º–µ–Ω—è–µ–º—ã–º –¥–æ—Å—Ç—É–ø–æ–º
// Fn     - –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑ —Å –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º –¥–æ—Å—Ç—É–ø–æ–º

// –ò–µ—Ä–∞—Ä—Ö–∏—è: Fn : FnMut : FnOnce
// –ï—Å–ª–∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç Fn -> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç FnMut –∏ FnOnce
```

**FnOnce - —Ä–∞–∑–æ–≤–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ:**

```rust
let s = String::from("hello");

// –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç s –ø—Ä–∏ –≤—ã–∑–æ–≤–µ
let consume = move || {
    drop(s); // —è–≤–Ω–æ –ø–æ—Ç—Ä–µ–±–ª—è–µ–º s
};

consume(); // –ø–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ - OK
// consume(); // ‚ùå –û–®–ò–ë–ö–ê! –Ω–µ–ª—å–∑—è –≤—ã–∑–≤–∞—Ç—å –¥–≤–∞–∂–¥—ã

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è FnOnce
fn call_once<F>(f: F) where F: FnOnce() {
    f(); // –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
}
```

**FnMut - –∏–∑–º–µ–Ω—è—é—â–µ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ:**

```rust
let mut counter = 0;

let mut increment = || {
    counter += 1;
    counter
};

println!("{}", increment()); // 1
println!("{}", increment()); // 2

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è FnMut
fn call_twice<F>(mut f: F) where F: FnMut() -> i32 {
    println!("{}", f());
    println!("{}", f());
}

call_twice(increment);
```

**Fn - –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ:**

```rust
let x = 5;

let read_x = || x; // —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç

println!("{}", read_x()); // 5
println!("{}", read_x()); // 5 - –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è Fn
fn call_many<F>(f: F) where F: Fn() -> i32 {
    for _ in 0..10 {
        println!("{}", f());
    }
}

call_many(read_x);
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä:**

```rust
// Iterator::map —Ç—Ä–µ–±—É–µ—Ç Fn (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–Ω–æ–≥–æ —Ä–∞–∑, –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç)
let numbers = vec![1, 2, 3];
let doubled: Vec<_> = numbers.iter().map(|x| x * 2).collect();

// Iterator::for_each –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å FnMut
let mut sum = 0;
numbers.iter().for_each(|x| sum += x);

// Thread::spawn —Ç—Ä–µ–±—É–µ—Ç FnOnce + Send (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ç–æ–∫–µ –æ–¥–∏–Ω —Ä–∞–∑)
use std::thread;

let s = String::from("hello");
thread::spawn(move || {
    println!("{}", s);
}).join().unwrap();
```

---

### üé® –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**1. –ö–æ–ª–±—ç–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:**

```rust
fn on_event<F>(callback: F) 
where
    F: Fn(Event) -> ()
{
    let event = get_event();
    callback(event);
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
on_event(|e| {
    println!("Got event: {:?}", e);
});
```

**2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π:**

```rust
let numbers = vec![1, 2, 3, 4, 5];

// map - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
let doubled: Vec<_> = numbers.iter()
    .map(|x| x * 2)
    .collect();

// filter - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
let evens: Vec<_> = numbers.iter()
    .filter(|x| *x % 2 == 0)
    .collect();

// fold - —Å–≤—ë—Ä—Ç–∫–∞
let sum = numbers.iter()
    .fold(0, |acc, x| acc + x);

// –¶–µ–ø–æ—á–∫–∏
let result: Vec<_> = numbers.iter()
    .filter(|x| *x % 2 == 0)
    .map(|x| x * x)
    .collect();
```

**3. –õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:**

```rust
fn expensive_operation() -> i32 {
    println!("Computing...");
    42
}

// –í–∞—Ä–∏–∞–Ω—Ç 1: eager - –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É
let value = expensive_operation();

// –í–∞—Ä–∏–∞–Ω—Ç 2: lazy - –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ
let compute = || expensive_operation();
// –ù–∏—á–µ–≥–æ –Ω–µ –≤—ã—á–∏—Å–ª–∏–ª–æ—Å—å!

if need_value {
    let value = compute(); // —Ç–æ–ª—å–∫–æ –∑–¥–µ—Å—å –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è
}
```

**4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ builder –ø–∞—Ç—Ç–µ—Ä–Ω:**

```rust
struct HttpClient {
    timeout: u64,
    retries: u32,
}

impl HttpClient {
    fn new() -> Self {
        HttpClient {
            timeout: 30,
            retries: 3,
        }
    }
    
    fn configure<F>(mut self, config: F) -> Self 
    where
        F: FnOnce(&mut Self)
    {
        config(&mut self);
        self
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
let client = HttpClient::new()
    .configure(|c| {
        c.timeout = 60;
        c.retries = 5;
    });
```

**5. –ö–∞—Å—Ç–æ–º–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:**

```rust
let mut people = vec![
    Person { name: "Alice", age: 30 },
    Person { name: "Bob", age: 25 },
];

// –ü–æ –≤–æ–∑—Ä–∞—Å—Ç—É
people.sort_by(|a, b| a.age.cmp(&b.age));

// –ü–æ –∏–º–µ–Ω–∏
people.sort_by_key(|p| &p.name);

// –ö–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞
people.sort_by(|a, b| {
    match a.age.cmp(&b.age) {
        std::cmp::Ordering::Equal => a.name.cmp(&b.name),
        other => other,
    }
});
```

---

### ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏

**1. –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫:**

```rust
fn create_closure() -> impl Fn() -> i32 {
    let x = 5;
    // ‚ùå –û–®–ò–ë–ö–ê! x –Ω–µ –∂–∏–≤—ë—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ
    // || x
    
    // ‚úÖ –†–µ—à–µ–Ω–∏–µ: move
    move || x // —Ç–µ–ø–µ—Ä—å x –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∑–∞–º—ã–∫–∞–Ω–∏—é
}
```

**2. –¢–∏–ø –∑–∞–º—ã–∫–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```rust
let mut x = 5;
let closure = || x; // —Ç–∏–ø –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è x

// –ï—Å–ª–∏ –¥–æ–±–∞–≤–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ:
let mut x = 5;
let mut closure = || {
    x += 1; // —Ç–µ–ø–µ—Ä—å –∑–∞–º—ã–∫–∞–Ω–∏–µ FnMut, –Ω–µ Fn!
    x
};
```

**3. move –∏ Copy —Ç–∏–ø—ã:**

```rust
let x = 5; // i32 implements Copy

let closure = move || x;
println!("{}", x); // ‚úÖ OK! i32 –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è

let s = String::from("hello"); // String –ù–ï Copy
let closure = move || s;
// println!("{}", s); // ‚ùå –û–®–ò–ë–ö–ê! s –ø–µ—Ä–µ–º–µ—â—ë–Ω
```

---

## üö® –¢–µ–º–∞ 12: –û–±—Ä–∞–±–æ—Ç–∫–∞ –û—à–∏–±–æ–∫. –û–ø–µ—Ä–∞—Ç–æ—Ä ?. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Result, Option

### üîë –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

Rust –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—è–≤–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫** —á–µ—Ä–µ–∑ —Ç–∏–ø Result. –ù–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π (exceptions), –Ω–µ—Ç —Å–∫—Ä—ã—Ç–æ–≥–æ control flow.

**–§–∏–ª–æ—Å–æ—Ñ–∏—è:** –û—à–∏–±–∫–∏ - —ç—Ç–æ —á–∞—Å—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –Ω–µ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è.

---

### ‚ö° –û–ø–µ—Ä–∞—Ç–æ—Ä ? - –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

–û–ø–µ—Ä–∞—Ç–æ—Ä `?` - —ç—Ç–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –¥–ª—è —Ä–∞–Ω–Ω–µ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ.

**–ë–µ–∑ ?:**

```rust
fn read_username() -> Result<String, io::Error> {
    let f = File::open("username.txt");
    
    let mut f = match f {
        Ok(file) => file,
        Err(e) => return Err(e), // —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ
    };
    
    let mut s = String::new();
    
    match f.read_to_string(&mut s) {
        Ok(_) => Ok(s),
        Err(e) => Err(e),
    }
}
```

**–° ? (—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–π –∫–æ–¥):**

```rust
fn read_username() -> Result<String, io::Error> {
    let mut f = File::open("username.txt")?; // –µ—Å–ª–∏ Err - —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç
    let mut s = String::new();
    f.read_to_string(&mut s)?; // –µ—Å–ª–∏ Err - —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç
    Ok(s)
}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ?:**

```rust
// expression? —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤:
match expression {
    Ok(value) => value,
    Err(e) => return Err(From::from(e)), // –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è –æ—à–∏–±–æ–∫!
}
```

---

### üîÑ ? —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –æ—à–∏–±–æ–∫

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è:**

```rust
use std::fs::File;
use std::io::{self, Read};

// –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Box<dyn Error> - –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ª—é–±—É—é –æ—à–∏–±–∫—É
fn run() -> Result<(), Box<dyn std::error::Error>> {
    let mut f = File::open("data.txt")?;    // io::Error
    let mut s = String::new();
    f.read_to_string(&mut s)?;              // io::Error
    
    let num: i32 = s.trim().parse()?;       // ParseIntError
    // ? –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –≤ Box<dyn Error>
    
    Ok(())
}
```

**–ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è —Å From:**

```rust
#[derive(Debug)]
enum MyError {
    Io(io::Error),
    Parse(std::num::ParseIntError),
}

// –†–µ–∞–ª–∏–∑—É–µ–º From –¥–ª—è –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏–∏
impl From<io::Error> for MyError {
    fn from(error: io::Error) -> Self {
        MyError::Io(error)
    }
}

impl From<std::num::ParseIntError> for MyError {
    fn from(error: std::num::ParseIntError) -> Self {
        MyError::Parse(error)
    }
}

// –¢–µ–ø–µ—Ä—å ? —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
fn process() -> Result<i32, MyError> {
    let mut f = File::open("num.txt")?;  // –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è io::Error -> MyError
    let mut s = String::new();
    f.read_to_string(&mut s)?;           // –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è io::Error -> MyError
    let num = s.trim().parse()?;         // –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è ParseIntError -> MyError
    Ok(num)
}
```

---

### üéØ ? —Å Option

`?` —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å Option, –Ω–æ —Ç–æ–ª—å–∫–æ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö Option:

```rust
fn get_first_char(text: &str) -> Option<char> {
    text.chars().next() // –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Option<char>
}

fn get_first_two_chars(text: &str) -> Option<(char, char)> {
    let first = get_first_char(text)?;  // –µ—Å–ª–∏ None - —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç
    let second = text.chars().nth(1)?;  // –µ—Å–ª–∏ None - —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç
    Some((first, second))
}

// –ü—Ä–∏–º–µ—Ä—ã –≤—ã–∑–æ–≤–∞
assert_eq!(get_first_two_chars("ab"), Some(('a', 'b')));
assert_eq!(get_first_two_chars("a"), None);
assert_eq!(get_first_two_chars(""), None);
```

**–°–º–µ—à–∏–≤–∞–Ω–∏–µ Result –∏ Option:**

```rust
// –ù–ï –ö–û–ú–ü–ò–õ–ò–†–£–ï–¢–°–Ø - —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –≤–æ–∑–≤—Ä–∞—Ç–∞!
fn bad_example() -> Result<i32, Error> {
    let x = some_option()?; // ‚ùå Option –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å Result
    Ok(x)
}

// –†–ï–®–ï–ù–ò–ï 1: –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å Option -> Result
fn good_example() -> Result<i32, MyError> {
    let x = some_option()
        .ok_or(MyError::NotFound)?; // Option -> Result
    Ok(x)
}

// –†–ï–®–ï–ù–ò–ï 2: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞
fn option_example() -> Option<i32> {
    let x = some_option()?;
    Some(x)
}
```

---

### üõ†Ô∏è –ú–µ—Ç–æ–¥—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ Result

**1. –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```rust
let result: Result<i32, &str> = Ok(5);

// unwrap - –ø–∞–Ω–∏–∫—É–µ—Ç –ø—Ä–∏ Err (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–≤!)
let value = result.unwrap(); // 5
// Err("error").unwrap(); // üí• –ü–ê–ù–ò–ö–ê

// expect - –ø–∞–Ω–∏–∫—É–µ—Ç —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
let value = result.expect("Should be a valid number");

// unwrap_or - –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
let value = Err("error").unwrap_or(0); // 0

// unwrap_or_else - –ª–µ–Ω–∏–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
let value = Err("error").unwrap_or_else(|e| {
    eprintln!("Error: {}", e);
    0
});

// unwrap_or_default - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Default::default()
let value: i32 = Err("error").unwrap_or_default(); // 0
```

**2. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è:**

```rust
let result: Result<i32, &str> = Ok(5);

// map - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è Ok –∑–Ω–∞—á–µ–Ω–∏—è
let doubled = result.map(|x| x * 2); // Ok(10)

// map_err - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è Err –∑–Ω–∞—á–µ–Ω–∏—è
let custom_err = result.map_err(|e| format!("Error: {}", e));

// and_then (flatMap) - —Ü–µ–ø–æ—á–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö Result
let result = Ok(5)
    .and_then(|x| Ok(x * 2))      // Ok(10)
    .and_then(|x| {
        if x > 5 {
            Ok(x)
        } else {
            Err("Too small")
        }
    }); // Ok(10)
```

**3. –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã:**

```rust
let ok1: Result<i32, &str> = Ok(5);
let ok2: Result<i32, &str> = Ok(10);
let err: Result<i32, &str> = Err("error");

// and - –µ—Å–ª–∏ –æ–±–∞ Ok, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ç–æ—Ä–æ–π
ok1.and(ok2);    // Ok(10)
ok1.and(err);    // Err("error")
err.and(ok1);    // Err("error")

// or - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π Ok –∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π Err
ok1.or(ok2);     // Ok(5)
ok1.or(err);     // Ok(5)
err.or(ok1);     // Ok(5)

// –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: fallback
let primary = connect_to_primary();
let secondary = connect_to_secondary();
let connection = primary.or(secondary)?; // –ø–æ–ø—Ä–æ–±—É–µ–º –≤—Ç–æ—Ä–∏—á–Ω—ã–π –µ—Å–ª–∏ –ø–µ—Ä–≤–∏—á–Ω—ã–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

---

### üì¶ –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö Result

**1. –¶–µ–ø–æ—á–∫–∏ —Å ?:**

```rust
fn complex_operation() -> Result<String, Error> {
    let data = fetch_data()?;
    let parsed = parse_data(&data)?;
    let validated = validate(parsed)?;
    let transformed = transform(validated)?;
    Ok(format_output(transformed))
}
```

**2. collect() –¥–ª—è Vec<Result>:**

```rust
let results: Vec<Result<i32, _>> = vec![
    Ok(1),
    Ok(2),
    Err("error"),
    Ok(4),
];

// –°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ Ok –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—É—é –æ—à–∏–±–∫—É
let collected: Result<Vec<i32>, _> = results.into_iter().collect();
// Err("error") - –ø–µ—Ä–≤–∞—è –æ—à–∏–±–∫–∞

// –¢–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
let numbers: Vec<i32> = vec![Ok(1), Err("e"), Ok(3)]
    .into_iter()
    .filter_map(Result::ok)
    .collect(); // vec![1, 3]
```

**3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:**

```rust
fn process_all(items: Vec<String>) -> Result<Vec<Data>, Error> {
    items
        .into_iter()
        .map(|item| process_item(&item))  // Vec<Result<Data, Error>>
        .collect()                         // Result<Vec<Data>, Error>
    // –ï—Å–ª–∏ —Ö–æ—Ç—å –æ–¥–∏–Ω Err - –≤—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Err
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö, —Å–æ–±–∏—Ä–∞–µ–º –æ—à–∏–±–∫–∏
fn process_all_collect_errors(items: Vec<String>) -> (Vec<Data>, Vec<Error>) {
    items
        .into_iter()
        .map(|item| process_item(&item))
        .fold((vec![], vec![]), |(mut oks, mut errs), result| {
            match result {
                Ok(data) => oks.push(data),
                Err(e) => errs.push(e),
            }
            (oks, errs)
        })
}
```

---

### üé≠ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**1. Fail Fast (—Ä–∞–Ω–Ω–µ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ):**

```rust
fn validate_user(user: &User) -> Result<(), ValidationError> {
    if user.name.is_empty() {
        return Err(ValidationError::EmptyName);
    }
    
    if user.age < 18 {
        return Err(ValidationError::TooYoung);
    }
    
    if !user.email.contains('@') {
        return Err(ValidationError::InvalidEmail);
    }
    
    Ok(())
}
```

**2. Accumulate Errors (–Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫):**

```rust
fn validate_user_all(user: &User) -> Result<(), Vec<ValidationError>> {
    let mut errors = Vec::new();
    
    if user.name.is_empty() {
        errors.push(ValidationError::EmptyName);
    }
    
    if user.age < 18 {
        errors.push(ValidationError::TooYoung);
    }
    
    if !user.email.contains('@') {
        errors.push(ValidationError::InvalidEmail);
    }
    
    if errors.is_empty() {
        Ok(())
    } else {
        Err(errors)
    }
}
```

**3. Retry Pattern:**

```rust
fn retry<F, T, E>(mut operation: F, max_attempts: u32) -> Result<T, E>
where
    F: FnMut() -> Result<T, E>,
{
    let mut attempts = 0;
    loop {
        match operation() {
            Ok(result) => return Ok(result),
            Err(e) => {
                attempts += 1;
                if attempts >= max_attempts {
                    return Err(e);
                }
                // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å delay
            }
        }
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
let data = retry(|| fetch_from_api(), 3)?;
```

**4. Fallback Pattern:**

```rust
fn get_config() -> Config {
    load_from_file()
        .or_else(|_| load_from_env())
        .or_else(|_| load_from_network())
        .unwrap_or_else(|_| Config::default())
}
```

**5. Context Pattern (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫ –æ—à–∏–±–∫–∞–º):**

```rust
// –° –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π anyhow
use anyhow::{Context, Result};

fn process_file(path: &str) -> Result<String> {
    let content = std::fs::read_to_string(path)
        .with_context(|| format!("Failed to read file: {}", path))?;
    
    let parsed = parse(&content)
        .context("Failed to parse content")?;
    
    Ok(parsed)
}

// –û—à–∏–±–∫–∞ –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–µ–ø–æ—á–∫—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
// "Failed to parse content"
// Caused by: "Invalid JSON at line 5"
// Caused by: "Failed to read file: config.json"
```

---

### üîß –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```rust
use std::fmt;

#[derive(Debug)]
pub enum MyError {
    NotFound,
    PermissionDenied,
    InvalidInput(String),
}

impl fmt::Display for MyError {
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {
        match self {
            MyError::NotFound => write!(f, "Resource not found"),
            MyError::PermissionDenied => write!(f, "Permission denied"),
            MyError::InvalidInput(msg) => write!(f, "Invalid input: {}", msg),
        }
    }
}

impl std::error::Error for MyError {}
```

**–° –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏:**

```rust
#[derive(Debug)]
pub enum AppError {
    Io(io::Error),
    Parse(ParseError),
    Database(DatabaseError),
    Custom(String),
}

impl fmt::Display for AppError {
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {
        match self {
            AppError::Io(e) => write!(f, "IO error: {}", e),
            AppError::Parse(e) => write!(f, "Parse error: {}", e),
            AppError::Database(e) => write!(f, "Database error: {}", e),
            AppError::Custom(msg) => write!(f, "{}", msg),
        }
    }
}

impl std::error::Error for AppError {
    fn source(&self) -> Option<&(dyn std::error::Error + 'static)> {
        match self {
            AppError::Io(e) => Some(e),
            AppError::Parse(e) => Some(e),
            AppError::Database(e) => Some(e),
            AppError::Custom(_) => None,
        }
    }
}

// –ê–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è
impl From<io::Error> for AppError {
    fn from(error: io::Error) -> Self {
        AppError::Io(error)
    }
}
```

---

### üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å panic! vs Result

**panic! (–ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è):**
- –ù–µ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–º—ã–µ –æ—à–∏–±–∫–∏
- –ù–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ)
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API (programmer error)

```rust
fn get_user(id: UserId) -> &User {
    self.users.get(&id)
        .expect("User must exist - this is a bug")
}
```

**Result (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫):**
- –û–∂–∏–¥–∞–µ–º—ã–µ –æ—à–∏–±–∫–∏ (—Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (API, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)

```rust
fn fetch_user(id: UserId) -> Result<User, ApiError> {
    // –°–µ—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
    api_client.get(&format!("/users/{}", id))
}
```

---

### üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫

1. **Result<T, E>** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (—è–≤–Ω–æ –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ)
2. **? –æ–ø–µ—Ä–∞—Ç–æ—Ä** - –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤–≤–µ—Ä—Ö (—Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç)
3. **–¢–∏–ø—ã –æ—à–∏–±–æ–∫** - –∏—Å–ø–æ–ª—å–∑—É–π –∫–∞—Å—Ç–æ–º–Ω—ã–µ enum –¥–ª—è –¥–æ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
4. **–ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã** - map, and_then, or_else –¥–ª—è –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
5. **–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ vs —Ä–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥** - –≤—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
6. **panic! —Ç–æ–ª—å–∫–æ –¥–ª—è bugs** - Result –¥–ª—è –æ–∂–∏–¥–∞–µ–º—ã—Ö –æ—à–∏–±–æ–∫

---

## üéØ –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å (1-3)

1. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Option<T> –∏ Result<T, E>?** –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Ç–∏–ø?

2. **–ß—Ç–æ —Ç–∞–∫–æ–µ unit type `()`?** –ü—Ä–∏–≤–µ–¥–∏ —Ç—Ä–∏ –ø—Ä–∏–º–µ—Ä–∞ –µ–≥–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

3. **–ù–∞–ø–∏—à–∏ –∑–∞–º—ã–∫–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —á–∏—Å–ª–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç.** –ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π –µ–≥–æ –≤ –º–µ—Ç–æ–¥–µ `map()` –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∞ —á–∏—Å–µ–ª.

### –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (4-7)

4. **–û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —ç—Ç–∏–º–∏ —Ç—Ä–µ–º—è –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏:**
   ```rust
   let x = String::from("hello");
   
   let c1 = || println!("{}", x);
   let c2 = || x.clone();
   let c3 = move || x;
   ```
   –ö–∞–∫–æ–π —Ç—Ä–µ–π—Ç (Fn/FnMut/FnOnce) —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–∞–∂–¥–æ–µ?

5. **–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é `safe_divide(a: f64, b: f64) -> Option<f64>`** –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `None` –ø—Ä–∏ –¥–µ–ª–µ–Ω–∏–∏ –Ω–∞ –Ω–æ–ª—å. –ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π –µ—ë –≤ —Ü–µ–ø–æ—á–∫–µ —Å `map()` –∏ `unwrap_or()`.

6. **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä `?` –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ?** –ü–æ–∫–∞–∂–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–π –∫–æ–¥ –±–µ–∑ `?` –¥–ª—è:
   ```rust
   let value = some_operation()?;
   ```

7. **–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —á–∏—Ç–∞–µ—Ç –¥–≤–∞ —á–∏—Å–ª–∞ –∏–∑ –¥–≤—É—Ö —Ñ–∞–π–ª–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ö —Å—É–º–º—É.** –ò—Å–ø–æ–ª—å–∑—É–π `?` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫. –¢–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞: `Result<i32, Box<dyn std::error::Error>>`.

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å (8-10)

8. **–†–µ–∞–ª–∏–∑—É–π —Ñ—É–Ω–∫—Ü–∏—é `retry`**, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–º—ã–∫–∞–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–µ `Result<T, E>` –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫. –ü—Ä–∏ –æ—à–∏–±–∫–µ - –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –≤—ã–∑–æ–≤. –°–∏–≥–Ω–∞—Ç—É—Ä–∞:
   ```rust
   fn retry<F, T, E>(operation: F, attempts: u32) -> Result<T, E>
   where
       F: FnMut() -> Result<T, E>
   { /* ... */ }
   ```

9. **–°–æ–∑–¥–∞–π enum –¥–ª—è HTTP –æ—à–∏–±–æ–∫** (`NotFound`, `Unauthorized`, `ServerError(String)`). –†–µ–∞–ª–∏–∑—É–π —Ç—Ä–µ–π—Ç—ã `Display` –∏ `Error`. –î–æ–±–∞–≤—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏–∑ `io::Error` —á–µ—Ä–µ–∑ `From`.

10. **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π API –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ HTTP –∫–ª–∏–µ–Ω—Ç–∞** –∏—Å–ø–æ–ª—å–∑—É—è builder pattern —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏:
    ```rust
    let client = HttpClient::new()
        .configure(|config| {
            config.timeout = Duration::from_secs(30);
            config.retries = 3;
        })
        .with_middleware(|req| {
            req.headers.insert("User-Agent", "MyApp");
        })
        .build();
    ```
    –ö–∞–∫–∏–µ —Ç—Ä–µ–π—Ç—ã –¥–æ–ª–∂–Ω—ã —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –∑–∞–º—ã–∫–∞–Ω–∏—è?

---

## üéì –§–∏–Ω–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏

–≠—Ç–∏ —Ç—Ä–∏ —Ç–µ–º—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç **—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å** –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ Rust:

- **–°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤** - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∫–∞–∫ –ø–æ–º–æ—â–Ω–∏–∫, —Ç–∏–ø—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
- **–ó–∞–º—ã–∫–∞–Ω–∏—è** - —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏—è, –∑–∞—Ö–≤–∞—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —è–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã, –∫–æ–º–ø–æ–∑–∏—Ü–∏—è —á–µ—Ä–µ–∑ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã

**–ì–ª–∞–≤–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø:** Rust –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –¥—É–º–∞—Ç—å –æ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö (None, Err) –Ω–∞ —ç—Ç–∞–ø–µ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞, –∞ –Ω–µ –¥–µ–±–∞–≥–∞ –≤ –ø—Ä–æ–¥–µ.

---

# Rust: –ö—É—á–∞, —É–º–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å

## –¢–µ–º–∞ 13: –†–∞–±–æ—Ç–∞ —Å –∫—É—á–µ–π. Box, Arc, Rc. RAII

### –ü–æ—á–µ–º—É –∫—É—á–∞ –≤–æ–æ–±—â–µ –Ω—É–∂–Ω–∞?

–í Rust –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å—ë –∂–∏–≤—ë—Ç –Ω–∞ —Å—Ç–µ–∫–µ. –°—Ç–µ–∫ –±—ã—Å—Ç—Ä—ã–π, –Ω–æ —É –Ω–µ–≥–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –∏–∑–≤–µ—Å—Ç–Ω—ã–π –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏. –ö—É—á–∞ (heap) –Ω—É–∂–Ω–∞ –∫–æ–≥–¥–∞:

1. **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏** (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
2. **–î–∞–Ω–Ω—ã–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ** –¥–ª—è —Å—Ç–µ–∫–∞
3. **–ù—É–∂–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –≤–ª–∞–¥–µ–Ω–∏—è** –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ —Ç–∏–ø—ã** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏)

### Box<T> - –±–∞–∑–æ–≤—ã–π —É–º–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å

`Box<T>` - —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ. –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π.

```rust
// –°–æ–∑–¥–∞–Ω–∏–µ Box
let x = Box::new(5);
println!("{}", x); // 5

// Box –≤–ª–∞–¥–µ–µ—Ç –¥–∞–Ω–Ω—ã–º–∏ - –∫–æ–≥–¥–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Å–∫–æ–ø–∞, 
// –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ –∫—É—á–∏
{
    let boxed = Box::new(String::from("hello"));
} // –∑–¥–µ—Å—å boxed –∏ –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ —É–Ω–∏—á—Ç–æ–∂–∞—é—Ç—Å—è
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç**: `Box` —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω RAII - –∫–æ–≥–¥–∞ `Box` —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è, –ø–∞–º—è—Ç—å –≤ –∫—É—á–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è.

#### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Box: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ —Ç–∏–ø—ã

```rust
// –≠—Ç–æ –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –∑–Ω–∞–µ—Ç —Ä–∞–∑–º–µ—Ä
// enum List {
//     Cons(i32, List),  // –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä!
//     Nil,
// }

// –ê —Ç–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç - Box –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä (—É–∫–∞–∑–∞—Ç–µ–ª—å)
enum List {
    Cons(i32, Box<List>),
    Nil,
}

let list = List::Cons(1, 
    Box::new(List::Cons(2, 
        Box::new(List::Nil)
    ))
);
```

### Rc<T> - —É–º–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å —Å –ø–æ–¥—Å—á—ë—Ç–æ–º —Å—Å—ã–ª–æ–∫

`Rc` = Reference Counted. –ü–æ–∑–≤–æ–ª—è–µ—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–∏–º –≤–ª–∞–¥–µ–ª—å—Ü–∞–º** —á–∏—Ç–∞—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ.

```rust
use std::rc::Rc;

let a = Rc::new(5);
let b = Rc::clone(&a);  // –ù–ï –∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, —Ç–æ–ª—å–∫–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫
let c = Rc::clone(&a);

println!("–°—á—ë—Ç—á–∏–∫: {}", Rc::strong_count(&a)); // 3

// –ö–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π Rc —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è, –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª—è—é—Ç—Å—è
```

**–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å**:
- `Rc::clone()` - –¥–µ—à—ë–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (–∫–æ–ø–∏—Ä—É–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ç —Å—á—ë—Ç—á–∏–∫)
- `.clone()` –Ω–∞ —Å–∞–º–∏—Ö –¥–∞–Ω–Ω—ã—Ö - –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (–∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ)
- `Rc` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ **–æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–º** –∫–æ–¥–µ (–Ω–µ Send/Sync)
- `Rc` –¥–∞—ë—Ç —Ç–æ–ª—å–∫–æ **–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π –¥–æ—Å—Ç—É–ø**

#### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –≥—Ä–∞—Ñ

```rust
use std::rc::Rc;

struct Node {
    value: i32,
    children: Vec<Rc<Node>>,
}

let leaf = Rc::new(Node { value: 3, children: vec![] });

let branch1 = Rc::new(Node {
    value: 1,
    children: vec![Rc::clone(&leaf)],
});

let branch2 = Rc::new(Node {
    value: 2,
    children: vec![Rc::clone(&leaf)],
});

// leaf –∏–º–µ–µ—Ç 3 –≤–ª–∞–¥–µ–ª—å—Ü–∞: leaf, branch1.children, branch2.children
println!("–°—Å—ã–ª–æ–∫ –Ω–∞ leaf: {}", Rc::strong_count(&leaf)); // 3
```

### Arc<T> - –∞—Ç–æ–º–∞—Ä–Ω—ã–π Rc –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏

`Arc` = Atomic Reference Counted. –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ `Rc`, –Ω–æ **–ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–µ–Ω**.

```rust
use std::sync::Arc;
use std::thread;

let data = Arc::new(vec![1, 2, 3, 4]);

let handles: Vec<_> = (0..3).map(|i| {
    let data_clone = Arc::clone(&data);
    thread::spawn(move || {
        println!("–ü–æ—Ç–æ–∫ {}: {:?}", i, data_clone);
    })
}).collect();

for handle in handles {
    handle.join().unwrap();
}
```

**–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Rc –∏ Arc**:
- `Rc` - –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞
- `Arc` - –º–µ–¥–ª–µ–Ω–Ω–µ–µ (–∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏), –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- `Arc` —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Send + Sync`

### RAII - Resource Acquisition Is Initialization

RAII - —ç—Ç–æ **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω** –≤ Rust. –ò–¥–µ—è –ø—Ä–æ—Å—Ç–∞—è:

> –†–µ—Å—É—Ä—Å (–ø–∞–º—è—Ç—å, —Ñ–∞–π–ª, –º—å—é—Ç–µ–∫—Å) –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏.

```rust
use std::fs::File;
use std::io::Write;

{
    let mut file = File::create("test.txt").unwrap();
    file.write_all(b"Hello").unwrap();
    // file –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–¥–µ—Å—å!
}

// –¢–æ –∂–µ —Å Box, Rc, Arc, Mutex –∏ —Ç.–¥.
{
    let data = Box::new(vec![1, 2, 3]);
    // –ø–∞–º—è—Ç—å –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
}
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ**:
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–±—ã—Ç—å –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Ä–µ—Å—É—Ä—Å
- –ù–µ—Ç —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏ (–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –∫–æ–¥–µ)
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –ø–∞–Ω–∏–∫–µ (—á–µ—Ä–µ–∑ Drop trait)

#### Drop trait - –æ—Å–Ω–æ–≤–∞ RAII

```rust
struct MyResource {
    name: String,
}

impl Drop for MyResource {
    fn drop(&mut self) {
        println!("–û—Å–≤–æ–±–æ–∂–¥–∞—é —Ä–µ—Å—É—Ä—Å: {}", self.name);
    }
}

{
    let r1 = MyResource { name: "–ø–µ—Ä–≤—ã–π".to_string() };
    let r2 = MyResource { name: "–≤—Ç–æ—Ä–æ–π".to_string() };
    // –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å–∫–æ–ø–∞ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è drop –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:
    // "–û—Å–≤–æ–±–æ–∂–¥–∞—é —Ä–µ—Å—É—Ä—Å: –≤—Ç–æ—Ä–æ–π"
    // "–û—Å–≤–æ–±–æ–∂–¥–∞—é —Ä–µ—Å—É—Ä—Å: –ø–µ—Ä–≤—ã–π"
}
```

### –ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

| –¢–∏–ø | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-----|-------------------|
| `Box<T>` | –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü, –¥–∞–Ω–Ω—ã–µ –≤ –∫—É—á–µ |
| `Rc<T>` | –ù–µ—Å–∫–æ–ª—å–∫–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π, –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã–π –∫–æ–¥ |
| `Arc<T>` | –ù–µ—Å–∫–æ–ª—å–∫–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π, –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π –∫–æ–¥ |

---

## –¢–µ–º–∞ 14: –ü–æ—Ç–æ–∫–∏. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤. Send + Sync

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤

```rust
use std::thread;
use std::time::Duration;

fn main() {
    // –°–æ–∑–¥–∞—ë–º –ø–æ—Ç–æ–∫
    let handle = thread::spawn(|| {
        for i in 1..10 {
            println!("–ò–∑ –ø–æ—Ç–æ–∫–∞: {}", i);
            thread::sleep(Duration::from_millis(1));
        }
    });

    for i in 1..5 {
        println!("–ò–∑ main: {}", i);
        thread::sleep(Duration::from_millis(1));
    }

    // –ñ–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞
    handle.join().unwrap();
}
```

**–í–∞–∂–Ω–æ**:
- `thread::spawn` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `JoinHandle`
- –ë–µ–∑ `.join()` –ø–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –Ω–µ —É—Å–ø–µ—Ç—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è
- –ì–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –Ω–µ –∂–¥—ë—Ç –¥–æ—á–µ—Ä–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–æ—Ç–æ–∫ —Å move

```rust
let v = vec![1, 2, 3];

// –ë–µ–∑ move - –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!
// let handle = thread::spawn(|| {
//     println!("{:?}", v); // error: –º–æ–∂–µ—Ç –∂–∏—Ç—å –¥–æ–ª—å—à–µ v
// });

// –° move - –≤–ª–∞–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –ø–æ—Ç–æ–∫
let handle = thread::spawn(move || {
    println!("{:?}", v);
});

// println!("{:?}", v); // error: v —É–∂–µ –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ –ø–æ—Ç–æ–∫

handle.join().unwrap();
```

### Send –∏ Sync - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä–∫–µ—Ä—ã –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

Rust –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ **—Ç–∏–ø–∞–∂–∏-–º–∞—Ä–∫–µ—Ä—ã**:

#### Send - –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏

–¢–∏–ø–∞–∂ `Send` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤–ª–∞–¥–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ç–∏–ø–∞ –º–æ–∂–Ω–æ **–±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å** –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫.

```rust
// –ü—Ä–∏–º–µ—Ä—ã —Ç–∏–ø–æ–≤, —Ä–µ–∞–ª–∏–∑—É—é—â–∏—Ö Send:
// - –ø—Ä–∏–º–∏—Ç–∏–≤—ã: i32, String, Vec<T> –≥–¥–µ T: Send
// - Box<T> –≥–¥–µ T: Send
// - Arc<T> –≥–¥–µ T: Send + Sync

// –ù–ï —Ä–µ–∞–ª–∏–∑—É—é—Ç Send:
// - Rc<T> (–Ω–µ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫)
// - &mut T –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∏–¥–µ—è**: –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –¥–∞—Å—Ç –ø–µ—Ä–µ–¥–∞—Ç—å `Rc` –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫.

```rust
use std::rc::Rc;
use std::thread;

let rc = Rc::new(5);

// –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏! Rc –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç Send
// thread::spawn(move || {
//     println!("{}", rc);
// });
```

#### Sync - –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–µ–ª–∏—Ç—å —Å—Å—ã–ª–∫–∏ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏

–¢–∏–ø–∞–∂ `Sync` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å—Å—ã–ª–∫—É `&T` –º–æ–∂–Ω–æ **–±–µ–∑–æ–ø–∞—Å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

```rust
// T: Sync –µ—Å–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å &T –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏

// Sync:
// - –ø—Ä–∏–º–∏—Ç–∏–≤—ã: i32, bool
// - Arc<T> –≥–¥–µ T: Send + Sync
// - Mutex<T> –≥–¥–µ T: Send

// –ù–ï Sync:
// - Cell<T>, RefCell<T> (–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
// - Rc<T>
```

**–°–≤—è–∑—å Send –∏ Sync**:
```
T: Sync  ‚ü∫  &T: Send
```

–ï—Å–ª–∏ `T` —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Sync`, —Ç–æ –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å `&T` –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫.

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Send –∏ Sync

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

```rust
struct MyStruct {
    data: Vec<i32>,
    count: i32,
}
// MyStruct –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ Send + Sync, 
// –ø–æ—Ç–æ–º—É —á—Ç–æ Vec<i32> –∏ i32 - Send + Sync
```

–ù–æ –º–æ–∂–Ω–æ –∑–∞–ø—Ä–µ—Ç–∏—Ç—å:

```rust
use std::marker::PhantomData;
use std::rc::Rc;

struct NotSend {
    _marker: PhantomData<Rc<()>>,
}
// NotSend –ù–ï —Ä–µ–∞–ª–∏–∑—É–µ—Ç Send –∏–∑-–∑–∞ Rc
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –ø–æ–¥—Å—á—ë—Ç –≤ –ø–æ—Ç–æ–∫–∞—Ö (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** (–Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è):

```rust
let mut counter = 0;

let handles: Vec<_> = (0..10).map(|_| {
    thread::spawn(move || {
        counter += 1; // error: –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –∏–∑–º–µ–Ω—è—é—Ç counter
    })
}).collect();
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ** (—Å Mutex):

```rust
use std::sync::{Arc, Mutex};

let counter = Arc::new(Mutex::new(0));

let handles: Vec<_> = (0..10).map(|_| {
    let counter_clone = Arc::clone(&counter);
    thread::spawn(move || {
        let mut num = counter_clone.lock().unwrap();
        *num += 1;
    })
}).collect();

for handle in handles {
    handle.join().unwrap();
}

println!("–†–µ–∑—É–ª—å—Ç–∞—Ç: {}", *counter.lock().unwrap()); // 10
```

---

## –¢–µ–º–∞ 15: –õ—è–º–±–¥—ã –∏ –ø–æ—Ç–æ–∫–∏. Send + Sync. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ move –∏ Arc

### –ó–∞–º—ã–∫–∞–Ω–∏—è (–ª—è–º–±–¥—ã) –≤ Rust

–ó–∞–º—ã–∫–∞–Ω–∏–µ - —ç—Ç–æ –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç **–∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

```rust
let x = 5;

// –ó–∞–º—ã–∫–∞–Ω–∏–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç x –ø–æ —Å—Å—ã–ª–∫–µ
let print_x = || println!("x = {}", x);
print_x(); // x = 5

// –ú–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å x –¥–∞–ª—å—à–µ
println!("x –≤—Å—ë –µ—â—ë –¥–æ—Å—Ç—É–ø–µ–Ω: {}", x);
```

### –¢—Ä–∏ —Å–ø–æ—Å–æ–±–∞ –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ø–æ—Å–æ–± –∑–∞—Ö–≤–∞—Ç–∞:

1. **–ü–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ** `&T` (FnOnce)
2. **–ü–æ –∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ** `&mut T` (FnMut)
3. **–ü–æ –∑–Ω–∞—á–µ–Ω–∏—é** `T` (Fn)

```rust
let mut list = vec![1, 2, 3];

// –ó–∞—Ö–≤–∞—Ç –ø–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ
let printer = || println!("{:?}", list);
printer();

// –ó–∞—Ö–≤–∞—Ç –ø–æ –∏–∑–º–µ–Ω—è–µ–º–æ–π —Å—Å—ã–ª–∫–µ
let mut pusher = || list.push(4);
pusher();

// –ó–∞—Ö–≤–∞—Ç –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é (move)
let consumer = move || {
    println!("{:?}", list);
    // list —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∑–∞–º—ã–∫–∞–Ω–∏—é
};
consumer();
// println!("{:?}", list); // error: list –ø–µ—Ä–µ–º–µ—â—ë–Ω
```

### move —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏ –≤ –ø–æ—Ç–æ–∫–∞—Ö

–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `move` **–∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç** –∑–∞–º—ã–∫–∞–Ω–∏–µ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é.

```rust
let data = vec![1, 2, 3];

// –ë–ï–ó move - –æ—à–∏–±–∫–∞!
// let handle = thread::spawn(|| {
//     println!("{:?}", data); 
//     // error: data –º–æ–∂–µ—Ç –∂–∏—Ç—å –º–µ–Ω—å—à–µ, —á–µ–º –ø–æ—Ç–æ–∫
// });

// –° move - –≤–ª–∞–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –ø–æ—Ç–æ–∫
let handle = thread::spawn(move || {
    println!("{:?}", data);
    // data —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ—Ç–æ–∫—É
});

handle.join().unwrap();
```

**–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω move?**
- –ü–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∂–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ñ—É–Ω–∫—Ü–∏—é
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –∑–Ω–∞–µ—Ç, –∫–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è
- `move` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∂–∏–≤—É—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ

### Arc + move: —à–∞—Ä–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏

–ß—Ç–æ–±—ã –¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ—Ç–æ–∫–∞–º –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º `Arc`:

```rust
use std::sync::Arc;
use std::thread;

let data = Arc::new(vec![1, 2, 3, 4, 5]);
let mut handles = vec![];

for i in 0..3 {
    // –ö–ª–æ–Ω–∏—Ä—É–µ–º Arc (—É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ —Å—Å—ã–ª–æ–∫)
    let data_clone = Arc::clone(&data);
    
    // move –ø–µ—Ä–µ–¥–∞—ë—Ç –≤–ª–∞–¥–µ–Ω–∏–µ data_clone –≤ –ø–æ—Ç–æ–∫
    let handle = thread::spawn(move || {
        let sum: i32 = data_clone.iter().sum();
        println!("–ü–æ—Ç–æ–∫ {}: —Å—É–º–º–∞ = {}", i, sum);
    });
    
    handles.push(handle);
}

for handle in handles {
    handle.join().unwrap();
}

// data –≤—Å—ë –µ—â—ë –¥–æ—Å—Ç—É–ø–µ–Ω –≤ main
println!("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {:?}", data);
```

### –ò–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å —Å Arc + Mutex

`Arc` –¥–∞—ë—Ç —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ. –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–µ–Ω `Mutex`:

```rust
use std::sync::{Arc, Mutex};
use std::thread;

let counter = Arc::new(Mutex::new(0));
let mut handles = vec![];

for _ in 0..10 {
    let counter_clone = Arc::clone(&counter);
    
    let handle = thread::spawn(move || {
        for _ in 0..100 {
            let mut num = counter_clone.lock().unwrap();
            *num += 1;
            // –º—å—é—Ç–µ–∫—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è (RAII!)
        }
    });
    
    handles.push(handle);
}

for handle in handles {
    handle.join().unwrap();
}

println!("–†–µ–∑—É–ª—å—Ç–∞—Ç: {}", *counter.lock().unwrap()); // 1000
```

### Send + Sync –≤ –∑–∞–º—ã–∫–∞–Ω–∏—è—Ö

–ó–∞–º—ã–∫–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Send`, –µ—Å–ª–∏ **–≤—Å–µ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑—É—é—Ç Send**.

```rust
use std::rc::Rc;

let rc = Rc::new(5);
let x = 10;

// –≠—Ç–æ –∑–∞–º—ã–∫–∞–Ω–∏–µ –ù–ï Send (–∏–∑-–∑–∞ rc)
let closure = move || {
    println!("{} {}", rc, x);
};

// –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!
// thread::spawn(closure);

// –ù–æ –µ—Å–ª–∏ —É–±—Ä–∞—Ç—å rc:
let closure_ok = move || {
    println!("{}", x);
};

thread::spawn(closure_ok); // OK: i32 —Ä–µ–∞–ª–∏–∑—É–µ—Ç Send
```

### –ü–∞—Ç—Ç–µ—Ä–Ω: —Ä–∞—Å—á—ë—Ç—ã –≤ –ø–æ—Ç–æ–∫–∞—Ö —Å Arc

```rust
use std::sync::Arc;
use std::thread;

fn parallel_sum(data: Vec<i32>) -> i32 {
    let data = Arc::new(data);
    let chunk_size = data.len() / 4;
    
    let handles: Vec<_> = (0..4).map(|i| {
        let data_clone = Arc::clone(&data);
        
        thread::spawn(move || {
            let start = i * chunk_size;
            let end = if i == 3 { data_clone.len() } else { (i + 1) * chunk_size };
            
            data_clone[start..end].iter().sum::<i32>()
        })
    }).collect();
    
    handles.into_iter()
        .map(|h| h.join().unwrap())
        .sum()
}

let nums = vec![1, 2, 3, 4, 5, 6, 7, 8];
println!("–°—É–º–º–∞: {}", parallel_sum(nums));
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è

1. **move + Arc** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏:
   - `Arc` –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö
   - `move` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤–ª–∞–¥–µ–Ω–∏—è Arc –≤ –ø–æ—Ç–æ–∫
   
2. **Send/Sync –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏**:
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–ª—É—á–∞–π–Ω–æ —Å–æ–∑–¥–∞—Ç—å data race
   - –û—à–∏–±–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –¥–æ –∑–∞–ø—É—Å–∫–∞
   
3. **RAII –≤–µ–∑–¥–µ**:
   - `MutexGuard` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
   - `Arc` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç –ø–∞–º—è—Ç—å
   - –ü–æ—Ç–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è

4. **–ó–∞–º—ã–∫–∞–Ω–∏—è –Ω–∞—Å–ª–µ–¥—É—é—Ç Send/Sync** –æ—Ç –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

---

## –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –í–æ–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π

1. **–û–±—ä—è—Å–Ω–∏—Ç–µ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `Box`, `Rc` –∏ `Arc`. –í –∫–∞–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –≤—ã –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö?**

2. **–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç —Å —ç—Ç–∏–º –∫–æ–¥–æ–º –∏ –ø–æ—á–µ–º—É?**
   ```rust
   let x = vec![1, 2, 3];
   let handle = thread::spawn(|| {
       println!("{:?}", x);
   });
   handle.join().unwrap();
   ```

3. **–ü–æ—á–µ–º—É `Rc<T>` –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Send`? –ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫, –µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å `Rc` –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏?**

4. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è –ø–æ–¥—Ö–æ–¥–∞–º–∏ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –∑–∞–º—ã–∫–∞–Ω–∏–π –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤?**
   ```rust
   // –í–∞—Ä–∏–∞–Ω—Ç 1
   let data = Arc::new(vec![1, 2, 3]);
   let handle = thread::spawn(move || println!("{:?}", data));
   
   // –í–∞—Ä–∏–∞–Ω—Ç 2
   let data = Arc::new(vec![1, 2, 3]);
   let data_clone = Arc::clone(&data);
   let handle = thread::spawn(move || println!("{:?}", data_clone));
   ```

5. **–ß—Ç–æ —Ç–∞–∫–æ–µ RAII –∏ –∫–∞–∫ –æ–Ω –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –≤ Rust? –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–º–µ—Ä.**

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

6. **–ù–∞–π–¥–∏—Ç–µ –æ—à–∏–±–∫—É –≤ —ç—Ç–æ–º –∫–æ–¥–µ:**
   ```rust
   use std::sync::Arc;
   let counter = Arc::new(0);
   
   let handles: Vec<_> = (0..10).map(|_| {
       let c = Arc::clone(&counter);
       thread::spawn(move || {
           *c += 1; // error?
       })
   }).collect();
   ```

7. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä —á–∏—Å–µ–ª –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö, –∏—Å–ø–æ–ª—å–∑—É—è `Arc` –∏ `move`. –ö–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É —Å–≤–æ–µ–π —á–∞—Å—Ç–∏ –º–∞—Å—Å–∏–≤–∞.**

8. **–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è? –ö–∞–∫ –µ–≥–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å?**
   ```rust
   use std::rc::Rc;
   let data = Rc::new(vec![1, 2, 3]);
   
   thread::spawn(move || {
       println!("{:?}", data);
   });
   ```

9. **–û–±—ä—è—Å–Ω–∏—Ç–µ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –∏ –ø–æ—á–µ–º—É —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –±—É–¥–µ—Ç 1000:**
   ```rust
   let counter = Arc::new(Mutex::new(0));
   let handles: Vec<_> = (0..10).map(|_| {
       let c = Arc::clone(&counter);
       thread::spawn(move || {
           for _ in 0..100 {
               *c.lock().unwrap() += 1;
           }
       })
   }).collect();
   
   for h in handles { h.join().unwrap(); }
   println!("{}", *counter.lock().unwrap());
   ```

10. **–°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –ù–ï —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Send`, –∏ –æ–±—ä—è—Å–Ω–∏—Ç–µ, –ø–æ—á–µ–º—É –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–µ—Ä–µ–¥–∞—Ç—å –µ—ë –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫. –ó–∞—Ç–µ–º –∏–∑–º–µ–Ω–∏—Ç–µ –µ—ë —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∞ —Å—Ç–∞–ª–∞ `Send`.**

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

- **Box** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –¥–∞–Ω–Ω—ã—Ö –≤ –∫—É—á–µ
- **Rc** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ –¥–ª—è –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞
- **Arc** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞
- **RAII** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ —á–µ—Ä–µ–∑ Drop
- **Send** - —Ç–∏–ø –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- **Sync** - —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–∏–ø –º–æ–∂–Ω–æ —à–∞—Ä–∏—Ç—å –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- **move** —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏ - –ø–µ—Ä–µ–¥–∞—á–∞ –≤–ª–∞–¥–µ–Ω–∏—è –≤ –ø–æ—Ç–æ–∫
- **Arc + Mutex** - –∏–∑–º–µ–Ω—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!

---

# Rust: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

## –¢–µ–º–∞ 16: Mutex, Atomic

### Mutex<T> - –≤–∑–∞–∏–º–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

`Mutex` (mutual exclusion) –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–æ–ª—å–∫–æ **–æ–¥–∏–Ω –ø–æ—Ç–æ–∫** –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.

```rust
use std::sync::Mutex;

let m = Mutex::new(5);

{
    let mut num = m.lock().unwrap();
    *num = 6;
    // –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –∑–¥–µ—Å—å (RAII)
}

println!("m = {:?}", m); // Mutex { data: 6, poisoned: false, .. }
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã**:
- `lock()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Result<MutexGuard<T>>`
- `MutexGuard` - —ç—Ç–æ RAII –æ–±—ë—Ä—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏
- –ï—Å–ª–∏ –ø–æ—Ç–æ–∫ –∑–∞–ø–∞–Ω–∏–∫—É–µ—Ç, –¥–µ—Ä–∂–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, Mutex —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è "–æ—Ç—Ä–∞–≤–ª–µ–Ω–Ω—ã–º" (poisoned)

### Mutex –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–º –∫–æ–¥–µ

```rust
use std::sync::{Arc, Mutex};
use std::thread;

let counter = Arc::new(Mutex::new(0));
let mut handles = vec![];

for _ in 0..10 {
    let counter = Arc::clone(&counter);
    let handle = thread::spawn(move || {
        for _ in 0..1000 {
            let mut num = counter.lock().unwrap();
            *num += 1;
        }
    });
    handles.push(handle);
}

for handle in handles {
    handle.join().unwrap();
}

println!("–†–µ–∑—É–ª—å—Ç–∞—Ç: {}", *counter.lock().unwrap()); // 10000
```

**–ü–æ—á–µ–º—É Arc + Mutex?**
- `Arc` - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- `Mutex` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –í–º–µ—Å—Ç–µ –æ–Ω–∏ –¥–∞—é—Ç: shared mutable state

### Deadlock - –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞

```rust
use std::sync::{Arc, Mutex};
use std::thread;
use std::time::Duration;

let m1 = Arc::new(Mutex::new(0));
let m2 = Arc::new(Mutex::new(0));

let m1_clone = Arc::clone(&m1);
let m2_clone = Arc::clone(&m2);

// –ü–æ—Ç–æ–∫ 1: –±–ª–æ–∫–∏—Ä—É–µ—Ç m1, –∑–∞—Ç–µ–º m2
let t1 = thread::spawn(move || {
    let _guard1 = m1_clone.lock().unwrap();
    println!("T1: –∑–∞—Ö–≤–∞—Ç–∏–ª m1");
    thread::sleep(Duration::from_millis(10));
    
    println!("T1: –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å m2");
    let _guard2 = m2_clone.lock().unwrap(); // DEADLOCK!
    println!("T1: –∑–∞—Ö–≤–∞—Ç–∏–ª m2");
});

// –ü–æ—Ç–æ–∫ 2: –±–ª–æ–∫–∏—Ä—É–µ—Ç m2, –∑–∞—Ç–µ–º m1
let t2 = thread::spawn(move || {
    let _guard2 = m2.lock().unwrap();
    println!("T2: –∑–∞—Ö–≤–∞—Ç–∏–ª m2");
    thread::sleep(Duration::from_millis(10));
    
    println!("T2: –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å m1");
    let _guard1 = m1.lock().unwrap(); // DEADLOCK!
    println!("T2: –∑–∞—Ö–≤–∞—Ç–∏–ª m1");
});

// –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–Ω–µ—Ç –∑–¥–µ—Å—å
// t1.join().unwrap();
// t2.join().unwrap();
```

**–ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å deadlock**:
1. –í—Å–µ–≥–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –º—å—é—Ç–µ–∫—Å—ã –≤ **–æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ**
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `try_lock()` –≤–º–µ—Å—Ç–æ `lock()`
3. –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### RwLock - —á–∏—Ç–∞—Ç–µ–ª–∏ –∏ –ø–∏—Å–∞—Ç–µ–ª–∏

`RwLock` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–∏–±–æ **–º–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π**, –ª–∏–±–æ **–æ–¥–Ω–æ–≥–æ –ø–∏—Å–∞—Ç–µ–ª—è**.

```rust
use std::sync::RwLock;

let lock = RwLock::new(5);

// –ú–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ - OK
{
    let r1 = lock.read().unwrap();
    let r2 = lock.read().unwrap();
    println!("{} {}", *r1, *r2);
}

// –û–¥–∏–Ω –ø–∏—Å–∞—Ç–µ–ª—å
{
    let mut w = lock.write().unwrap();
    *w += 1;
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**:
- –ú–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è, –º–∞–ª–æ –∑–∞–ø–∏—Å–∏
- RwLock –º–µ–¥–ª–µ–Ω–Ω–µ–µ Mutex –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤

### Atomic —Ç–∏–ø—ã - lock-free —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫**, –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.

```rust
use std::sync::atomic::{AtomicUsize, Ordering};
use std::sync::Arc;
use std::thread;

let counter = Arc::new(AtomicUsize::new(0));
let mut handles = vec![];

for _ in 0..10 {
    let counter = Arc::clone(&counter);
    let handle = thread::spawn(move || {
        for _ in 0..1000 {
            counter.fetch_add(1, Ordering::SeqCst);
        }
    });
    handles.push(handle);
}

for handle in handles {
    handle.join().unwrap();
}

println!("–†–µ–∑—É–ª—å—Ç–∞—Ç: {}", counter.load(Ordering::SeqCst)); // 10000
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ —Ç–∏–ø—ã**:
- `AtomicBool`, `AtomicIsize`, `AtomicUsize`
- `AtomicI8`, `AtomicI16`, `AtomicI32`, `AtomicI64`
- `AtomicU8`, `AtomicU16`, `AtomicU32`, `AtomicU64`
- `AtomicPtr<T>`

### Memory Ordering - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

`Ordering` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–Ω—ã –≤ –¥—Ä—É–≥–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö:

```rust
use std::sync::atomic::Ordering;

// –û—Ç —Å–∞–º–æ–≥–æ —Å—Ç—Ä–æ–≥–æ–≥–æ –∫ —Å–∞–º–æ–º—É —Å–ª–∞–±–æ–º—É:

// SeqCst - Sequential Consistency (—Å–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π)
// –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤—Å–µ—Ö –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
counter.fetch_add(1, Ordering::SeqCst);

// Acquire - –¥–ª—è —á—Ç–µ–Ω–∏—è (load)
// Release - –¥–ª—è –∑–∞–ø–∏—Å–∏ (store)
// AcqRel - –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏–µ-–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è-–∑–∞–ø–∏—Å—å
let value = counter.load(Ordering::Acquire);
counter.store(10, Ordering::Release);

// Relaxed - –Ω–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π –ø–æ—Ä—è–¥–∫–∞ (—Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π)
counter.fetch_add(1, Ordering::Relaxed);
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∞–≤–∏–ª–æ**:
- –ù–∞—á–∏–Ω–∞–π—Ç–µ —Å `SeqCst` (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –¥–æ `Acquire/Release` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- `Relaxed` —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—á—ë—Ç—á–∏–∫–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á—Ç–æ?

| –ü—Ä–∏–º–∏—Ç–∏–≤ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
|----------|-------------------|-------------------|
| `Mutex<T>` | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, —Å–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –°—Ä–µ–¥–Ω—è—è |
| `RwLock<T>` | –ú–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π, –º–∞–ª–æ –ø–∏—Å–∞—Ç–µ–ª–µ–π | –°—Ä–µ–¥–Ω—è—è |
| `Atomic*` | –ü—Ä–æ—Å—Ç—ã–µ —Å—á—ë—Ç—á–∏–∫–∏, —Ñ–ª–∞–≥–∏ | –í—ã—Å–æ–∫–∞—è |

```rust
// –°—á—ë—Ç—á–∏–∫ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Atomic
let counter = AtomicUsize::new(0);
counter.fetch_add(1, Ordering::Relaxed);

// –°–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Mutex
let data = Mutex::new(HashMap::new());
data.lock().unwrap().insert("key", "value");

// –ú–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ RwLock
let cache = RwLock::new(HashMap::new());
let value = cache.read().unwrap().get("key");
```

---

## –¢–µ–º–∞ 17: Interior Mutability

### –ü—Ä–æ–±–ª–µ–º–∞: –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –∏ borrowing rules

–û–±—ã—á–Ω–æ –≤ Rust:
- –õ–∏–±–æ –æ–¥–Ω–∞ –∏–∑–º–µ–Ω—è–µ–º–∞—è —Å—Å—ã–ª–∫–∞ `&mut T`
- –õ–∏–±–æ –º–Ω–æ–≥–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã—Ö —Å—Å—ã–ª–æ–∫ `&T`

–ù–æ –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—É—é —Å—Å—ã–ª–∫—É. **Interior mutability** —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É.

### Cell<T> - –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –¥–ª—è Copy —Ç–∏–ø–æ–≤

`Cell` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ, –∏–º–µ—è —Ç–æ–ª—å–∫–æ `&Cell<T>`.

```rust
use std::cell::Cell;

struct Counter {
    count: Cell<i32>,
}

impl Counter {
    fn increment(&self) {  // &self, –Ω–µ &mut self!
        let current = self.count.get();
        self.count.set(current + 1);
    }
    
    fn get(&self) -> i32 {
        self.count.get()
    }
}

let counter = Counter { count: Cell::new(0) };
counter.increment();
counter.increment();
println!("{}", counter.get()); // 2
```

**–í–∞–∂–Ω–æ**:
- `Cell<T>` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å `Copy` —Ç–∏–ø–∞–º–∏
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ runtime - –≤—Å—ë –Ω–∞ —Å–æ–≤–µ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞
- –ù–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Sync` (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞)

### RefCell<T> - –∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å —Å runtime –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏

`RefCell` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ç–∏–ø–∞–º–∏, –Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç borrowing rules –≤ **runtime**.

```rust
use std::cell::RefCell;

let data = RefCell::new(vec![1, 2, 3]);

// –ë–µ—Ä—ë–º –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—É—é —Å—Å—ã–ª–∫—É
{
    let r1 = data.borrow();
    let r2 = data.borrow();
    println!("{:?} {:?}", r1, r2); // OK: –º–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π
}

// –ë–µ—Ä—ë–º –∏–∑–º–µ–Ω—è–µ–º—É—é —Å—Å—ã–ª–∫—É
{
    let mut w = data.borrow_mut();
    w.push(4);
}

println!("{:?}", data.borrow()); // [1, 2, 3, 4]
```

**Runtime –ø–∞–Ω–∏–∫–∞**:

```rust
let data = RefCell::new(5);

let r = data.borrow();
// let w = data.borrow_mut(); // –ü–ê–ù–ò–ö–ê! —É–∂–µ –µ—Å—Ç—å —á–∏—Ç–∞—Ç–µ–ª—å

let mut w = data.borrow_mut();
// let r2 = data.borrow(); // –ü–ê–ù–ò–ö–ê! —É–∂–µ –µ—Å—Ç—å –ø–∏—Å–∞—Ç–µ–ª—å
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –¥–µ—Ä–µ–≤–æ —Å —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏

```rust
use std::cell::RefCell;
use std::rc::Rc;

struct Node {
    value: i32,
    children: RefCell<Vec<Rc<Node>>>,
}

let leaf = Rc::new(Node {
    value: 3,
    children: RefCell::new(vec![]),
});

let branch = Rc::new(Node {
    value: 5,
    children: RefCell::new(vec![]),
});

// –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–±—ë–Ω–∫–∞ —á–µ—Ä–µ–∑ &Rc (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—É—é —Å—Å—ã–ª–∫—É!)
branch.children.borrow_mut().push(Rc::clone(&leaf));

println!("Branch –∏–º–µ–µ—Ç {} –¥–µ—Ç–µ–π", branch.children.borrow().len());
```

### OnceCell –∏ LazyCell - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–¥–∏–Ω —Ä–∞–∑

```rust
use std::cell::OnceCell;

struct Config {
    database_url: OnceCell<String>,
}

impl Config {
    fn new() -> Self {
        Config {
            database_url: OnceCell::new(),
        }
    }
    
    fn get_db_url(&self) -> &str {
        self.database_url.get_or_init(|| {
            println!("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é DB URL...");
            "postgres://localhost".to_string()
        })
    }
}

let config = Config::new();
println!("{}", config.get_db_url()); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é DB URL...
println!("{}", config.get_db_url()); // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

### Interior Mutability + –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å

–î–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º `Mutex` –∏–ª–∏ `RwLock`:

```rust
use std::sync::{Arc, Mutex};

struct SharedCounter {
    count: Mutex<i32>,
}

impl SharedCounter {
    fn increment(&self) {  // &self!
        let mut num = self.count.lock().unwrap();
        *num += 1;
    }
}

let counter = Arc::new(SharedCounter {
    count: Mutex::new(0),
});

// –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤ –ø–æ—Ç–æ–∫–∏
let counter_clone = Arc::clone(&counter);
std::thread::spawn(move || {
    counter_clone.increment();
});
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ interior mutability

| –¢–∏–ø | –ü—Ä–æ–≤–µ—Ä–∫–∏ | –ü–æ—Ç–æ–∫–∏ | –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö |
|-----|----------|--------|-------------|
| `Cell<T>` | Compile-time | –ù–µ—Ç | Copy —Ç–æ–ª—å–∫–æ |
| `RefCell<T>` | Runtime | –ù–µ—Ç | –õ—é–±—ã–µ |
| `Mutex<T>` | Runtime | –î–∞ | –õ—é–±—ã–µ |
| `RwLock<T>` | Runtime | –î–∞ | –õ—é–±—ã–µ |
| `Atomic*` | Lock-free | –î–∞ | –ü—Ä–∏–º–∏—Ç–∏–≤—ã |

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è**: Interior mutability –æ–±–º–µ–Ω–∏–≤–∞–µ—Ç compile-time –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ runtime –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –±–æ–ª—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç–∏.

---

## –¢–µ–º–∞ 18: –ú–∞–∫—Ä–æ—Å—ã: –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ

### –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –º–∞–∫—Ä–æ—Å—ã?

–ú–∞–∫—Ä–æ—Å—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∫–æ–¥ **–Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏**. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è:
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –°–æ–∑–¥–∞–Ω–∏—è DSL (domain-specific languages)
- –ú–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã (macro_rules!)

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∏–¥ –º–∞–∫—Ä–æ—Å–æ–≤. –†–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ pattern matching –¥–ª—è –∫–æ–¥–∞.

```rust
// –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –º–∞–∫—Ä–æ—Å
macro_rules! say_hello {
    () => {
        println!("Hello!");
    };
}

say_hello!(); // Hello!
```

#### –ú–∞–∫—Ä–æ—Å—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

```rust
macro_rules! create_function {
    ($func_name:ident) => {
        fn $func_name() {
            println!("–í—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è {:?}", stringify!($func_name));
        }
    };
}

create_function!(foo);
create_function!(bar);

foo(); // –í—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è "foo"
bar(); // –í—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è "bar"
```

**–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è (designators)**:
- `ident` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π/—Ñ—É–Ω–∫—Ü–∏–∏)
- `expr` - –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
- `ty` - —Ç–∏–ø
- `pat` - –ø–∞—Ç—Ç–µ—Ä–Ω
- `stmt` - statement
- `block` - –±–ª–æ–∫ –∫–æ–¥–∞
- `item` - —ç–ª–µ–º–µ–Ω—Ç (struct, fn, etc.)
- `tt` - token tree (–ª—é–±–æ–π —Ç–æ–∫–µ–Ω)

#### –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –≤ –º–∞–∫—Ä–æ—Å–∞—Ö

```rust
macro_rules! vec_of_strings {
    ($($x:expr),*) => {
        {
            let mut temp_vec = Vec::new();
            $(
                temp_vec.push($x.to_string());
            )*
            temp_vec
        }
    };
}

let v = vec_of_strings!("hello", "world", "!");
println!("{:?}", v); // ["hello", "world", "!"]
```

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π**:
- `$(...)*` - –Ω–æ–ª—å –∏–ª–∏ –±–æ–ª–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
- `$(...)+` - –æ–¥–Ω–æ –∏–ª–∏ –±–æ–ª–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
- `$(...)?` - –Ω–æ–ª—å –∏–ª–∏ –æ–¥–Ω–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ

#### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: hashmap macro

```rust
macro_rules! hashmap {
    ($($key:expr => $value:expr),* $(,)?) => {
        {
            let mut map = std::collections::HashMap::new();
            $(
                map.insert($key, $value);
            )*
            map
        }
    };
}

let map = hashmap! {
    "name" => "Alice",
    "age" => "30",
};
```

### –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã

–ü—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã - —ç—Ç–æ **—Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç TokenStream –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç TokenStream**.

–¢—Ä–∏ –≤–∏–¥–∞:
1. **Derive macros** - `#[derive(MyTrait)]`
2. **Attribute macros** - `#[my_attribute]`
3. **Function-like macros** - `my_macro!(...)`

#### Derive –º–∞–∫—Ä–æ—Å—ã (—Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ)

```rust
use serde::{Serialize, Deserialize};

#[derive(Debug, Clone, Serialize, Deserialize)]
struct User {
    name: String,
    age: u32,
}

// –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç impl –¥–ª—è —ç—Ç–∏—Ö —Ç—Ä–µ–π—Ç–æ–≤
let user = User {
    name: "Alice".to_string(),
    age: 30,
};

println!("{:?}", user); // —Ä–∞–±–æ—Ç–∞–µ—Ç –±–ª–∞–≥–æ–¥–∞—Ä—è Debug
let json = serde_json::to_string(&user).unwrap(); // –±–ª–∞–≥–æ–¥–∞—Ä—è Serialize
```

#### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ derive –º–∞–∫—Ä–æ—Å–∞

```toml
# Cargo.toml
[lib]
proc-macro = true

[dependencies]
syn = "2.0"
quote = "1.0"
```

```rust
// lib.rs
use proc_macro::TokenStream;
use quote::quote;
use syn::{parse_macro_input, DeriveInput};

#[proc_macro_derive(HelloMacro)]
pub fn hello_macro_derive(input: TokenStream) -> TokenStream {
    let ast = parse_macro_input!(input as DeriveInput);
    let name = &ast.ident;
    
    let gen = quote! {
        impl HelloMacro for #name {
            fn hello_macro() {
                println!("Hello from {}!", stringify!(#name));
            }
        }
    };
    
    gen.into()
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```rust
trait HelloMacro {
    fn hello_macro();
}

#[derive(HelloMacro)]
struct Pancakes;

#[derive(HelloMacro)]
struct Waffles;

Pancakes::hello_macro(); // Hello from Pancakes!
Waffles::hello_macro();  // Hello from Waffles!
```

#### Attribute –º–∞–∫—Ä–æ—Å—ã

```rust
#[proc_macro_attribute]
pub fn route(attr: TokenStream, item: TokenStream) -> TokenStream {
    // attr - —ç—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞—Ç—Ä–∏–±—É—Ç–∞
    // item - —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–º–µ–Ω—ë–Ω –∞—Ç—Ä–∏–±—É—Ç
    
    let gen = quote! {
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–¥ –¥–ª—è —Ä–æ—É—Ç–∏–Ω–≥–∞
        #item
    };
    
    gen.into()
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–∫–∞–∫ –≤ web-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö):

```rust
#[route(GET, "/users")]
fn get_users() -> String {
    "User list".to_string()
}
```

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫–∏–µ –º–∞–∫—Ä–æ—Å—ã?

| –¢–∏–ø –º–∞–∫—Ä–æ—Å–∞ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ü—Ä–∏–º–µ—Ä—ã |
|-------------|-------------------|---------|
| `macro_rules!` | –ü—Ä–æ—Å—Ç–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞, DSL | `vec!`, `println!` |
| Derive | –ê–≤—Ç–æ–∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è —Ç—Ä–µ–π—Ç–æ–≤ | `#[derive(Debug)]` |
| Attribute | –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ | `#[test]`, `#[tokio::main]` |
| Function-like | –°–ª–æ–∂–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∫–æ–¥–∞ | SQL query builders |

### –û—Ç–ª–∞–¥–∫–∞ –º–∞–∫—Ä–æ—Å–æ–≤

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –≤–æ —á—Ç–æ —Ä–∞—Å–∫—Ä—ã–ª—Å—è –º–∞–∫—Ä–æ—Å
cargo expand

# –ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ–¥—É–ª—è
cargo expand module_name
```

---

## –¢–µ–º–∞ 19: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å. Event Loop. async/await

### –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å?

**–ü—Ä–æ–±–ª–µ–º–∞**: –±–ª–æ–∫–∏—Ä—É—é—â–∏–π I/O —Ç—Ä–∞—Ç–∏—Ç –≤—Ä–µ–º—è –≤–ø—É—Å—Ç—É—é

```rust
// –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ - –ø–æ—Ç–æ–∫ –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç –≤–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
let response1 = fetch_url("http://api1.com"); // –∂–¥—ë–º 100ms
let response2 = fetch_url("http://api2.com"); // –∂–¥—ë–º 100ms
// –û–±—â–µ–µ –≤—Ä–µ–º—è: 200ms
```

**–†–µ—à–µ–Ω–∏–µ**: async/await –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å –¥—Ä—É–≥—É—é —Ä–∞–±–æ—Ç—É –ø–æ–∫–∞ –∂–¥—ë–º I/O

```rust
// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ - –∑–∞–ø—É—Å–∫–∞–µ–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
let future1 = fetch_url("http://api1.com");
let future2 = fetch_url("http://api2.com");
let (response1, response2) = tokio::join!(future1, future2);
// –û–±—â–µ–µ –≤—Ä–µ–º—è: ~100ms
```

### Future - –æ—Å–Ω–æ–≤–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏

`Future` - —ç—Ç–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ **–º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –≤ –±—É–¥—É—â–µ–º**.

```rust
use std::future::Future;

// –£–ø—Ä–æ—â—ë–Ω–Ω–æ, Future –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
trait SimpleFuture {
    type Output;
    
    fn poll(&mut self) -> Poll<Self::Output>;
}

enum Poll<T> {
    Ready(T),      // —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–æ—Ç–æ–≤
    Pending,       // –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤, –æ–ø—Ä–æ—Å–∏—Ç–µ –ø–æ–∑–∂–µ
}
```

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è**: Future –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç, –ø–æ–∫–∞ –µ–≥–æ –Ω–µ –Ω–∞—á–Ω—É—Ç **–æ–ø—Ä–∞—à–∏–≤–∞—Ç—å** (poll).

### async/await —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```rust
// async —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç impl Future
async fn fetch_data() -> String {
    // –°–∏–º—É–ª–∏—Ä—É–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é
    tokio::time::sleep(tokio::time::Duration::from_secs(1)).await;
    "Data".to_string()
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
#[tokio::main]
async fn main() {
    let data = fetch_data().await;
    println!("{}", data);
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º**:
1. `async fn` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é, –≤–æ–∑–≤—Ä–∞—â–∞—é—â—É—é `impl Future`
2. `.await` –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç Future –∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω –Ω–µ –≥–æ—Ç–æ–≤
3. Executor –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –æ–ø—Ä–æ—Å, –∫–æ–≥–¥–∞ Future –º–æ–∂–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—Ä–æ–≤–∞—Ç—å

### Event Loop - —Å–µ—Ä–¥—Ü–µ async runtime

Event Loop - —ç—Ç–æ **–æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã–π —Ü–∏–∫–ª**, –∫–æ—Ç–æ—Ä—ã–π:
1. –û–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Future
2. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ
3. –ó–∞—Å—ã–ø–∞–µ—Ç, –µ—Å–ª–∏ –¥–µ–ª–∞—Ç—å –Ω–µ—á–µ–≥–æ

```rust
// –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å Event Loop
loop {
    for future in futures {
        match future.poll() {
            Poll::Ready(value) => {
                // Future –∑–∞–≤–µ—Ä—à—ë–Ω, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            }
            Poll::Pending => {
                // Future –Ω–µ –≥–æ—Ç–æ–≤, –æ–ø—Ä–æ—Å–∏–º –ø–æ–∑–∂–µ
            }
        }
    }
    
    // –ñ–¥—ë–º —Å–æ–±—ã—Ç–∏–π –æ—Ç –û–° (–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–∫–µ—Ç–µ, —Ç–∞–π–º–µ—Ä –∏ —Ç.–¥.)
    wait_for_events();
}
```

### Tokio - –ø–æ–ø—É–ª—è—Ä–Ω—ã–π async runtime

```rust
use tokio::time::{sleep, Duration};

#[tokio::main]
async fn main() {
    println!("–°—Ç–∞—Ä—Ç");
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º 3 –∑–∞–¥–∞—á–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ
    let task1 = tokio::spawn(async {
        sleep(Duration::from_secs(2)).await;
        println!("–ó–∞–¥–∞—á–∞ 1 –∑–∞–≤–µ—Ä—à–µ–Ω–∞");
    });
    
    let task2 = tokio::spawn(async {
        sleep(Duration::from_secs(1)).await;
        println!("–ó–∞–¥–∞—á–∞ 2 –∑–∞–≤–µ—Ä—à–µ–Ω–∞");
    });
    
    let task3 = tokio::spawn(async {
        sleep(Duration::from_secs(3)).await;
        println!("–ó–∞–¥–∞—á–∞ 3 –∑–∞–≤–µ—Ä—à–µ–Ω–∞");
    });
    
    // –ñ–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á
    let _ = tokio::join!(task1, task2, task3);
    
    println!("–í—Å–µ –∑–∞–¥–∞—á–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã");
}

// –í—ã–≤–æ–¥:
// –°—Ç–∞—Ä—Ç
// –ó–∞–¥–∞—á–∞ 2 –∑–∞–≤–µ—Ä—à–µ–Ω–∞  (—á–µ—Ä–µ–∑ 1 —Å–µ–∫)
// –ó–∞–¥–∞—á–∞ 1 –∑–∞–≤–µ—Ä—à–µ–Ω–∞  (—á–µ—Ä–µ–∑ 2 —Å–µ–∫)
// –ó–∞–¥–∞—á–∞ 3 –∑–∞–≤–µ—Ä—à–µ–Ω–∞  (—á–µ—Ä–µ–∑ 3 —Å–µ–∫)
// –í—Å–µ –∑–∞–¥–∞—á–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã
```

### –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å vs –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º

**–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å** (concurrency) - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏:
```rust
#[tokio::main]
async fn main() {
    // –û–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –Ω–∞ –ø–æ—Ç–æ–∫, –Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ
    let (r1, r2) = tokio::join!(
        async { sleep(Duration::from_secs(1)).await; 1 },
        async { sleep(Duration::from_secs(1)).await; 2 },
    );
}
```

**–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º** (parallelism) - –Ω–∞—Å—Ç–æ—è—â–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:
```rust
#[tokio::main]
async fn main() {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è CPU-bound —Ä–∞–±–æ—Ç—ã
    let handle1 = tokio::task::spawn_blocking(|| {
        // –¢—è–∂—ë–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
        expensive_calculation()
    });
    
    let handle2 = tokio::task::spawn_blocking(|| {
        expensive_calculation()
    });
    
    let (r1, r2) = tokio::join!(handle1, handle2);
}
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã

```rust
use reqwest;
use tokio;

#[tokio::main]
async fn main() {
    let urls = vec![
        "https://api.github.com/users/rust-lang",
        "https://api.github.com/users/tokio-rs",
        "https://api.github.com/users/serde-rs",
    ];
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ
    let futures: Vec<_> = urls
        .into_iter()
        .map(|url| fetch_url(url))
        .collect();
    
    // –ñ–¥—ë–º –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    let results = futures::future::join_all(futures).await;
    
    for result in results {
        match result {
            Ok(body) => println!("–ü–æ–ª—É—á–µ–Ω–æ {} –±–∞–π—Ç", body.len()),
            Err(e) => eprintln!("–û—à–∏–±–∫–∞: {}", e),
        }
    }
}

async fn fetch_url(url: &str) -> Result<String, reqwest::Error> {
    let response = reqwest::get(url).await?;
    let body = response.text().await?;
    Ok(body)
}
```

### Select - –∂–¥—ë–º –ø–µ—Ä–≤—ã–π –∑–∞–≤–µ—Ä—à–∏–≤—à–∏–π—Å—è Future

```rust
use tokio::time::{sleep, Duration};

#[tokio::main]
async fn main() {
    tokio::select! {
        _ = sleep(Duration::from_secs(1)) => {
            println!("–¢–∞–π–º–∞—É—Ç 1 —Å–µ–∫");
        }
        _ = sleep(Duration::from_secs(5)) => {
            println!("–¢–∞–π–º–∞—É—Ç 5 —Å–µ–∫");
        }
    }
    // –í—ã–≤–µ–¥–µ—Ç "–¢–∞–π–º–∞—É—Ç 1 —Å–µ–∫" –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è
}
```

### –ö–∞–Ω–∞–ª—ã –¥–ª—è async –∫–æ–¥–∞

```rust
use tokio::sync::mpsc;

#[tokio::main]
async fn main() {
    let (tx, mut rx) = mpsc::channel(32);
    
    // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
    tokio::spawn(async move {
        for i in 0..10 {
            tx.send(i).await.unwrap();
        }
    });
    
    // –ü–æ–ª—É—á–∞—Ç–µ–ª—å
    while let Some(value) = rx.recv().await {
        println!("–ü–æ–ª—É—á–µ–Ω–æ: {}", value);
    }
}
```

### Async –≤ —Ç—Ä–µ–π—Ç–∞—Ö (–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ)

```rust
// –ü–æ–∫–∞ –Ω—É–∂–µ–Ω –∫—Ä–µ–π—Ç async-trait
use async_trait::async_trait;

#[async_trait]
trait Database {
    async fn fetch(&self, id: u64) -> String;
}

struct PostgresDb;

#[async_trait]
impl Database for PostgresDb {
    async fn fetch(&self, id: u64) -> String {
        // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ –ë–î
        format!("User {}", id)
    }
}
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```rust
// 1. –û–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã–π runtime (–¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)
#[tokio::main(flavor = "current_thread")]
async fn main() {
    // –í—Å—ë –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ
}

// 2. –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π runtime (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
#[tokio::main]  // –∏–ª–∏ #[tokio::main(flavor = "multi_thread")]
async fn main() {
    // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤
}

// 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—É–ª–∞ –ø–æ—Ç–æ–∫–æ–≤
#[tokio::main(worker_threads = 4)]
async fn main() {
    // –†–æ–≤–Ω–æ 4 —Ä–∞–±–æ—á–∏—Ö –ø–æ—Ç–æ–∫–∞
}
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–ª–∏—á–∏—è: sync vs async

| –ê—Å–ø–µ–∫—Ç | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π |
|--------|-----------|-------------|
| –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | `std::sync::Mutex` | `tokio::sync::Mutex` |
| –°–æ–Ω | `std::thread::sleep` | `tokio::time::sleep` |
| –ö–∞–Ω–∞–ª—ã | `std::sync::mpsc` | `tokio::sync::mpsc` |
| –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ | `std::fs::read` | `tokio::fs::read` |

**–ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ sync –ø—Ä–∏–º–∏—Ç–∏–≤—ã –≤ async –∫–æ–¥–µ** - —ç—Ç–æ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å event loop!

```rust
// ‚ùå –ü–õ–û–•–û - –±–ª–æ–∫–∏—Ä—É–µ—Ç event loop
#[tokio::main]
async fn main() {
    std::thread::sleep(Duration::from_secs(1)); // –í–µ—Å—å runtime –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç!
}

// ‚úÖ –•–û–†–û–®–û - –æ—Ç–¥–∞—ë—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ event loop
#[tokio::main]
async fn main() {
    tokio::time::sleep(Duration::from_secs(1)).await; // –î—Ä—É–≥–∏–µ –∑–∞–¥–∞—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
}
```

---

## –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –¢–µ–º–∞ 16: Mutex, Atomic

1. **–û–±—ä—è—Å–Ω–∏—Ç–µ, –ø–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –±–µ–∑–æ–ø–∞—Å–µ–Ω –æ—Ç data race:**
   ```rust
   let counter = Arc::new(Mutex::new(0));
   // ... –º–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–æ–≤ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É—é—Ç counter
   ```

2. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `Mutex<Vec<T>>` –∏ `Vec<Mutex<T>>`? –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç?**

3. **–ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Ordering::Relaxed` –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º `Ordering::SeqCst`? –ö–æ–≥–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Relaxed?**

4. **–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É –∏ –∏—Å–ø—Ä–∞–≤—å—Ç–µ:**
   ```rust
   let data = Arc::new(Mutex::new(vec![1, 2, 3]));
   let handle = std::thread::spawn(move || {
       let mut d = data.lock().unwrap();
       std::thread::sleep(Duration::from_secs(10));
       d.push(4);
   });
   // –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–ª–∞...
   ```

5. **–ö–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `RwLock` –≤–º–µ—Å—Ç–æ `Mutex`? –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä.**

### –¢–µ–º–∞ 17: Interior Mutability

6. **–û–±—ä—è—Å–Ω–∏—Ç–µ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `Cell::set()` –∏ `RefCell::borrow_mut()`. –ü–æ—á–µ–º—É Cell –Ω–µ –Ω—É–∂–Ω—ã runtime –ø—Ä–æ–≤–µ—Ä–∫–∏?**

7. **–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –∏ –ø–æ—á–µ–º—É?**
   ```rust
   let data = RefCell::new(5);
   let r1 = data.borrow();
   let r2 = data.borrow();
   println!("{} {}", r1, r2);
   drop(r1);
   drop(r2);
   let mut w = data.borrow_mut();
   *w = 10;
   ```

8. **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–µ—à–∞ —Å `RefCell`, –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –∫–∞–∂–¥–æ–º—É –∫–ª—é—á—É, –∏—Å–ø–æ–ª—å–∑—É—è interior mutability.**

### –¢–µ–º–∞ 18: –ú–∞–∫—Ä–æ—Å—ã

9. **–ù–∞–ø–∏—à–∏—Ç–µ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π –º–∞–∫—Ä–æ—Å `min!`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 2 –∏–ª–∏ –±–æ–ª–µ–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:**
   ```rust
   assert_eq!(min!(5, 3), 3);
   assert_eq!(min!(1, 4, 2, 8), 1);
   ```

10. **–í —á—ë–º –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–º–∏ –º–∞–∫—Ä–æ—Å–∞–º–∏? –ö–æ–≥–¥–∞ –∫–∞–∫–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**

11. **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –º–∞–∫—Ä–æ—Å?**
    ```rust
    macro_rules! impl_ops {
        ($($t:ty),*) => {
            $(
                impl MyTrait for $t {
                    fn my_method(&self) -> String {
                        format!("{}", self)
                    }
                }
            )*
        }
    }
    impl_ops!(i32, u32, f64);
    ```

### –¢–µ–º–∞ 19: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

12. **–û–±—ä—è—Å–Ω–∏—Ç–µ, –ø–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –ù–ï –∑–∞–ø—É—Å—Ç–∏—Ç –∑–∞–¥–∞—á–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:**
    ```rust
    async fn task1() { /* ... */ }
    async fn task2() { /* ... */ }
    
    #[tokio::main]
    async fn main() {
        task1().await;
        task2().await;
    }
    ```
    **–ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è?**

13. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `tokio::spawn` –∏ `tokio::task::spawn_blocking`? –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π?**

14. **–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å async runtime?**
    ```rust
    #[tokio::main]
    async fn main() {
        let data = Arc::new(std::sync::Mutex::new(0));
        let d = data.clone();
        
        tokio::spawn(async move {
            let mut num = d.lock().unwrap();
            std::thread::sleep(Duration::from_secs(10)); // –ü–†–û–ë–õ–ï–ú–ê!
            *num += 1;
        });
    }
    ```

15. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ async —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç 5 HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ tokio::select!).**

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- **Mutex** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è shared mutable state
- **Atomic** - lock-free –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Ç–∏–ø–æ–≤, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **RwLock** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —á–∞—Å—Ç–æ–≥–æ —á—Ç–µ–Ω–∏—è
- –í—Å–µ–≥–¥–∞ –¥–µ—Ä–∂–∏—Ç–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è

### Interior Mutability
- **Cell** - –¥–ª—è Copy —Ç–∏–ø–æ–≤, –±–µ–∑ runtime overhead
- **RefCell** - –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ç–∏–ø–æ–≤, runtime –ø—Ä–æ–≤–µ—Ä–∫–∏
- **Mutex/RwLock** - –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏
- –û–±–º–µ–Ω–∏–≤–∞–µ—Ç compile-time safety –Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å

### –ú–∞–∫—Ä–æ—Å—ã
- **macro_rules!** - pattern matching –¥–ª—è –∫–æ–¥–∞
- **Derive** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–π—Ç–æ–≤
- **Attribute** - –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–æ–¥–∞
- –ö–æ–¥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
- **async/await** - —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –Ω–∞–¥ Future
- **Event Loop** - –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç Future –∏ –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å ‚â† –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–π—Ç–µ async runtime sync –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- `tokio::join!` –¥–ª—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `tokio::select!` –¥–ª—è race conditions
## –ó–∞–∫—Ä–µ–ø–ª—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –¢–µ–º–∞ 16: Mutex, Atomic

1. **–û–±—ä—è—Å–Ω–∏—Ç–µ, –ø–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –±–µ–∑–æ–ø–∞—Å–µ–Ω –æ—Ç data race:**
   ```rust
   let counter = Arc::new(Mutex::new(0));
   // ... –º–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–æ–≤ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É—é—Ç counter
   ```

2. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `Mutex<Vec<T>>` –∏ `Vec<Mutex<T>>`? –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç?**

3. **–ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Ordering::Relaxed` –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º `Ordering::SeqCst`? –ö–æ–≥–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Relaxed?**

4. **–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É –∏ –∏—Å–ø—Ä–∞–≤—å—Ç–µ:**
   ```rust
   let data = Arc::new(Mutex::new(vec![1, 2, 3]));
   let handle = std::thread::spawn(move || {
       let mut d = data.lock().unwrap();
       std::thread::sleep(Duration::from_secs(10));
       d.push(4);
   });
   // –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–ª–∞...
   ```

5. **–ö–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `RwLock` –≤–º–µ—Å—Ç–æ `Mutex`? –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä.**

### –¢–µ–º–∞ 17: Interior Mutability

6. **–û–±—ä—è—Å–Ω–∏—Ç–µ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `Cell::set()` –∏ `RefCell::borrow_mut()`. –ü–æ—á–µ–º—É Cell –Ω–µ –Ω—É–∂–Ω—ã runtime –ø—Ä–æ–≤–µ—Ä–∫–∏?**

7. **–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –∏ –ø–æ—á–µ–º—É?**
   ```rust
   let data = RefCell::new(5);
   let r1 = data.borrow();
   let r2 = data.borrow();
   println!("{} {}", r1, r2);
   drop(r1);
   drop(r2);
   let mut w = data.borrow_mut();
   *w = 10;
   ```

8. **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–µ—à–∞ —Å `RefCell`, –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –∫–∞–∂–¥–æ–º—É –∫–ª—é—á—É, –∏—Å–ø–æ–ª—å–∑—É—è interior mutability.**

### –¢–µ–º–∞ 18: –ú–∞–∫—Ä–æ—Å—ã

9. **–ù–∞–ø–∏—à–∏—Ç–µ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π –º–∞–∫—Ä–æ—Å `min!`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 2 –∏–ª–∏ –±–æ–ª–µ–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:**
   ```rust
   assert_eq!(min!(5, 3), 3);
   assert_eq!(min!(1, 4, 2, 8), 1);
   ```

10. **–í —á—ë–º –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–º–∏ –º–∞–∫—Ä–æ—Å–∞–º–∏? –ö–æ–≥–¥–∞ –∫–∞–∫–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**

11. **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –º–∞–∫—Ä–æ—Å?**
    ```rust
    macro_rules! impl_ops {
        ($($t:ty),*) => {
            $(
                impl MyTrait for $t {
                    fn my_method(&self) -> String {
                        format!("{}", self)
                    }
                }
            )*
        }
    }
    impl_ops!(i32, u32, f64);
    ```

### –¢–µ–º–∞ 19: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

12. **–û–±—ä—è—Å–Ω–∏—Ç–µ, –ø–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –ù–ï –∑–∞–ø—É—Å—Ç–∏—Ç –∑–∞–¥–∞—á–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:**
    ```rust
    async fn task1() { /* ... */ }
    async fn task2() { /* ... */ }
    
    #[tokio::main]
    async fn main() {
        task1().await;
        task2().await;
    }
    ```
    **–ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è?**

13. **–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `tokio::spawn` –∏ `tokio::task::spawn_blocking`? –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π?**

14. **–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –∫–æ–¥ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å async runtime?**
    ```rust
    #[tokio::main]
    async fn main() {
        let data = Arc::new(std::sync::Mutex::new(0));
        let d = data.clone();
        
        tokio::spawn(async move {
            let mut num = d.lock().unwrap();
            std::thread::sleep(Duration::from_secs(10)); // –ü–†–û–ë–õ–ï–ú–ê!
            *num += 1;
        });
    }
    ```

15. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ async —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç 5 HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ tokio::select!).**

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- **Mutex** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è shared mutable state
- **Atomic** - lock-free –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Ç–∏–ø–æ–≤, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **RwLock** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —á–∞—Å—Ç–æ–≥–æ —á—Ç–µ–Ω–∏—è
- –í—Å–µ–≥–¥–∞ –¥–µ—Ä–∂–∏—Ç–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è

### Interior Mutability
- **Cell** - –¥–ª—è Copy —Ç–∏–ø–æ–≤, –±–µ–∑ runtime overhead
- **RefCell** - –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ç–∏–ø–æ–≤, runtime –ø—Ä–æ–≤–µ—Ä–∫–∏
- **Mutex/RwLock** - –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏
- –û–±–º–µ–Ω–∏–≤–∞–µ—Ç compile-time safety –Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å

### –ú–∞–∫—Ä–æ—Å—ã
- **macro_rules!** - pattern matching –¥–ª—è –∫–æ–¥–∞
- **Derive** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–π—Ç–æ–≤
- **Attribute** - –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–æ–¥–∞
- –ö–æ–¥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
- **async/await** - —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –Ω–∞–¥ Future
- **Event Loop** - –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç Future –∏ –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å ‚â† –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–π—Ç–µ async runtime sync –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- `tokio::join!` –¥–ª—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `tokio::select!` –¥–ª—è race conditions
